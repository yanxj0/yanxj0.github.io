import{g as w}from"./@turf-67881268.js";import{q as S}from"./quickselect-c5a25858.js";var g={exports:{}};g.exports=B;g.exports.default=B;var E=S;function B(i,n){if(!(this instanceof B))return new B(i,n);this._maxEntries=Math.max(4,i||9),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),n&&this._initFormat(n),this.clear()}B.prototype={all:function(){return this._all(this.data,[])},search:function(i){var n=this.data,t=[],r=this.toBBox;if(!M(i,n))return t;for(var e=[],a,h,s,o;n;){for(a=0,h=n.children.length;a<h;a++)s=n.children[a],o=n.leaf?r(s):s,M(i,o)&&(n.leaf?t.push(s):Y(i,o)?this._all(s,t):e.push(s));n=e.pop()}return t},collides:function(i){var n=this.data,t=this.toBBox;if(!M(i,n))return!1;for(var r=[],e,a,h,s;n;){for(e=0,a=n.children.length;e<a;e++)if(h=n.children[e],s=n.leaf?t(h):h,M(i,s)){if(n.leaf||Y(i,s))return!0;r.push(h)}n=r.pop()}return!1},load:function(i){if(!(i&&i.length))return this;if(i.length<this._minEntries){for(var n=0,t=i.length;n<t;n++)this.insert(i[n]);return this}var r=this._build(i.slice(),0,i.length-1,0);if(!this.data.children.length)this.data=r;else if(this.data.height===r.height)this._splitRoot(this.data,r);else{if(this.data.height<r.height){var e=this.data;this.data=r,r=e}this._insert(r,this.data.height-r.height-1,!0)}return this},insert:function(i){return i&&this._insert(i,this.data.height-1),this},clear:function(){return this.data=m([]),this},remove:function(i,n){if(!i)return this;for(var t=this.data,r=this.toBBox(i),e=[],a=[],h,s,o,l;t||e.length;){if(t||(t=e.pop(),s=e[e.length-1],h=a.pop(),l=!0),t.leaf&&(o=A(i,t.children,n),o!==-1))return t.children.splice(o,1),e.push(t),this._condense(e),this;!l&&!t.leaf&&Y(t,r)?(e.push(t),a.push(h),h=0,s=t,t=t.children[0]):s?(h++,t=s.children[h],l=!1):t=null}return this},toBBox:function(i){return i},compareMinX:v,compareMinY:y,toJSON:function(){return this.data},fromJSON:function(i){return this.data=i,this},_all:function(i,n){for(var t=[];i;)i.leaf?n.push.apply(n,i.children):t.push.apply(t,i.children),i=t.pop();return n},_build:function(i,n,t,r){var e=t-n+1,a=this._maxEntries,h;if(e<=a)return h=m(i.slice(n,t+1)),u(h,this.toBBox),h;r||(r=Math.ceil(Math.log(e)/Math.log(a)),a=Math.ceil(e/Math.pow(a,r-1))),h=m([]),h.leaf=!1,h.height=r;var s=Math.ceil(e/a),o=s*Math.ceil(Math.sqrt(a)),l,c,f,_;for(I(i,n,t,o,this.compareMinX),l=n;l<=t;l+=o)for(f=Math.min(l+o-1,t),I(i,l,f,s,this.compareMinY),c=l;c<=f;c+=s)_=Math.min(c+s-1,f),h.children.push(this._build(i,c,_,r-1));return u(h,this.toBBox),h},_chooseSubtree:function(i,n,t,r){for(var e,a,h,s,o,l,c,f;r.push(n),!(n.leaf||r.length-1===t);){for(c=f=1/0,e=0,a=n.children.length;e<a;e++)h=n.children[e],o=X(h),l=j(i,h)-o,l<f?(f=l,c=o<c?o:c,s=h):l===f&&o<c&&(c=o,s=h);n=s||n.children[0]}return n},_insert:function(i,n,t){var r=this.toBBox,e=t?i:r(i),a=[],h=this._chooseSubtree(e,this.data,n,a);for(h.children.push(i),p(h,e);n>=0&&a[n].children.length>this._maxEntries;)this._split(a,n),n--;this._adjustParentBBoxes(e,a,n)},_split:function(i,n){var t=i[n],r=t.children.length,e=this._minEntries;this._chooseSplitAxis(t,e,r);var a=this._chooseSplitIndex(t,e,r),h=m(t.children.splice(a,t.children.length-a));h.height=t.height,h.leaf=t.leaf,u(t,this.toBBox),u(h,this.toBBox),n?i[n-1].children.push(h):this._splitRoot(t,h)},_splitRoot:function(i,n){this.data=m([i,n]),this.data.height=i.height+1,this.data.leaf=!1,u(this.data,this.toBBox)},_chooseSplitIndex:function(i,n,t){var r,e,a,h,s,o,l,c;for(o=l=1/0,r=n;r<=t-n;r++)e=x(i,0,r,this.toBBox),a=x(i,r,t,this.toBBox),h=k(e,a),s=X(e)+X(a),h<o?(o=h,c=r,l=s<l?s:l):h===o&&s<l&&(l=s,c=r);return c},_chooseSplitAxis:function(i,n,t){var r=i.leaf?this.compareMinX:v,e=i.leaf?this.compareMinY:y,a=this._allDistMargin(i,n,t,r),h=this._allDistMargin(i,n,t,e);a<h&&i.children.sort(r)},_allDistMargin:function(i,n,t,r){i.children.sort(r);var e=this.toBBox,a=x(i,0,n,e),h=x(i,t-n,t,e),s=d(a)+d(h),o,l;for(o=n;o<t-n;o++)l=i.children[o],p(a,i.leaf?e(l):l),s+=d(a);for(o=t-n-1;o>=n;o--)l=i.children[o],p(h,i.leaf?e(l):l),s+=d(h);return s},_adjustParentBBoxes:function(i,n,t){for(var r=t;r>=0;r--)p(n[r],i)},_condense:function(i){for(var n=i.length-1,t;n>=0;n--)i[n].children.length===0?n>0?(t=i[n-1].children,t.splice(t.indexOf(i[n]),1)):this.clear():u(i[n],this.toBBox)},_initFormat:function(i){var n=["return a"," - b",";"];this.compareMinX=new Function("a","b",n.join(i[0])),this.compareMinY=new Function("a","b",n.join(i[1])),this.toBBox=new Function("a","return {minX: a"+i[0]+", minY: a"+i[1]+", maxX: a"+i[2]+", maxY: a"+i[3]+"};")}};function A(i,n,t){if(!t)return n.indexOf(i);for(var r=0;r<n.length;r++)if(t(i,n[r]))return r;return-1}function u(i,n){x(i,0,i.children.length,n,i)}function x(i,n,t,r,e){e||(e=m(null)),e.minX=1/0,e.minY=1/0,e.maxX=-1/0,e.maxY=-1/0;for(var a=n,h;a<t;a++)h=i.children[a],p(e,i.leaf?r(h):h);return e}function p(i,n){return i.minX=Math.min(i.minX,n.minX),i.minY=Math.min(i.minY,n.minY),i.maxX=Math.max(i.maxX,n.maxX),i.maxY=Math.max(i.maxY,n.maxY),i}function v(i,n){return i.minX-n.minX}function y(i,n){return i.minY-n.minY}function X(i){return(i.maxX-i.minX)*(i.maxY-i.minY)}function d(i){return i.maxX-i.minX+(i.maxY-i.minY)}function j(i,n){return(Math.max(n.maxX,i.maxX)-Math.min(n.minX,i.minX))*(Math.max(n.maxY,i.maxY)-Math.min(n.minY,i.minY))}function k(i,n){var t=Math.max(i.minX,n.minX),r=Math.max(i.minY,n.minY),e=Math.min(i.maxX,n.maxX),a=Math.min(i.maxY,n.maxY);return Math.max(0,e-t)*Math.max(0,a-r)}function Y(i,n){return i.minX<=n.minX&&i.minY<=n.minY&&n.maxX<=i.maxX&&n.maxY<=i.maxY}function M(i,n){return n.minX<=i.maxX&&n.minY<=i.maxY&&n.maxX>=i.minX&&n.maxY>=i.minY}function m(i){return{children:i,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function I(i,n,t,r,e){for(var a=[n,t],h;a.length;)t=a.pop(),n=a.pop(),!(t-n<=r)&&(h=n+Math.ceil((t-n)/r/2)*r,E(i,h,n,t,e),a.push(n,h,h,t))}var F=g.exports;const q=w(F);export{q as r};
