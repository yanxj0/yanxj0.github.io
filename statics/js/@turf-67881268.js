import{o as pt}from"./object-assign-2ce9e50f.js";import{c as oi}from"./concaveman-beb7e49c.js";import{m as ui}from"./topojson-client-e84e2917.js";import{t as si}from"./topojson-server-90ca4569.js";import{r as lt}from"./rbush-0046fafd.js";import{e as fi}from"./earcut-d35d6dea.js";import{r as Xe}from"./geojson-rbush-b84aed9f.js";import{e as Pe}from"./deep-equal-bc7ffb59.js";import{G as Jn}from"./geojson-equality-e8283d6c.js";import{c as hi}from"./density-clustering-71c68468.js";import{s as vi}from"./skmeans-9a124c0c.js";import{v as ci}from"./d3-voronoi-bdd54b49.js";import{i as ee}from"./polygon-clipping-210593fe.js";import{G as di,B as pi,a as li}from"./turf-jsts-a024e691.js";import{g as yi}from"./d3-geo-0b11a60a.js";import"./d3-array-8038b3b2.js";var Ff=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Nf(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function yt(r){if(r.__esModule)return r;var e=r.default;if(typeof e=="function"){var t=function n(){return this instanceof n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(r).forEach(function(n){var a=Object.getOwnPropertyDescriptor(r,n);Object.defineProperty(t,n,a.get?a:{enumerable:!0,get:function(){return r[n]}})}),t}var Or=63710088e-1,Ke={centimeters:Or*100,centimetres:Or*100,degrees:Or/111325,feet:Or*3.28084,inches:Or*39.37,kilometers:Or/1e3,kilometres:Or/1e3,meters:Or,metres:Or,miles:Or/1609.344,millimeters:Or*1e3,millimetres:Or*1e3,nauticalmiles:Or/1852,radians:1,yards:Or*1.0936},Hn={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/Or,yards:1.0936133},Re={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function Cr(r,e,t){t===void 0&&(t={});var n={type:"Feature"};return(t.id===0||t.id)&&(n.id=t.id),t.bbox&&(n.bbox=t.bbox),n.properties=e||{},n.geometry=r,n}function Xn(r,e,t){switch(r){case"Point":return T(e).geometry;case"LineString":return cr(e).geometry;case"Polygon":return D(e).geometry;case"MultiPoint":return Be(e).geometry;case"MultiLineString":return ue(e).geometry;case"MultiPolygon":return Xr(e).geometry;default:throw new Error(r+" is invalid")}}function T(r,e,t){if(t===void 0&&(t={}),!r)throw new Error("coordinates is required");if(!Array.isArray(r))throw new Error("coordinates must be an Array");if(r.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!qr(r[0])||!qr(r[1]))throw new Error("coordinates must contain numbers");var n={type:"Point",coordinates:r};return Cr(n,e,t)}function Kn(r,e,t){return t===void 0&&(t={}),N(r.map(function(n){return T(n,e)}),t)}function D(r,e,t){t===void 0&&(t={});for(var n=0,a=r;n<a.length;n++){var i=a[n];if(i.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var o=0;o<i[i.length-1].length;o++)if(i[i.length-1][o]!==i[0][o])throw new Error("First and last Position are not equivalent.")}var f={type:"Polygon",coordinates:r};return Cr(f,e,t)}function Zn(r,e,t){return t===void 0&&(t={}),N(r.map(function(n){return D(n,e)}),t)}function cr(r,e,t){if(t===void 0&&(t={}),r.length<2)throw new Error("coordinates must be an array of two or more positions");var n={type:"LineString",coordinates:r};return Cr(n,e,t)}function Un(r,e,t){return t===void 0&&(t={}),N(r.map(function(n){return cr(n,e)}),t)}function N(r,e){e===void 0&&(e={});var t={type:"FeatureCollection"};return e.id&&(t.id=e.id),e.bbox&&(t.bbox=e.bbox),t.features=r,t}function ue(r,e,t){t===void 0&&(t={});var n={type:"MultiLineString",coordinates:r};return Cr(n,e,t)}function Be(r,e,t){t===void 0&&(t={});var n={type:"MultiPoint",coordinates:r};return Cr(n,e,t)}function Xr(r,e,t){t===void 0&&(t={});var n={type:"MultiPolygon",coordinates:r};return Cr(n,e,t)}function gt(r,e,t){t===void 0&&(t={});var n={type:"GeometryCollection",geometries:r};return Cr(n,e,t)}function Qn(r,e){if(e===void 0&&(e=0),e&&!(e>=0))throw new Error("precision must be a positive number");var t=Math.pow(10,e||0);return Math.round(r*t)/t}function ge(r,e){e===void 0&&(e="kilometers");var t=Ke[e];if(!t)throw new Error(e+" units is invalid");return r*t}function fe(r,e){e===void 0&&(e="kilometers");var t=Ke[e];if(!t)throw new Error(e+" units is invalid");return r/t}function $e(r,e){return ie(fe(r,e))}function he(r){var e=r%360;return e<0&&(e+=360),e}function ie(r){var e=r%(2*Math.PI);return e*180/Math.PI}function Sr(r){var e=r%360;return e*Math.PI/180}function ve(r,e,t){if(e===void 0&&(e="kilometers"),t===void 0&&(t="kilometers"),!(r>=0))throw new Error("length must be a positive number");return ge(fe(r,e),t)}function Yn(r,e,t){if(e===void 0&&(e="meters"),t===void 0&&(t="kilometers"),!(r>=0))throw new Error("area must be a positive number");var n=Re[e];if(!n)throw new Error("invalid original units");var a=Re[t];if(!a)throw new Error("invalid final units");return r/n*a}function qr(r){return!isNaN(r)&&r!==null&&!Array.isArray(r)}function pr(r){return!!r&&r.constructor===Object}function _n(r){if(!r)throw new Error("bbox is required");if(!Array.isArray(r))throw new Error("bbox must be an Array");if(r.length!==4&&r.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");r.forEach(function(e){if(!qr(e))throw new Error("bbox must only contain numbers")})}function bn(r){if(!r)throw new Error("id is required");if(["string","number"].indexOf(typeof r)===-1)throw new Error("id must be a number or a string")}const jn=Object.freeze(Object.defineProperty({__proto__:null,areaFactors:Re,bearingToAzimuth:he,convertArea:Yn,convertLength:ve,degreesToRadians:Sr,earthRadius:Or,factors:Ke,feature:Cr,featureCollection:N,geometry:Xn,geometryCollection:gt,isNumber:qr,isObject:pr,lengthToDegrees:$e,lengthToRadians:fe,lineString:cr,lineStrings:Un,multiLineString:ue,multiPoint:Be,multiPolygon:Xr,point:T,points:Kn,polygon:D,polygons:Zn,radiansToDegrees:ie,radiansToLength:ge,round:Qn,unitsFactors:Hn,validateBBox:_n,validateId:bn},Symbol.toStringTag,{value:"Module"}));function Mr(r,e,t){if(r!==null)for(var n,a,i,o,f,s,u,h=0,v=0,c,d=r.type,E=d==="FeatureCollection",g=d==="Feature",P=E?r.features.length:1,m=0;m<P;m++){u=E?r.features[m].geometry:g?r.geometry:r,c=u?u.type==="GeometryCollection":!1,f=c?u.geometries.length:1;for(var l=0;l<f;l++){var w=0,L=0;if(o=c?u.geometries[l]:u,o!==null){s=o.coordinates;var M=o.type;switch(h=t&&(M==="Polygon"||M==="MultiPolygon")?1:0,M){case null:break;case"Point":if(e(s,v,m,w,L)===!1)return!1;v++,w++;break;case"LineString":case"MultiPoint":for(n=0;n<s.length;n++){if(e(s[n],v,m,w,L)===!1)return!1;v++,M==="MultiPoint"&&w++}M==="LineString"&&w++;break;case"Polygon":case"MultiLineString":for(n=0;n<s.length;n++){for(a=0;a<s[n].length-h;a++){if(e(s[n][a],v,m,w,L)===!1)return!1;v++}M==="MultiLineString"&&w++,M==="Polygon"&&L++}M==="Polygon"&&w++;break;case"MultiPolygon":for(n=0;n<s.length;n++){for(L=0,a=0;a<s[n].length;a++){for(i=0;i<s[n][a].length-h;i++){if(e(s[n][a][i],v,m,w,L)===!1)return!1;v++}L++}w++}break;case"GeometryCollection":for(n=0;n<o.geometries.length;n++)if(Mr(o.geometries[n],e,t)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function wt(r,e,t,n){var a=t;return Mr(r,function(i,o,f,s,u){o===0&&t===void 0?a=i:a=e(a,i,o,f,s,u)},n),a}function mt(r,e){var t;switch(r.type){case"FeatureCollection":for(t=0;t<r.features.length&&e(r.features[t].properties,t)!==!1;t++);break;case"Feature":e(r.properties,0);break}}function Vn(r,e,t){var n=t;return mt(r,function(a,i){i===0&&t===void 0?n=a:n=e(n,a,i)}),n}function vr(r,e){if(r.type==="Feature")e(r,0);else if(r.type==="FeatureCollection")for(var t=0;t<r.features.length&&e(r.features[t],t)!==!1;t++);}function Et(r,e,t){var n=t;return vr(r,function(a,i){i===0&&t===void 0?n=a:n=e(n,a,i)}),n}function we(r){var e=[];return Mr(r,function(t){e.push(t)}),e}function Kr(r,e){var t,n,a,i,o,f,s,u,h,v,c=0,d=r.type==="FeatureCollection",E=r.type==="Feature",g=d?r.features.length:1;for(t=0;t<g;t++){for(f=d?r.features[t].geometry:E?r.geometry:r,u=d?r.features[t].properties:E?r.properties:{},h=d?r.features[t].bbox:E?r.bbox:void 0,v=d?r.features[t].id:E?r.id:void 0,s=f?f.type==="GeometryCollection":!1,o=s?f.geometries.length:1,a=0;a<o;a++){if(i=s?f.geometries[a]:f,i===null){if(e(null,c,u,h,v)===!1)return!1;continue}switch(i.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(e(i,c,u,h,v)===!1)return!1;break}case"GeometryCollection":{for(n=0;n<i.geometries.length;n++)if(e(i.geometries[n],c,u,h,v)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}c++}}function Mt(r,e,t){var n=t;return Kr(r,function(a,i,o,f,s){i===0&&t===void 0?n=a:n=e(n,a,i,o,f,s)}),n}function Nr(r,e){Kr(r,function(t,n,a,i,o){var f=t===null?null:t.type;switch(f){case null:case"Point":case"LineString":case"Polygon":return e(Cr(t,a,{bbox:i,id:o}),n,0)===!1?!1:void 0}var s;switch(f){case"MultiPoint":s="Point";break;case"MultiLineString":s="LineString";break;case"MultiPolygon":s="Polygon";break}for(var u=0;u<t.coordinates.length;u++){var h=t.coordinates[u],v={type:s,coordinates:h};if(e(Cr(v,a),n,u)===!1)return!1}})}function ra(r,e,t){var n=t;return Nr(r,function(a,i,o){i===0&&o===0&&t===void 0?n=a:n=e(n,a,i,o)}),n}function Vr(r,e){Nr(r,function(t,n,a){var i=0;if(t.geometry){var o=t.geometry.type;if(!(o==="Point"||o==="MultiPoint")){var f,s=0,u=0,h=0;if(Mr(t,function(v,c,d,E,g){if(f===void 0||n>s||E>u||g>h){f=v,s=n,u=E,h=g,i=0;return}var P=cr([f,v],t.properties);if(e(P,n,a,g,i)===!1)return!1;i++,f=v})===!1)return!1}}})}function Pt(r,e,t){var n=t,a=!1;return Vr(r,function(i,o,f,s,u){a===!1&&t===void 0?n=i:n=e(n,i,o,f,s,u),a=!0}),n}function Lt(r,e){if(!r)throw new Error("geojson is required");Nr(r,function(t,n,a){if(t.geometry!==null){var i=t.geometry.type,o=t.geometry.coordinates;switch(i){case"LineString":if(e(t,n,a,0,0)===!1)return!1;break;case"Polygon":for(var f=0;f<o.length;f++)if(e(cr(o[f],t.properties),n,a,f)===!1)return!1;break}}})}function xt(r,e,t){var n=t;return Lt(r,function(a,i,o,f){i===0&&t===void 0?n=a:n=e(n,a,i,o,f)}),n}function ea(r,e){if(e=e||{},!pr(e))throw new Error("options is invalid");var t=e.featureIndex||0,n=e.multiFeatureIndex||0,a=e.geometryIndex||0,i=e.segmentIndex||0,o=e.properties,f;switch(r.type){case"FeatureCollection":t<0&&(t=r.features.length+t),o=o||r.features[t].properties,f=r.features[t].geometry;break;case"Feature":o=o||r.properties,f=r.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":f=r;break;default:throw new Error("geojson is invalid")}if(f===null)return null;var s=f.coordinates;switch(f.type){case"Point":case"MultiPoint":return null;case"LineString":return i<0&&(i=s.length+i-1),cr([s[i],s[i+1]],o,e);case"Polygon":return a<0&&(a=s.length+a),i<0&&(i=s[a].length+i-1),cr([s[a][i],s[a][i+1]],o,e);case"MultiLineString":return n<0&&(n=s.length+n),i<0&&(i=s[n].length+i-1),cr([s[n][i],s[n][i+1]],o,e);case"MultiPolygon":return n<0&&(n=s.length+n),a<0&&(a=s[n].length+a),i<0&&(i=s[n][a].length-i-1),cr([s[n][a][i],s[n][a][i+1]],o,e)}throw new Error("geojson is invalid")}function ta(r,e){if(e=e||{},!pr(e))throw new Error("options is invalid");var t=e.featureIndex||0,n=e.multiFeatureIndex||0,a=e.geometryIndex||0,i=e.coordIndex||0,o=e.properties,f;switch(r.type){case"FeatureCollection":t<0&&(t=r.features.length+t),o=o||r.features[t].properties,f=r.features[t].geometry;break;case"Feature":o=o||r.properties,f=r.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":f=r;break;default:throw new Error("geojson is invalid")}if(f===null)return null;var s=f.coordinates;switch(f.type){case"Point":return T(s,o,e);case"MultiPoint":return n<0&&(n=s.length+n),T(s[n],o,e);case"LineString":return i<0&&(i=s.length+i),T(s[i],o,e);case"Polygon":return a<0&&(a=s.length+a),i<0&&(i=s[a].length+i),T(s[a][i],o,e);case"MultiLineString":return n<0&&(n=s.length+n),i<0&&(i=s[n].length+i),T(s[n][i],o,e);case"MultiPolygon":return n<0&&(n=s.length+n),a<0&&(a=s[n].length+a),i<0&&(i=s[n][a].length-i),T(s[n][a][i],o,e)}throw new Error("geojson is invalid")}const na=Object.freeze(Object.defineProperty({__proto__:null,coordAll:we,coordEach:Mr,coordReduce:wt,featureEach:vr,featureReduce:Et,findPoint:ta,findSegment:ea,flattenEach:Nr,flattenReduce:ra,geomEach:Kr,geomReduce:Mt,lineEach:Lt,lineReduce:xt,propEach:mt,propReduce:Vn,segmentEach:Vr,segmentReduce:Pt},Symbol.toStringTag,{value:"Module"}));function Pr(r){var e=[1/0,1/0,-1/0,-1/0];return Mr(r,function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])}),e}Pr.default=Pr;const gi=Object.freeze(Object.defineProperty({__proto__:null,default:Pr},Symbol.toStringTag,{value:"Module"}));function yr(r){if(!r)throw new Error("coord is required");if(!Array.isArray(r)){if(r.type==="Feature"&&r.geometry!==null&&r.geometry.type==="Point")return r.geometry.coordinates;if(r.type==="Point")return r.coordinates}if(Array.isArray(r)&&r.length>=2&&!Array.isArray(r[0])&&!Array.isArray(r[1]))return r;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function z(r){if(Array.isArray(r))return r;if(r.type==="Feature"){if(r.geometry!==null)return r.geometry.coordinates}else if(r.coordinates)return r.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function Ct(r){if(r.length>1&&qr(r[0])&&qr(r[1]))return!0;if(Array.isArray(r[0])&&r[0].length)return Ct(r[0]);throw new Error("coordinates must only contain numbers")}function aa(r,e,t){if(!e||!t)throw new Error("type and name required");if(!r||r.type!==e)throw new Error("Invalid input to "+t+": must be a "+e+", given "+r.type)}function Ce(r,e,t){if(!r)throw new Error("No feature passed");if(!t)throw new Error(".featureOf() requires a name");if(!r||r.type!=="Feature"||!r.geometry)throw new Error("Invalid input to "+t+", Feature with geometry required");if(!r.geometry||r.geometry.type!==e)throw new Error("Invalid input to "+t+": must be a "+e+", given "+r.geometry.type)}function ne(r,e,t){if(!r)throw new Error("No featureCollection passed");if(!t)throw new Error(".collectionOf() requires a name");if(!r||r.type!=="FeatureCollection")throw new Error("Invalid input to "+t+", FeatureCollection required");for(var n=0,a=r.features;n<a.length;n++){var i=a[n];if(!i||i.type!=="Feature"||!i.geometry)throw new Error("Invalid input to "+t+", Feature with geometry required");if(!i.geometry||i.geometry.type!==e)throw new Error("Invalid input to "+t+": must be a "+e+", given "+i.geometry.type)}}function mr(r){return r.type==="Feature"?r.geometry:r}function Jr(r,e){return r.type==="FeatureCollection"?"FeatureCollection":r.type==="GeometryCollection"?"GeometryCollection":r.type==="Feature"&&r.geometry!==null?r.geometry.type:r.type}const wi=Object.freeze(Object.defineProperty({__proto__:null,collectionOf:ne,containsNumber:Ct,featureOf:Ce,geojsonType:aa,getCoord:yr,getCoords:z,getGeom:mr,getType:Jr},Symbol.toStringTag,{value:"Module"}));/**
* @license GNU Affero General Public License.
* Copyright (c) 2015, 2015 Ronny Lorenz <ronny@tbi.univie.ac.at>
* v. 1.2.0
* https://github.com/RaumZeit/MarchingSquares.js
*
* MarchingSquaresJS is free software: you can redistribute it and/or modify
* it under the terms of the GNU Affero General Public License as published by
* the Free Software Foundation, either version 3 of the License, or
* (at your option) any later version.
*
* MarchingSquaresJS is distributed in the hope that it will be useful,
* but WITHOUT ANY WARRANTY; without even the implied warranty of
* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
* GNU Affero General Public License for more details.
*
* As additional permission under GNU Affero General Public License version 3
* section 7, third-party projects (personal or commercial) may distribute,
* include, or link against UNMODIFIED VERSIONS of MarchingSquaresJS without the
* requirement that said third-party project for that reason alone becomes
* subject to any requirement of the GNU Affero General Public License version 3.
* Any modifications to MarchingSquaresJS, however, must be shared with the public
* and made available.
*
* In summary this:
* - allows you to use MarchingSquaresJS at no cost
* - allows you to use MarchingSquaresJS for both personal and commercial purposes
* - allows you to distribute UNMODIFIED VERSIONS of MarchingSquaresJS under any
*   license as long as this license notice is included
* - enables you to keep the source code of your program that uses MarchingSquaresJS
*   undisclosed
* - forces you to share any modifications you have made to MarchingSquaresJS,
*   e.g. bug-fixes
*
* You should have received a copy of the GNU Affero General Public License
* along with MarchingSquaresJS.  If not, see <http://www.gnu.org/licenses/>.
*/var Zt={successCallback:null,verbose:!1},Ie={};function mi(r,e,t){t=t||{};for(var n=Object.keys(Zt),a=0;a<n.length;a++){var i=n[a],o=t[i];o=typeof o<"u"&&o!==null?o:Zt[i],Ie[i]=o}Ie.verbose;var f=Pi(Ei(r,e));return typeof Ie.successCallback=="function"&&Ie.successCallback(f),f}function lr(r,e,t){return(r-e)/(t-e)}function Ei(r,e){for(var t=r.length-1,n=r[0].length-1,a={rows:t,cols:n,cells:[]},i=0;i<t;++i){a.cells[i]=[];for(var o=0;o<n;++o){var f=0,s=r[i+1][o],u=r[i+1][o+1],h=r[i][o+1],v=r[i][o];if(!(isNaN(s)||isNaN(u)||isNaN(h)||isNaN(v))){f|=s>=e?8:0,f|=u>=e?4:0,f|=h>=e?2:0,f|=v>=e?1:0;var c=!1;if(f===5||f===10){var d=(s+u+h+v)/4;f===5&&d<e?(f=10,c=!0):f===10&&d<e&&(f=5,c=!0)}if(f!==0&&f!==15){var E,g,P,m;E=g=P=m=.5,f===1?(P=1-lr(e,s,v),g=1-lr(e,h,v)):f===2?(g=lr(e,v,h),m=1-lr(e,u,h)):f===3?(P=1-lr(e,s,v),m=1-lr(e,u,h)):f===4?(E=lr(e,s,u),m=lr(e,h,u)):f===5?(E=lr(e,s,u),m=lr(e,h,u),g=1-lr(e,h,v),P=1-lr(e,s,v)):f===6?(g=lr(e,v,h),E=lr(e,s,u)):f===7?(P=1-lr(e,s,v),E=lr(e,s,u)):f===8?(P=lr(e,v,s),E=1-lr(e,u,s)):f===9?(g=1-lr(e,h,v),E=1-lr(e,u,s)):f===10?(E=1-lr(e,u,s),m=1-lr(e,u,h),g=lr(e,v,h),P=lr(e,v,s)):f===11?(E=1-lr(e,u,s),m=1-lr(e,u,h)):f===12?(P=lr(e,v,s),m=lr(e,h,u)):f===13?(g=1-lr(e,h,v),m=lr(e,h,u)):f===14&&(P=lr(e,v,s),g=lr(e,v,h)),a.cells[i][o]={cval:f,flipped:c,top:E,right:m,bottom:g,left:P}}}}}return a}function Mi(r){return r.cval===5||r.cval===10}function ia(r){return r.cval===0||r.cval===15}function Ut(r){!ia(r)&&r.cval!==5&&r.cval!==10&&(r.cval=15)}function Ve(r,e){if(e==="top")return[r.top,1];if(e==="bottom")return[r.bottom,0];if(e==="right")return[1,r.right];if(e==="left")return[0,r.left]}function Pi(r){var e=[],t=0,n=1e-7;return r.cells.forEach(function(a,i){a.forEach(function(o,f){if(typeof o<"u"&&!Mi(o)&&!ia(o)){var s=Li(r.cells,i,f),u=!1;if(s.info==="mergeable"){for(var h=s.path[s.path.length-1][0],v=s.path[s.path.length-1][1],c=t-1;c>=0;c--)if(Math.abs(e[c][0][0]-h)<=n&&Math.abs(e[c][0][1]-v)<=n){for(var d=s.path.length-2;d>=0;--d)e[c].unshift(s.path[d]);u=!0;break}}u||(e[t++]=s.path)}})}),e}function Li(r,e,t){var n=r.length,a=[],i=[0,0,1,1,0,0,0,0,-1,0,1,1,-1,0,-1,0],o=[0,-1,0,0,1,1,1,1,0,-1,0,0,0,-1,0,0],f,s,u=["none","left","bottom","left","right","none","bottom","left","top","top","none","top","right","right","bottom","none"],h=["none","bottom","right","right","top","top","top","top","left","bottom","right","right","left","bottom","left","none"],d,v=r[e][t],c=v.cval,d=u[c],E=Ve(v,d);a.push([t+E[0],e+E[1]]),d=h[c],E=Ve(v,d),a.push([t+E[0],e+E[1]]),Ut(v);for(var g=t+i[c],P=e+o[c],m=c;g>=0&&P>=0&&P<n&&(g!=t||P!=e)&&(v=r[P][g],!(typeof v>"u"));){if(c=v.cval,c===0||c===15)return{path:a,info:"mergeable"};d=h[c],f=i[c],s=o[c],(c===5||c===10)&&(c===5?v.flipped?o[m]===-1?(d="left",f=-1,s=0):(d="right",f=1,s=0):i[m]===-1&&(d="bottom",f=0,s=-1):c===10&&(v.flipped?i[m]===-1?(d="top",f=0,s=1):(d="bottom",f=0,s=-1):o[m]===1&&(d="left",f=-1,s=0))),E=Ve(v,d),a.push([g+E[0],P+E[1]]),Ut(v),g+=f,P+=s,m=c}return{path:a,info:"closed"}}function xi(r,e){if(e=e||{},!pr(e))throw new Error("options is invalid");var t=e.zProperty||"elevation",n=e.flip,a=e.flags;ne(r,"Point","input must contain Points");for(var i=Ci(r,n),o=[],f=0;f<i.length;f++){for(var s=i[f],u=[],h=0;h<s.length;h++){var v=s[h];v.properties[t]?u.push(v.properties[t]):u.push(0),a===!0&&(v.properties.matrixPosition=[f,h])}o.push(u)}return o}function Ci(r,e){var t={};vr(r,function(i){var o=z(i)[1];t[o]||(t[o]=[]),t[o].push(i)});var n=Object.keys(t).map(function(i){var o=t[i],f=o.sort(function(s,u){return z(s)[0]-z(u)[0]});return f}),a=n.sort(function(i,o){return e?z(i[0])[1]-z(o[0])[1]:z(o[0])[1]-z(i[0])[1]});return a}function Ai(r,e,t){if(t=t||{},!pr(t))throw new Error("options is invalid");var n=t.zProperty||"elevation",a=t.commonProperties||{},i=t.breaksProperties||[];if(ne(r,"Point","Input must contain Points"),!e)throw new Error("breaks is required");if(!Array.isArray(e))throw new Error("breaks must be an Array");if(!pr(a))throw new Error("commonProperties must be an Object");if(!Array.isArray(i))throw new Error("breaksProperties must be an Array");var o=xi(r,{zProperty:n,flip:!0}),f=Oi(o,e,n,a,i),s=Si(f,o,r);return N(s)}function Oi(r,e,t,n,a){for(var i=[],o=1;o<e.length;o++){var f=+e[o],s=pt({},n,a[o]);s[t]=f;var u=ue(mi(r,f),s);i.push(u)}return i}function Si(r,e,t){var n=Pr(t),a=n[2]-n[0],i=n[3]-n[1],o=n[0],f=n[1],s=e[0].length-1,u=e.length-1,h=a/s,v=i/u,c=function(d){d[0]=d[0]*h+o,d[1]=d[1]*v+f};return r.forEach(function(d){Mr(d,c)}),r}function oa(r,e){e===void 0&&(e={}),e.concavity=e.concavity||1/0;var t=[];if(Mr(r,function(a){t.push([a[0],a[1]])}),!t.length)return null;var n=oi(t,e.concavity);return n.length>3?D([n]):null}function wr(r,e,t){if(t===void 0&&(t={}),!r)throw new Error("point is required");if(!e)throw new Error("polygon is required");var n=yr(r),a=mr(e),i=a.type,o=e.bbox,f=a.coordinates;if(o&&qi(n,o)===!1)return!1;i==="Polygon"&&(f=[f]);for(var s=!1,u=0;u<f.length&&!s;u++)if(Qt(n,f[u][0],t.ignoreBoundary)){for(var h=!1,v=1;v<f[u].length&&!h;)Qt(n,f[u][v],!t.ignoreBoundary)&&(h=!0),v++;h||(s=!0)}return s}function Qt(r,e,t){var n=!1;e[0][0]===e[e.length-1][0]&&e[0][1]===e[e.length-1][1]&&(e=e.slice(0,e.length-1));for(var a=0,i=e.length-1;a<e.length;i=a++){var o=e[a][0],f=e[a][1],s=e[i][0],u=e[i][1],h=r[1]*(o-s)+f*(s-r[0])+u*(r[0]-o)===0&&(o-r[0])*(s-r[0])<=0&&(f-r[1])*(u-r[1])<=0;if(h)return!t;var v=f>r[1]!=u>r[1]&&r[0]<(s-o)*(r[1]-f)/(u-f)+o;v&&(n=!n)}return n}function qi(r,e){return e[0]<=r[0]&&e[1]<=r[1]&&e[2]>=r[0]&&e[3]>=r[1]}function ot(r,e){var t=[];return vr(r,function(n){var a=!1;if(n.geometry.type==="Point")Kr(e,function(o){wr(n,o)&&(a=!0)}),a&&t.push(n);else if(n.geometry.type==="MultiPoint"){var i=[];Kr(e,function(o){Mr(n,function(f){wr(f,o)&&(a=!0,i.push(f))})}),a&&t.push(Be(i))}else throw new Error("Input geometry must be a Point or MultiPoint")}),N(t)}function dr(r,e,t){t===void 0&&(t={});var n=yr(r),a=yr(e),i=Sr(a[1]-n[1]),o=Sr(a[0]-n[0]),f=Sr(n[1]),s=Sr(a[1]),u=Math.pow(Math.sin(i/2),2)+Math.pow(Math.sin(o/2),2)*Math.cos(f)*Math.cos(s);return ge(2*Math.atan2(Math.sqrt(u),Math.sqrt(1-u)),t.units)}function ua(r,e){var t=!1;return N(Fi(r.features.map(function(n){var a={x:n.geometry.coordinates[0],y:n.geometry.coordinates[1]};return e?a.z=n.properties[e]:n.geometry.coordinates.length===3&&(t=!0,a.z=n.geometry.coordinates[2]),a})).map(function(n){var a=[n.a.x,n.a.y],i=[n.b.x,n.b.y],o=[n.c.x,n.c.y],f={};return t?(a.push(n.a.z),i.push(n.b.z),o.push(n.c.z)):f={a:n.a.z,b:n.b.z,c:n.c.z},D([[a,i,o,a]],f)}))}var Yt=function(){function r(e,t,n){this.a=e,this.b=t,this.c=n;var a=t.x-e.x,i=t.y-e.y,o=n.x-e.x,f=n.y-e.y,s=a*(e.x+t.x)+i*(e.y+t.y),u=o*(e.x+n.x)+f*(e.y+n.y),h=2*(a*(n.y-t.y)-i*(n.x-t.x)),v,c;this.x=(f*s-i*u)/h,this.y=(a*u-o*s)/h,v=this.x-e.x,c=this.y-e.y,this.r=v*v+c*c}return r}();function Bi(r,e){return e.x-r.x}function ki(r){var e=r.length,t,n,a,i,o;r:for(;e;)for(n=r[--e],t=r[--e],a=e;a;)if(o=r[--a],i=r[--a],t===i&&n===o||t===o&&n===i){r.splice(e,2),r.splice(a,2),e-=2;continue r}}function Fi(r){if(r.length<3)return[];r.sort(Bi);for(var e=r.length-1,t=r[e].x,n=r[0].x,a=r[e].y,i=a,o=1e-12,f,s,u,h,v,c;e--;)r[e].y<a&&(a=r[e].y),r[e].y>i&&(i=r[e].y);var d=n-t,E=i-a,g=d>E?d:E,P=(n+t)*.5,m=(i+a)*.5,l=[new Yt({__sentinel:!0,x:P-20*g,y:m-g},{__sentinel:!0,x:P,y:m+20*g},{__sentinel:!0,x:P+20*g,y:m-g})],w=[],L=[],M;for(e=r.length;e--;){for(L.length=0,M=l.length;M--;){if(d=r[e].x-l[M].x,d>0&&d*d>l[M].r){w.push(l[M]),l.splice(M,1);continue}E=r[e].y-l[M].y,!(d*d+E*E>l[M].r)&&(L.push(l[M].a,l[M].b,l[M].b,l[M].c,l[M].c,l[M].a),l.splice(M,1))}for(ki(L),M=L.length;M;)s=L[--M],f=L[--M],u=r[e],h=s.x-f.x,v=s.y-f.y,c=2*(h*(u.y-s.y)-v*(u.x-s.x)),Math.abs(c)>o&&l.push(new Yt(f,s,u))}for(Array.prototype.push.apply(w,l),e=w.length;e--;)(w[e].a.__sentinel||w[e].b.__sentinel||w[e].c.__sentinel)&&w.splice(e,1);return w}function Tr(r){if(!r)throw new Error("geojson is required");switch(r.type){case"Feature":return sa(r);case"FeatureCollection":return Ni(r);case"Point":case"LineString":case"Polygon":case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"GeometryCollection":return At(r);default:throw new Error("unknown GeoJSON type")}}function sa(r){var e={type:"Feature"};return Object.keys(r).forEach(function(t){switch(t){case"type":case"properties":case"geometry":return;default:e[t]=r[t]}}),e.properties=fa(r.properties),e.geometry=At(r.geometry),e}function fa(r){var e={};return r&&Object.keys(r).forEach(function(t){var n=r[t];typeof n=="object"?n===null?e[t]=null:Array.isArray(n)?e[t]=n.map(function(a){return a}):e[t]=fa(n):e[t]=n}),e}function Ni(r){var e={type:"FeatureCollection"};return Object.keys(r).forEach(function(t){switch(t){case"type":case"features":return;default:e[t]=r[t]}}),e.features=r.features.map(function(t){return sa(t)}),e}function At(r){var e={type:r.type};return r.bbox&&(e.bbox=r.bbox),r.type==="GeometryCollection"?(e.geometries=r.geometries.map(function(t){return At(t)}),e):(e.coordinates=ha(r.coordinates),e)}function ha(r){var e=r;return typeof e[0]!="object"?e.slice():e.map(function(t){return ha(t)})}function Ii(r,e){if(e===void 0&&(e={}),e=e||{},!pr(e))throw new Error("options is invalid");var t=e.mutate;if(Jr(r)!=="FeatureCollection")throw new Error("geojson must be a FeatureCollection");if(!r.features.length)throw new Error("geojson is empty");(t===!1||t===void 0)&&(r=Tr(r));var n=[],a=xt(r,function(i,o){var f=zi(i,o);return f||(n.push(i),o)});return a&&n.push(a),n.length?n.length===1?n[0]:ue(n.map(function(i){return i.coordinates})):null}function ze(r){return r[0].toString()+","+r[1].toString()}function zi(r,e){var t=r.geometry.coordinates,n=e.geometry.coordinates,a=ze(t[0]),i=ze(t[t.length-1]),o=ze(n[0]),f=ze(n[n.length-1]),s;if(a===f)s=n.concat(t.slice(1));else if(o===i)s=t.concat(n.slice(1));else if(a===o)s=t.slice(1).reverse().concat(n);else if(i===f)s=t.concat(n.reverse().slice(1));else return null;return cr(s)}function Ti(r,e){if(e===void 0&&(e={}),Jr(r)!=="FeatureCollection")throw new Error("geojson must be a FeatureCollection");if(!r.features.length)throw new Error("geojson is empty");(e.mutate===!1||e.mutate===void 0)&&(r=Tr(r));var t=[];Nr(r,function(i){t.push(i.geometry)});var n=si({geoms:gt(t).geometry}),a=ui(n,n.objects.geoms.geometries);return a}function Di(r,e){if(e===void 0&&(e={}),e=e||{},!pr(e))throw new Error("options is invalid");var t=e.mutate;if(Jr(r)!=="FeatureCollection")throw new Error("geojson must be a FeatureCollection");if(!r.features.length)throw new Error("geojson is empty");(t===!1||t===void 0)&&(r=Tr(r));var n=Gi(r);if(!n)throw new Error("geojson must be homogenous");var a=r;switch(n){case"LineString":return Ii(a,e);case"Polygon":return Ti(a,e);default:throw new Error(n+" is not supported")}}function Gi(r){var e={};Nr(r,function(n){e[n.geometry.type]=!0});var t=Object.keys(e);return t.length===1?t[0]:null}function Ri(r,e){e===void 0&&(e={});var t=e.maxEdge||1/0,n=$i(r),a=ua(n);if(a.features=a.features.filter(function(o){var f=o.geometry.coordinates[0][0],s=o.geometry.coordinates[0][1],u=o.geometry.coordinates[0][2],h=dr(f,s,e),v=dr(s,u,e),c=dr(f,u,e);return h<=t&&v<=t&&c<=t}),a.features.length<1)return null;var i=Di(a);return i.coordinates.length===1&&(i.coordinates=i.coordinates[0],i.type="Polygon"),Cr(i)}function $i(r){var e=[],t={};return vr(r,function(n){if(n.geometry){var a=n.geometry.coordinates.join("-");Object.prototype.hasOwnProperty.call(t,a)||(e.push(n),t[a]=!0)}}),N(e)}function Wi(r,e,t,n){var a=lt(6),i=e.features.map(function(o){var f;return{minX:o.geometry.coordinates[0],minY:o.geometry.coordinates[1],maxX:o.geometry.coordinates[0],maxY:o.geometry.coordinates[1],property:(f=o.properties)===null||f===void 0?void 0:f[t]}});return a.load(i),r.features.forEach(function(o){o.properties||(o.properties={});var f=Pr(o),s=a.search({minX:f[0],minY:f[1],maxX:f[2],maxY:f[3]}),u=[];s.forEach(function(h){wr([h.minX,h.minY],o)&&u.push(h.property)}),o.properties[n]=u}),r}function Ji(r,e){if(e=e||{},!pr(e))throw new Error("options is invalid");var t=e.mutate;if(!r)throw new Error("geojson is required");return(t===!1||t===void 0)&&(r=Tr(r)),Mr(r,function(n){var a=n[0],i=n[1];n[0]=i,n[1]=a}),r}function ce(r,e){e===void 0&&(e={});var t=typeof e=="object"?e.mutate:e;if(!r)throw new Error("geojson is required");var n=Jr(r),a=[];switch(n){case"LineString":a=rt(r);break;case"MultiLineString":case"Polygon":z(r).forEach(function(o){a.push(rt(o))});break;case"MultiPolygon":z(r).forEach(function(o){var f=[];o.forEach(function(s){f.push(rt(s))}),a.push(f)});break;case"Point":return r;case"MultiPoint":var i={};z(r).forEach(function(o){var f=o.join("-");Object.prototype.hasOwnProperty.call(i,f)||(a.push(o),i[f]=!0)});break;default:throw new Error(n+" geometry not supported")}return r.coordinates?t===!0?(r.coordinates=a,r):{type:n,coordinates:a}:t===!0?(r.geometry.coordinates=a,r):Cr({type:n,coordinates:a},r.properties,{bbox:r.bbox,id:r.id})}function rt(r){var e=z(r);if(e.length===2&&!_t(e[0],e[1]))return e;var t=[],n=e.length-1,a=t.length;t.push(e[0]);for(var i=1;i<n;i++){var o=t[t.length-1];e[i][0]===o[0]&&e[i][1]===o[1]||(t.push(e[i]),a=t.length,a>2&&bt(t[a-3],t[a-1],t[a-2])&&t.splice(t.length-2,1))}if(t.push(e[e.length-1]),a=t.length,_t(e[0],e[e.length-1])&&a<4)throw new Error("invalid polygon");return bt(t[a-3],t[a-1],t[a-2])&&t.splice(t.length-2,1),t}function _t(r,e){return r[0]===e[0]&&r[1]===e[1]}function bt(r,e,t){var n=t[0],a=t[1],i=r[0],o=r[1],f=e[0],s=e[1],u=n-i,h=a-o,v=f-i,c=s-o,d=u*c-h*v;return d!==0?!1:Math.abs(v)>=Math.abs(c)?v>0?i<=n&&n<=f:f<=n&&n<=i:c>0?o<=a&&a<=s:s<=a&&a<=o}function Hi(r,e){var t=r.x-e.x,n=r.y-e.y;return t*t+n*n}function Xi(r,e,t){var n=e.x,a=e.y,i=t.x-n,o=t.y-a;if(i!==0||o!==0){var f=((r.x-n)*i+(r.y-a)*o)/(i*i+o*o);f>1?(n=t.x,a=t.y):f>0&&(n+=i*f,a+=o*f)}return i=r.x-n,o=r.y-a,i*i+o*o}function Ki(r,e){for(var t=r[0],n=[t],a,i=1,o=r.length;i<o;i++)a=r[i],Hi(a,t)>e&&(n.push(a),t=a);return t!==a&&n.push(a),n}function ut(r,e,t,n,a){for(var i=n,o,f=e+1;f<t;f++){var s=Xi(r[f],r[e],r[t]);s>i&&(o=f,i=s)}i>n&&(o-e>1&&ut(r,e,o,n,a),a.push(r[o]),t-o>1&&ut(r,o,t,n,a))}function Zi(r,e){var t=r.length-1,n=[r[0]];return ut(r,0,t,e,n),n.push(r[t]),n}function st(r,e,t){if(r.length<=2)return r;var n=e!==void 0?e*e:1;return r=t?r:Ki(r,n),r=Zi(r,n),r}function Ui(r,e){if(e=e||{},!pr(e))throw new Error("options is invalid");var t=e.tolerance!==void 0?e.tolerance:1,n=e.highQuality||!1,a=e.mutate||!1;if(!r)throw new Error("geojson is required");if(t&&t<0)throw new Error("invalid tolerance");return a!==!0&&(r=Tr(r)),Kr(r,function(i){Qi(i,t,n)}),r}function Qi(r,e,t){var n=r.type;if(n==="Point"||n==="MultiPoint")return r;ce(r,!0);var a=r.coordinates;switch(n){case"LineString":r.coordinates=jt(a,e,t);break;case"MultiLineString":r.coordinates=a.map(function(i){return jt(i,e,t)});break;case"Polygon":r.coordinates=Vt(a,e,t);break;case"MultiPolygon":r.coordinates=a.map(function(i){return Vt(i,e,t)})}return r}function jt(r,e,t){return st(r.map(function(n){return{x:n[0],y:n[1],z:n[2]}}),e,t).map(function(n){return n.z?[n.x,n.y,n.z]:[n.x,n.y]})}function Vt(r,e,t){return r.map(function(n){var a=n.map(function(o){return{x:o[0],y:o[1]}});if(a.length<4)throw new Error("invalid polygon");for(var i=st(a,e,t).map(function(o){return[o.x,o.y]});!Yi(i);)e-=e*.01,i=st(a,e,t).map(function(o){return[o.x,o.y]});return(i[i.length-1][0]!==i[0][0]||i[i.length-1][1]!==i[0][1])&&i.push(i[0]),i})}function Yi(r){return r.length<3?!1:!(r.length===3&&r[2][0]===r[0][0]&&r[2][1]===r[0][1])}var _i=function(){function r(e){this.points=e.points||[],this.duration=e.duration||1e4,this.sharpness=e.sharpness||.85,this.centers=[],this.controls=[],this.stepLength=e.stepLength||60,this.length=this.points.length,this.delay=0;for(var t=0;t<this.length;t++)this.points[t].z=this.points[t].z||0;for(var t=0;t<this.length-1;t++){var n=this.points[t],a=this.points[t+1];this.centers.push({x:(n.x+a.x)/2,y:(n.y+a.y)/2,z:(n.z+a.z)/2})}this.controls.push([this.points[0],this.points[0]]);for(var t=0;t<this.centers.length-1;t++){var i=this.points[t+1].x-(this.centers[t].x+this.centers[t+1].x)/2,o=this.points[t+1].y-(this.centers[t].y+this.centers[t+1].y)/2,f=this.points[t+1].z-(this.centers[t].y+this.centers[t+1].z)/2;this.controls.push([{x:(1-this.sharpness)*this.points[t+1].x+this.sharpness*(this.centers[t].x+i),y:(1-this.sharpness)*this.points[t+1].y+this.sharpness*(this.centers[t].y+o),z:(1-this.sharpness)*this.points[t+1].z+this.sharpness*(this.centers[t].z+f)},{x:(1-this.sharpness)*this.points[t+1].x+this.sharpness*(this.centers[t+1].x+i),y:(1-this.sharpness)*this.points[t+1].y+this.sharpness*(this.centers[t+1].y+o),z:(1-this.sharpness)*this.points[t+1].z+this.sharpness*(this.centers[t+1].z+f)}])}return this.controls.push([this.points[this.length-1],this.points[this.length-1]]),this.steps=this.cacheSteps(this.stepLength),this}return r.prototype.cacheSteps=function(e){var t=[],n=this.pos(0);t.push(0);for(var a=0;a<this.duration;a+=10){var i=this.pos(a),o=Math.sqrt((i.x-n.x)*(i.x-n.x)+(i.y-n.y)*(i.y-n.y)+(i.z-n.z)*(i.z-n.z));o>e&&(t.push(a),n=i)}return t},r.prototype.vector=function(e){var t=this.pos(e+10),n=this.pos(e-10);return{angle:180*Math.atan2(t.y-n.y,t.x-n.x)/3.14,speed:Math.sqrt((n.x-t.x)*(n.x-t.x)+(n.y-t.y)*(n.y-t.y)+(n.z-t.z)*(n.z-t.z))}},r.prototype.pos=function(e){var t=e-this.delay;t<0&&(t=0),t>this.duration&&(t=this.duration-1);var n=t/this.duration;if(n>=1)return this.points[this.length-1];var a=Math.floor((this.points.length-1)*n),i=(this.length-1)*n-a;return bi(i,this.points[a],this.controls[a][1],this.controls[a+1][0],this.points[a+1])},r}();function bi(r,e,t,n,a){var i=ji(r),o={x:a.x*i[0]+n.x*i[1]+t.x*i[2]+e.x*i[3],y:a.y*i[0]+n.y*i[1]+t.y*i[2]+e.y*i[3],z:a.z*i[0]+n.z*i[1]+t.z*i[2]+e.z*i[3]};return o}function ji(r){var e=r*r,t=e*r;return[t,3*e*(1-r),3*r*(1-r)*(1-r),(1-r)*(1-r)*(1-r)]}function rn(r,e){e===void 0&&(e={});for(var t=e.resolution||1e4,n=e.sharpness||.85,a=[],i=mr(r).coordinates.map(function(u){return{x:u[0],y:u[1]}}),o=new _i({duration:t,points:i,sharpness:n}),f=function(u){var h=o.pos(u);Math.floor(u/100)%2===0&&a.push([h.x,h.y])},s=0;s<o.duration;s+=10)f(s);return f(o.duration),cr(a,e.properties)}function Vi(r,e,t,n){return r=Tr(r),e=Tr(e),vr(r,function(a){a.properties||(a.properties={}),vr(e,function(i){a.properties[n]===void 0&&wr(a,i)&&(a.properties[n]=i.properties[t])})}),r}function ro(r,e){if(!r)throw new Error("featurecollection is required");if(e==null)throw new Error("num is required");if(typeof e!="number")throw new Error("num must be a number");var t=N(eo(r.features,e));return t}function eo(r,e){for(var t=r.slice(0),n=r.length,a=n-e,i,o;n-- >a;)o=Math.floor((n+1)*Math.random()),i=t[o],t[o]=t[n],t[n]=i;return t.slice(a)}function Ot(r,e){e===void 0&&(e={});var t=Number(r[0]),n=Number(r[1]),a=Number(r[2]),i=Number(r[3]);if(r.length===6)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");var o=[t,n],f=[t,i],s=[a,i],u=[a,n];return D([[o,u,s,f,o]],e.properties,{bbox:r,id:e.id})}function va(r){return Ot(Pr(r))}function ca(r){var e=r[0],t=r[1],n=r[2],a=r[3],i=dr(r.slice(0,2),[n,t]),o=dr(r.slice(0,2),[e,a]);if(i>=o){var f=(t+a)/2;return[e,f-(n-e)/2,n,f+(n-e)/2]}else{var s=(e+n)/2;return[s-(a-t)/2,t,s+(a-t)/2,a]}}function jr(r,e,t,n){n===void 0&&(n={});var a=yr(r),i=Sr(a[0]),o=Sr(a[1]),f=Sr(t),s=fe(e,n.units),u=Math.asin(Math.sin(o)*Math.cos(s)+Math.cos(o)*Math.sin(s)*Math.cos(f)),h=i+Math.atan2(Math.sin(f)*Math.sin(s)*Math.cos(o),Math.cos(s)-Math.sin(o)*Math.sin(u)),v=ie(h),c=ie(u);return T([v,c],n.properties)}function St(r,e,t){t===void 0&&(t={});for(var n=t.steps||64,a=t.properties?t.properties:!Array.isArray(r)&&r.type==="Feature"&&r.properties?r.properties:{},i=[],o=0;o<n;o++)i.push(jr(r,e,o*-360/n,t).geometry.coordinates);return i.push(i[0]),D([i],a)}function te(r,e,t){if(t===void 0&&(t={}),t.final===!0)return to(r,e);var n=yr(r),a=yr(e),i=Sr(n[0]),o=Sr(a[0]),f=Sr(n[1]),s=Sr(a[1]),u=Math.sin(o-i)*Math.cos(s),h=Math.cos(f)*Math.sin(s)-Math.sin(f)*Math.cos(s)*Math.cos(o-i);return ie(Math.atan2(u,h))}function to(r,e){var t=te(e,r);return t=(t+180)%360,t}function no(r,e){var t=dr(r,e),n=te(r,e),a=jr(r,t/2,n);return a}function Ze(r,e){e===void 0&&(e={});var t=Pr(r),n=(t[0]+t[2])/2,a=(t[1]+t[3])/2;return T([n,a],e.properties,e)}function oe(r,e){e===void 0&&(e={});var t=0,n=0,a=0;return Mr(r,function(i){t+=i[0],n+=i[1],a++},!0),T([t/a,n/a],e.properties)}function da(r,e){switch(e===void 0&&(e={}),Jr(r)){case"Point":return T(yr(r),e.properties);case"Polygon":var t=[];Mr(r,function(L){t.push(L)});var n=oe(r,{properties:e.properties}),a=n.geometry.coordinates,i=0,o=0,f=0,s,u,h,v,c,d,E,g,P=t.map(function(L){return[L[0]-a[0],L[1]-a[1]]});for(s=0;s<t.length-1;s++)u=P[s],v=u[0],d=u[1],h=P[s+1],c=h[0],E=h[1],g=v*E-c*d,f+=g,i+=(v+c)*g,o+=(d+E)*g;if(f===0)return n;var m=f*.5,l=1/(6*m);return T([a[0]+l*i,a[1]+l*o],e.properties);default:var w=oa(r);return w?da(w,{properties:e.properties}):oe(r,{properties:e.properties})}}function ao(r){var e={MultiPoint:{coordinates:[],properties:[]},MultiLineString:{coordinates:[],properties:[]},MultiPolygon:{coordinates:[],properties:[]}};return vr(r,function(t){var n,a,i,o;switch((o=t.geometry)===null||o===void 0?void 0:o.type){case"Point":e.MultiPoint.coordinates.push(t.geometry.coordinates),e.MultiPoint.properties.push(t.properties);break;case"MultiPoint":(n=e.MultiPoint.coordinates).push.apply(n,t.geometry.coordinates),e.MultiPoint.properties.push(t.properties);break;case"LineString":e.MultiLineString.coordinates.push(t.geometry.coordinates),e.MultiLineString.properties.push(t.properties);break;case"MultiLineString":(a=e.MultiLineString.coordinates).push.apply(a,t.geometry.coordinates),e.MultiLineString.properties.push(t.properties);break;case"Polygon":e.MultiPolygon.coordinates.push(t.geometry.coordinates),e.MultiPolygon.properties.push(t.properties);break;case"MultiPolygon":(i=e.MultiPolygon.coordinates).push.apply(i,t.geometry.coordinates),e.MultiPolygon.properties.push(t.properties);break}}),N(Object.keys(e).filter(function(t){return e[t].coordinates.length}).sort().map(function(t){var n={type:t,coordinates:e[t].coordinates},a={collectedProperties:e[t].properties};return Cr(n,a)}))}function Ue(r){var e=[];return r.type==="FeatureCollection"?vr(r,function(t){Mr(t,function(n){e.push(T(n,t.properties))})}):Mr(r,function(t){e.push(T(t,r.properties))}),N(e)}function io(r){if(!r.geometry||r.geometry.type!=="Polygon"&&r.geometry.type!=="MultiPolygon")throw new Error("input must be a Polygon or MultiPolygon");var e={type:"FeatureCollection",features:[]};return r.geometry.type==="Polygon"?e.features=en(r.geometry.coordinates):r.geometry.coordinates.forEach(function(t){e.features=e.features.concat(en(t))}),e}function en(r){var e=oo(r),t=2,n=fi(e.vertices,e.holes,t),a=[],i=[];n.forEach(function(s,u){var h=n[u];i.push([e.vertices[h*t],e.vertices[h*t+1]])});for(var o=0;o<i.length;o+=3){var f=i.slice(o,o+3);f.push(i[o]),a.push(D([f]))}return a}function oo(r){for(var e=r[0][0].length,t={vertices:[],holes:[],dimensions:e},n=0,a=0;a<r.length;a++){for(var i=0;i<r[a].length;i++)for(var o=0;o<e;o++)t.vertices.push(r[a][i][o]);a>0&&(n+=r[a-1].length,t.holes.push(n))}return t}function We(r,e){if(!r)throw new Error("targetPoint is required");if(!e)throw new Error("points is required");var t,n=1/0,a=0;return vr(e,function(i,o){var f=dr(r,i);f<n&&(a=o,n=f)}),t=Tr(e.features[a]),t.properties.featureIndex=a,t.properties.distanceToPoint=n,t}function de(r){if(!r)throw new Error("geojson is required");var e=[];return Nr(r,function(t){uo(t,e)}),N(e)}function uo(r,e){var t=[],n=r.geometry;if(n!==null){switch(n.type){case"Polygon":t=z(n);break;case"LineString":t=[z(n)]}t.forEach(function(a){var i=so(a,r.properties);i.forEach(function(o){o.id=e.length,e.push(o)})})}}function so(r,e){var t=[];return r.reduce(function(n,a){var i=cr([n,a],e);return i.bbox=fo(n,a),t.push(i),a}),t}function fo(r,e){var t=r[0],n=r[1],a=e[0],i=e[1],o=t<a?t:a,f=n<i?n:i,s=t>a?t:a,u=n>i?n:i;return[o,f,s,u]}const If=yt(jn),zf=yt(na),Tf=yt(gi);function ae(r,e){var t={},n=[];if(r.type==="LineString"&&(r=Cr(r)),e.type==="LineString"&&(e=Cr(e)),r.type==="Feature"&&e.type==="Feature"&&r.geometry!==null&&e.geometry!==null&&r.geometry.type==="LineString"&&e.geometry.type==="LineString"&&r.geometry.coordinates.length===2&&e.geometry.coordinates.length===2){var a=tn(r,e);return a&&n.push(a),N(n)}var i=Xe();return i.load(de(e)),vr(de(r),function(o){vr(i.search(o),function(f){var s=tn(o,f);if(s){var u=z(s).join(",");t[u]||(t[u]=!0,n.push(s))}})}),N(n)}function tn(r,e){var t=z(r),n=z(e);if(t.length!==2)throw new Error("<intersects> line1 must only contain 2 coordinates");if(n.length!==2)throw new Error("<intersects> line2 must only contain 2 coordinates");var a=t[0][0],i=t[0][1],o=t[1][0],f=t[1][1],s=n[0][0],u=n[0][1],h=n[1][0],v=n[1][1],c=(v-u)*(o-a)-(h-s)*(f-i),d=(h-s)*(i-u)-(v-u)*(a-s),E=(o-a)*(i-u)-(f-i)*(a-s);if(c===0)return null;var g=d/c,P=E/c;if(g>=0&&g<=1&&P>=0&&P<=1){var m=a+g*(o-a),l=i+g*(f-i);return T([m,l])}return null}function re(r,e,t){t===void 0&&(t={});var n=T([1/0,1/0],{dist:1/0}),a=0;return Nr(r,function(i){for(var o=z(i),f=0;f<o.length-1;f++){var s=T(o[f]);s.properties.dist=dr(e,s,t);var u=T(o[f+1]);u.properties.dist=dr(e,u,t);var h=dr(s,u,t),v=Math.max(s.properties.dist,u.properties.dist),c=te(s,u),d=jr(e,v,c+90,t),E=jr(e,v,c-90,t),g=ae(cr([d.geometry.coordinates,E.geometry.coordinates]),cr([s.geometry.coordinates,u.geometry.coordinates])),P=null;g.features.length>0&&(P=g.features[0],P.properties.dist=dr(e,P,t),P.properties.location=a+dr(s,P,t)),s.properties.dist<n.properties.dist&&(n=s,n.properties.index=f,n.properties.location=a),u.properties.dist<n.properties.dist&&(n=u,n.properties.index=f+1,n.properties.location=a+h),P&&P.properties.dist<n.properties.dist&&(n=P,n.properties.index=f),a+=h}}),n}function Qe(r,e,t){t===void 0&&(t={});var n=yr(r),a=yr(e);a[0]+=a[0]-n[0]>180?-360:n[0]-a[0]>180?360:0;var i=ho(n,a),o=ve(i,"meters",t.units);return o}function ho(r,e,t){t=t===void 0?Or:Number(t);var n=t,a=r[1]*Math.PI/180,i=e[1]*Math.PI/180,o=i-a,f=Math.abs(e[0]-r[0])*Math.PI/180;f>Math.PI&&(f-=2*Math.PI);var s=Math.log(Math.tan(i/2+Math.PI/4)/Math.tan(a/2+Math.PI/4)),u=Math.abs(s)>1e-11?o/s:Math.cos(a),h=Math.sqrt(o*o+u*u*f*f),v=h*n;return v}function pa(r,e,t){if(t===void 0&&(t={}),t.method||(t.method="geodesic"),t.units||(t.units="kilometers"),!r)throw new Error("pt is required");if(Array.isArray(r)?r=T(r):r.type==="Point"?r=Cr(r):Ce(r,"Point","point"),!e)throw new Error("line is required");Array.isArray(e)?e=cr(e):e.type==="LineString"?e=Cr(e):Ce(e,"LineString","line");var n=1/0,a=r.geometry.coordinates;return Vr(e,function(i){var o=i.geometry.coordinates[0],f=i.geometry.coordinates[1],s=vo(a,o,f,t);s<n&&(n=s)}),ve(n,"degrees",t.units)}function vo(r,e,t,n){var a=[t[0]-e[0],t[1]-e[1]],i=[r[0]-e[0],r[1]-e[1]],o=nn(i,a);if(o<=0)return et(r,e,{method:n.method,units:"degrees"});var f=nn(a,a);if(f<=o)return et(r,t,{method:n.method,units:"degrees"});var s=o/f,u=[e[0]+s*a[0],e[1]+s*a[1]];return et(r,u,{method:n.method,units:"degrees"})}function nn(r,e){return r[0]*e[0]+r[1]*e[1]}function et(r,e,t){return t.method==="planar"?Qe(r,e,t):dr(r,e,t)}function co(r,e,t){t===void 0&&(t={});var n=t.units,a=t.properties||{},i=po(r);if(!i.features.length)throw new Error("points must contain features");if(!e)throw new Error("line is required");if(Jr(e)!=="LineString")throw new Error("line must be a LineString");var o=1/0,f=null;return vr(i,function(s){var u=pa(s,e,{units:n});u<o&&(o=u,f=s)}),f&&(f.properties=pt({dist:o},f.properties,a)),f}function po(r){var e=[],t=r.geometry?r.geometry.type:r.type;switch(t){case"GeometryCollection":return Kr(r,function(n){n.type==="Point"&&e.push({type:"Feature",properties:{},geometry:n})}),{type:"FeatureCollection",features:e};case"FeatureCollection":return r.features=r.features.filter(function(n){return n.geometry.type==="Point"}),r;default:throw new Error("points must be a Point Collection")}}function lo(r,e){var t=yr(r),n=mr(e),a=n.coordinates,i=a[0];if(i.length<4)throw new Error("OuterRing of a Polygon must have 4 or more Positions.");var o=e.properties||{},f=o.a,s=o.b,u=o.c,h=t[0],v=t[1],c=i[0][0],d=i[0][1],E=f!==void 0?f:i[0][2],g=i[1][0],P=i[1][1],m=s!==void 0?s:i[1][2],l=i[2][0],w=i[2][1],L=u!==void 0?u:i[2][2],M=(L*(h-c)*(v-P)+E*(h-g)*(v-w)+m*(h-l)*(v-d)-m*(h-c)*(v-w)-L*(h-g)*(v-d)-E*(h-l)*(v-P))/((h-c)*(v-P)+(h-g)*(v-w)+(h-l)*(v-d)-(h-c)*(v-w)-(h-g)*(v-d)-(h-l)*(v-P));return M}function yo(r){var e,t,n={type:"FeatureCollection",features:[]};if(r.type==="Feature"?t=r.geometry:t=r,t.type==="LineString")e=[t.coordinates];else if(t.type==="MultiLineString")e=t.coordinates;else if(t.type==="MultiPolygon")e=[].concat.apply([],t.coordinates);else if(t.type==="Polygon")e=t.coordinates;else throw new Error("Input must be a LineString, MultiLineString, Polygon, or MultiPolygon Feature or Geometry");return e.forEach(function(a){e.forEach(function(i){for(var o=0;o<a.length-1;o++)for(var f=o;f<i.length-1;f++)if(!(a===i&&(Math.abs(o-f)===1||o===0&&f===a.length-2&&a[o][0]===a[a.length-1][0]&&a[o][1]===a[a.length-1][1]))){var s=go(a[o][0],a[o][1],a[o+1][0],a[o+1][1],i[f][0],i[f][1],i[f+1][0],i[f+1][1]);s&&n.features.push(T([s[0],s[1]]))}})}),n}function go(r,e,t,n,a,i,o,f){var s,u,h,v,c,d={x:null,y:null,onLine1:!1,onLine2:!1};return s=(f-i)*(t-r)-(o-a)*(n-e),s===0?d.x!==null&&d.y!==null?d:!1:(u=e-i,h=r-a,v=(o-a)*u-(f-i)*h,c=(t-r)*u-(n-e)*h,u=v/s,h=c/s,d.x=r+u*(t-r),d.y=e+u*(n-e),u>=0&&u<=1&&(d.onLine1=!0),h>=0&&h<=1&&(d.onLine2=!0),d.onLine1&&d.onLine2?[d.x,d.y]:!1)}function an(r){for(var e=wo(r),t=Ze(e),n=!1,a=0;!n&&a<e.features.length;){var i=e.features[a].geometry,o,f,s,u,h,v,c,d=!1;if(i.type==="Point")t.geometry.coordinates[0]===i.coordinates[0]&&t.geometry.coordinates[1]===i.coordinates[1]&&(n=!0);else if(i.type==="MultiPoint"){var E=!1;for(c=0;!E&&c<i.coordinates.length;)t.geometry.coordinates[0]===i.coordinates[c][0]&&t.geometry.coordinates[1]===i.coordinates[c][1]&&(n=!0,E=!0),c++}else if(i.type==="LineString")for(c=0;!d&&c<i.coordinates.length-1;)o=t.geometry.coordinates[0],f=t.geometry.coordinates[1],s=i.coordinates[c][0],u=i.coordinates[c][1],h=i.coordinates[c+1][0],v=i.coordinates[c+1][1],on(o,f,s,u,h,v)&&(d=!0,n=!0),c++;else if(i.type==="MultiLineString")for(var g=0;g<i.coordinates.length;){d=!1,c=0;for(var P=i.coordinates[g];!d&&c<P.length-1;)o=t.geometry.coordinates[0],f=t.geometry.coordinates[1],s=P[c][0],u=P[c][1],h=P[c+1][0],v=P[c+1][1],on(o,f,s,u,h,v)&&(d=!0,n=!0),c++;g++}else(i.type==="Polygon"||i.type==="MultiPolygon")&&wr(t,i)&&(n=!0);a++}if(n)return t;var m=N([]);for(a=0;a<e.features.length;a++)m.features=m.features.concat(Ue(e.features[a]).features);return T(We(t,m).geometry.coordinates)}function wo(r){return r.type!=="FeatureCollection"?r.type!=="Feature"?N([Cr(r)]):N([r]):r}function on(r,e,t,n,a,i){var o=Math.sqrt((a-t)*(a-t)+(i-n)*(i-n)),f=Math.sqrt((r-t)*(r-t)+(e-n)*(e-n)),s=Math.sqrt((a-r)*(a-r)+(i-e)*(i-e));return o===f+s}var un=6378137;function qt(r){return Mt(r,function(e,t){return e+mo(t)},0)}function mo(r){var e=0,t;switch(r.type){case"Polygon":return sn(r.coordinates);case"MultiPolygon":for(t=0;t<r.coordinates.length;t++)e+=sn(r.coordinates[t]);return e;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}function sn(r){var e=0;if(r&&r.length>0){e+=Math.abs(fn(r[0]));for(var t=1;t<r.length;t++)e-=Math.abs(fn(r[t]))}return e}function fn(r){var e,t,n,a,i,o,f,s=0,u=r.length;if(u>2){for(f=0;f<u;f++)f===u-2?(a=u-2,i=u-1,o=0):f===u-1?(a=u-1,i=0,o=1):(a=f,i=f+1,o=f+2),e=r[a],t=r[i],n=r[o],s+=(tt(n[0])-tt(e[0]))*Math.sin(tt(t[1]));s=s*un*un/2}return s}function tt(r){return r*Math.PI/180}function Eo(r,e,t){t===void 0&&(t={});for(var n=mr(r),a=n.coordinates,i=0,o=0;o<a.length&&!(e>=i&&o===a.length-1);o++)if(i>=e){var f=e-i;if(f){var s=te(a[o],a[o-1])-180,u=jr(a[o],f,s,t);return u}else return T(a[o])}else i+=dr(a[o],a[o+1],t);return T(a[a.length-1])}function ft(r,e){return e===void 0&&(e={}),Pt(r,function(t,n){var a=n.geometry.coordinates;return t+dr(a[0],a[1],e)},0)}function Mo(r,e,t){var n=z(t);if(Jr(t)!=="LineString")throw new Error("line must be a LineString");var a=re(t,r),i=re(t,e),o;a.properties.index<=i.properties.index?o=[a,i]:o=[i,a];for(var f=[o[0].geometry.coordinates],s=o[0].properties.index+1;s<o[1].properties.index+1;s++)f.push(n[s]);return f.push(o[1].geometry.coordinates),cr(f,t.properties)}function la(r,e,t,n){if(n=n||{},!pr(n))throw new Error("options is invalid");var a,i=[];if(r.type==="Feature")a=r.geometry.coordinates;else if(r.type==="LineString")a=r.coordinates;else throw new Error("input must be a LineString Feature or Geometry");for(var o=a.length,f=0,s,u,h,v=0;v<a.length&&!(e>=f&&v===a.length-1);v++){if(f>e&&i.length===0){if(s=e-f,!s)return i.push(a[v]),cr(i);u=te(a[v],a[v-1])-180,h=jr(a[v],s,u,n),i.push(h.geometry.coordinates)}if(f>=t)return s=t-f,s?(u=te(a[v],a[v-1])-180,h=jr(a[v],s,u,n),i.push(h.geometry.coordinates),cr(i)):(i.push(a[v]),cr(i));if(f>=e&&i.push(a[v]),v===a.length-1)return cr(i);f+=dr(a[v],a[v+1],n)}if(f<e&&a.length===o)throw new Error("Start position is beyond line");var c=a[a.length-1];return cr([c,c])}function Hr(r,e,t){t===void 0&&(t={});for(var n=yr(r),a=z(e),i=0;i<a.length-1;i++){var o=!1;if(t.ignoreEndVertices&&(i===0&&(o="start"),i===a.length-2&&(o="end"),i===0&&i+1===a.length-1&&(o="both")),Po(a[i],a[i+1],n,o,typeof t.epsilon>"u"?null:t.epsilon))return!0}return!1}function Po(r,e,t,n,a){var i=t[0],o=t[1],f=r[0],s=r[1],u=e[0],h=e[1],v=t[0]-f,c=t[1]-s,d=u-f,E=h-s,g=v*E-c*d;if(a!==null){if(Math.abs(g)>a)return!1}else if(g!==0)return!1;if(n){if(n==="start")return Math.abs(d)>=Math.abs(E)?d>0?f<i&&i<=u:u<=i&&i<f:E>0?s<o&&o<=h:h<=o&&o<s;if(n==="end")return Math.abs(d)>=Math.abs(E)?d>0?f<=i&&i<u:u<i&&i<=f:E>0?s<=o&&o<h:h<o&&o<=s;if(n==="both")return Math.abs(d)>=Math.abs(E)?d>0?f<i&&i<u:u<i&&i<f:E>0?s<o&&o<h:h<o&&o<s}else return Math.abs(d)>=Math.abs(E)?d>0?f<=i&&i<=u:u<=i&&i<=f:E>0?s<=o&&o<=h:h<=o&&o<=s;return!1}function ya(r,e){var t=mr(r),n=mr(e),a=t.type,i=n.type;switch(a){case"Point":switch(i){case"MultiPoint":return Lo(t,n);case"LineString":return Hr(t,n,{ignoreEndVertices:!0});case"Polygon":case"MultiPolygon":return wr(t,n,{ignoreBoundary:!0});default:throw new Error("feature2 "+i+" geometry not supported")}case"MultiPoint":switch(i){case"MultiPoint":return xo(t,n);case"LineString":return Co(t,n);case"Polygon":case"MultiPolygon":return Ao(t,n);default:throw new Error("feature2 "+i+" geometry not supported")}case"LineString":switch(i){case"LineString":return Oo(t,n);case"Polygon":case"MultiPolygon":return So(t,n);default:throw new Error("feature2 "+i+" geometry not supported")}case"Polygon":switch(i){case"Polygon":case"MultiPolygon":return qo(t,n);default:throw new Error("feature2 "+i+" geometry not supported")}default:throw new Error("feature1 "+a+" geometry not supported")}}function Lo(r,e){var t,n=!1;for(t=0;t<e.coordinates.length;t++)if(wa(e.coordinates[t],r.coordinates)){n=!0;break}return n}function xo(r,e){for(var t=0;t<r.coordinates.length;t++){for(var n=!1,a=0;a<e.coordinates.length;a++)wa(r.coordinates[t],e.coordinates[a])&&(n=!0);if(!n)return!1}return!0}function Co(r,e){for(var t=!1,n=0;n<r.coordinates.length;n++){if(!Hr(r.coordinates[n],e))return!1;t||(t=Hr(r.coordinates[n],e,{ignoreEndVertices:!0}))}return t}function Ao(r,e){for(var t=!0,n=!1,a=0;a<r.coordinates.length;a++){if(n=wr(r.coordinates[1],e),!n){t=!1;break}n=wr(r.coordinates[1],e,{ignoreBoundary:!0})}return t&&n}function Oo(r,e){for(var t=0;t<r.coordinates.length;t++)if(!Hr(r.coordinates[t],e))return!1;return!0}function So(r,e){var t=Pr(e),n=Pr(r);if(!ga(t,n))return!1;for(var a=!1,i=0;i<r.coordinates.length-1;i++){if(!wr(r.coordinates[i],e))return!1;if(a||(a=wr(r.coordinates[i],e,{ignoreBoundary:!0})),!a){var o=Bo(r.coordinates[i],r.coordinates[i+1]);a=wr(o,e,{ignoreBoundary:!0})}}return a}function qo(r,e){var t=Pr(r),n=Pr(e);if(!ga(n,t))return!1;for(var a=0;a<r.coordinates[0].length;a++)if(!wr(r.coordinates[0][a],e))return!1;return!0}function ga(r,e){return!(r[0]>e[0]||r[2]<e[2]||r[1]>e[1]||r[3]<e[3])}function wa(r,e){return r[0]===e[0]&&r[1]===e[1]}function Bo(r,e){return[(r[0]+e[0])/2,(r[1]+e[1])/2]}function ma(r,e,t){t===void 0&&(t={}),t.mask&&!t.units&&(t.units="kilometers");for(var n=[],a=r[0],i=r[1],o=r[2],f=r[3],s=e/dr([a,i],[o,i],t),u=s*(o-a),h=e/dr([a,i],[a,f],t),v=h*(f-i),c=o-a,d=f-i,E=Math.floor(c/u),g=Math.floor(d/v),P=(c-E*u)/2,m=(d-g*v)/2,l=a+P;l<=o;){for(var w=i+m;w<=f;){var L=T([l,w],t.properties);t.mask?ya(L,t.mask)&&n.push(L):n.push(L),w+=v}l+=u}return N(n)}function Ea(r,e){e===void 0&&(e={});var t=e.precision,n=e.coordinates,a=e.mutate;if(t=t==null||isNaN(t)?6:t,n=n==null||isNaN(n)?3:n,!r)throw new Error("<geojson> is required");if(typeof t!="number")throw new Error("<precision> must be a number");if(typeof n!="number")throw new Error("<coordinates> must be a number");(a===!1||a===void 0)&&(r=JSON.parse(JSON.stringify(r)));var i=Math.pow(10,t);return Mr(r,function(o){ko(o,i,n)}),r}function ko(r,e,t){r.length>t&&r.splice(t,r.length);for(var n=0;n<r.length;n++)r[n]=Math.round(r[n]*e)/e;return r}function ht(r){if(!r)throw new Error("geojson is required");var e=[];return Nr(r,function(t){e.push(t)}),N(e)}function Fo(r,e,t){if(t=t||{},!pr(t))throw new Error("options is invalid");var n=t.units,a=t.reverse;if(!r)throw new Error("geojson is required");if(e<=0)throw new Error("segmentLength must be greater than 0");var i=[];return Nr(r,function(o){a&&(o.geometry.coordinates=o.geometry.coordinates.reverse()),No(o,e,n,function(f){i.push(f)})}),N(i)}function No(r,e,t,n){var a=ft(r,{units:t});if(a<=e)return n(r);var i=a/e;Number.isInteger(i)||(i=Math.floor(i)+1);for(var o=0;o<i;o++){var f=la(r,e*o,e*(o+1),{units:t});n(f,o)}}function Io(r,e,t){if(r.geometry.type!=="Polygon")throw new Error("The input feature must be a Polygon");t===void 0&&(t=1);var n=r.geometry.coordinates,a=[],i={};if(t){for(var o=[],f=0;f<n.length;f++)for(var s=0;s<n[f].length-1;s++)o.push(P(f,s));var u=lt();u.load(o)}for(var h=0;h<n.length;h++)for(var v=0;v<n[h].length-1;v++)if(t){var c=u.search(P(h,v));c.forEach(function(m){var l=m.ring,w=m.edge;g(h,v,l,w)})}else for(var d=0;d<n.length;d++)for(var E=0;E<n[d].length-1;E++)g(h,v,d,E);return e||(a={type:"Feature",geometry:{type:"MultiPoint",coordinates:a}}),a;function g(m,l,w,L){var M=n[m][l],O=n[m][l+1],x=n[w][L],C=n[w][L+1],y=zo(M,O,x,C);if(y!==null){var Br,Er;if(O[0]!==M[0]?Br=(y[0]-M[0])/(O[0]-M[0]):Br=(y[1]-M[1])/(O[1]-M[1]),C[0]!==x[0]?Er=(y[0]-x[0])/(C[0]-x[0]):Er=(y[1]-x[1])/(C[1]-x[1]),!(Br>=1||Br<=0||Er>=1||Er<=0)){var kr=y,Rr=!i[kr];Rr&&(i[kr]=!0),e?a.push(e(y,m,l,M,O,Br,w,L,x,C,Er,Rr)):a.push(y)}}}function P(m,l){var w=n[m][l],L=n[m][l+1],M,O,x,C;return w[0]<L[0]?(M=w[0],O=L[0]):(M=L[0],O=w[0]),w[1]<L[1]?(x=w[1],C=L[1]):(x=L[1],C=w[1]),{minX:M,minY:x,maxX:O,maxY:C,ring:m,edge:l}}}function zo(r,e,t,n){if(Le(r,t)||Le(r,n)||Le(e,t)||Le(n,t))return null;var a=r[0],i=r[1],o=e[0],f=e[1],s=t[0],u=t[1],h=n[0],v=n[1],c=(a-o)*(u-v)-(i-f)*(s-h);if(c===0)return null;var d=((a*f-i*o)*(s-h)-(a-o)*(s*v-u*h))/c,E=((a*f-i*o)*(u-v)-(i-f)*(s*v-u*h))/c;return[d,E]}function Le(r,e){if(!r||!e||r.length!==e.length)return!1;for(var t=0,n=r.length;t<n;t++)if(r[t]instanceof Array&&e[t]instanceof Array){if(!Le(r[t],e[t]))return!1}else if(r[t]!==e[t])return!1;return!0}function To(r){if(r.type!="Feature")throw new Error("The input must a geojson object of type Feature");if(r.geometry===void 0||r.geometry==null)throw new Error("The input must a geojson object with a non-empty geometry");if(r.geometry.type!="Polygon")throw new Error("The input must be a geojson Polygon");for(var e=r.geometry.coordinates.length,t=[],l=0;l<e;l++){var n=r.geometry.coordinates[l];xe(n[0],n[n.length-1])||n.push(n[0]),t.push.apply(t,n.slice(0,n.length-1))}if(!Go(t))throw new Error("The input polygon may not have duplicate vertices (except for the first and last vertex of each ring)");var a=t.length,i=Io(r,function(Lr,Dr,_r,br,je,Me,Fe,Ne,ti,ni,ai,ii){return[Lr,Dr,_r,br,je,Me,Fe,Ne,ti,ni,ai,ii]}),o=i.length;if(o==0){for(var x=[],l=0;l<e;l++)x.push(D([r.geometry.coordinates[l]],{parent:-1,winding:Do(r.geometry.coordinates[l])}));var gr=N(x);return Ur(),Qr(),gr}for(var f=[],s=[],l=0;l<e;l++){f.push([]);for(var u=0;u<r.geometry.coordinates[l].length-1;u++)f[l].push([new hn(r.geometry.coordinates[l][le(u+1,r.geometry.coordinates[l].length-1)],1,[l,u],[l,le(u+1,r.geometry.coordinates[l].length-1)],void 0)]),s.push(new vn(r.geometry.coordinates[l][u],[l,le(u-1,r.geometry.coordinates[l].length-1)],[l,u],void 0,void 0,!1,!0))}for(var l=0;l<o;l++)f[i[l][1]][i[l][2]].push(new hn(i[l][0],i[l][5],[i[l][1],i[l][2]],[i[l][6],i[l][7]],void 0)),i[l][11]&&s.push(new vn(i[l][0],[i[l][1],i[l][2]],[i[l][6],i[l][7]],void 0,void 0,!0,!0));for(var h=s.length,l=0;l<f.length;l++)for(var u=0;u<f[l].length;u++)f[l][u].sort(function(Dr,_r){return Dr.param<_r.param?-1:1});for(var v=[],l=0;l<h;l++)v.push({minX:s[l].coord[0],minY:s[l].coord[1],maxX:s[l].coord[0],maxY:s[l].coord[1],index:l});var c=lt();c.load(v);for(var l=0;l<f.length;l++)for(var u=0;u<f[l].length;u++)for(var d=0;d<f[l][u].length;d++){var E;d==f[l][u].length-1?E=f[l][le(u+1,r.geometry.coordinates[l].length-1)][0].coord:E=f[l][u][d+1].coord;var g=c.search({minX:E[0],minY:E[1],maxX:E[0],maxY:E[1]})[0];f[l][u][d].nxtIsectAlongEdgeIn=g.index}for(var l=0;l<f.length;l++)for(var u=0;u<f[l].length;u++)for(var d=0;d<f[l][u].length;d++){var E=f[l][u][d].coord,g=c.search({minX:E[0],minY:E[1],maxX:E[0],maxY:E[1]})[0],P=g.index;P<a?s[P].nxtIsectAlongRingAndEdge2=f[l][u][d].nxtIsectAlongEdgeIn:xe(s[P].ringAndEdge1,f[l][u][d].ringAndEdgeIn)?s[P].nxtIsectAlongRingAndEdge1=f[l][u][d].nxtIsectAlongEdgeIn:s[P].nxtIsectAlongRingAndEdge2=f[l][u][d].nxtIsectAlongEdgeIn}for(var m=[],l=0,u=0;u<e;u++){for(var w=l,d=0;d<r.geometry.coordinates[u].length-1;d++)s[l].coord[0]<s[w].coord[0]&&(w=l),l++;for(var L=s[w].nxtIsectAlongRingAndEdge2,d=0;d<s.length;d++)if(s[d].nxtIsectAlongRingAndEdge1==w||s[d].nxtIsectAlongRingAndEdge2==w){var M=d;break}var O=Te([s[M].coord,s[w].coord,s[L].coord],!0)?1:-1;m.push({isect:w,parent:-1,winding:O})}m.sort(function(xr,Lr){return s[xr.isect].coord>s[Lr.isect].coord?-1:1});for(var x=[];m.length>0;){var C=m.pop(),y=C.isect,Br=C.parent,Er=C.winding,kr=x.length,Rr=[s[y].coord],$r=y;if(s[y].ringAndEdge1Walkable)var Ir=s[y].ringAndEdge1,hr=s[y].nxtIsectAlongRingAndEdge1;else var Ir=s[y].ringAndEdge2,hr=s[y].nxtIsectAlongRingAndEdge2;for(;!xe(s[y].coord,s[hr].coord);){Rr.push(s[hr].coord);for(var Wr=void 0,l=0;l<m.length;l++)if(m[l].isect==hr){Wr=l;break}if(Wr!=null&&m.splice(Wr,1),xe(Ir,s[hr].ringAndEdge1)){if(Ir=s[hr].ringAndEdge2,s[hr].ringAndEdge2Walkable=!1,s[hr].ringAndEdge1Walkable){var Ar={isect:hr};Te([s[$r].coord,s[hr].coord,s[s[hr].nxtIsectAlongRingAndEdge2].coord],Er==1)?(Ar.parent=Br,Ar.winding=-Er):(Ar.parent=kr,Ar.winding=Er),m.push(Ar)}$r=hr,hr=s[hr].nxtIsectAlongRingAndEdge2}else{if(Ir=s[hr].ringAndEdge1,s[hr].ringAndEdge1Walkable=!1,s[hr].ringAndEdge2Walkable){var Ar={isect:hr};Te([s[$r].coord,s[hr].coord,s[s[hr].nxtIsectAlongRingAndEdge1].coord],Er==1)?(Ar.parent=Br,Ar.winding=-Er):(Ar.parent=kr,Ar.winding=Er),m.push(Ar)}$r=hr,hr=s[hr].nxtIsectAlongRingAndEdge1}}Rr.push(s[hr].coord),x.push(D([Rr],{index:kr,parent:Br,winding:Er,netWinding:void 0}))}var gr=N(x);Ur(),Qr();function Ur(){for(var xr=[],Lr=0;Lr<gr.features.length;Lr++)gr.features[Lr].properties.parent==-1&&xr.push(Lr);if(xr.length>1)for(var Lr=0;Lr<xr.length;Lr++){for(var Dr=-1,_r=1/0,br=0;br<gr.features.length;br++)xr[Lr]!=br&&wr(gr.features[xr[Lr]].geometry.coordinates[0][0],gr.features[br],{ignoreBoundary:!0})&&qt(gr.features[br])<_r&&(Dr=br);gr.features[xr[Lr]].properties.parent=Dr}}function Qr(){for(var xr=0;xr<gr.features.length;xr++)if(gr.features[xr].properties.parent==-1){var Lr=gr.features[xr].properties.winding;gr.features[xr].properties.netWinding=Lr,Yr(xr,Lr)}}function Yr(xr,Lr){for(var Dr=0;Dr<gr.features.length;Dr++)if(gr.features[Dr].properties.parent==xr){var _r=Lr+gr.features[Dr].properties.winding;gr.features[Dr].properties.netWinding=_r,Yr(Dr,_r)}}return gr}var hn=function(r,e,t,n,a){this.coord=r,this.param=e,this.ringAndEdgeIn=t,this.ringAndEdgeOut=n,this.nxtIsectAlongEdgeIn=a},vn=function(r,e,t,n,a,i,o){this.coord=r,this.ringAndEdge1=e,this.ringAndEdge2=t,this.nxtIsectAlongRingAndEdge1=n,this.nxtIsectAlongRingAndEdge2=a,this.ringAndEdge1Walkable=i,this.ringAndEdge2Walkable=o};function Te(r,e){if(typeof e>"u"&&(e=!0),r.length!=3)throw new Error("This function requires an array of three points [x,y]");var t=(r[1][0]-r[0][0])*(r[2][1]-r[0][1])-(r[1][1]-r[0][1])*(r[2][0]-r[0][0]);return t>=0==e}function Do(r){for(var e=0,t=0;t<r.length-1;t++)r[t][0]<r[e][0]&&(e=t);if(Te([r[le(e-1,r.length-1)],r[e],r[le(e+1,r.length-1)]],!0))var n=1;else var n=-1;return n}function xe(r,e){if(!r||!e||r.length!=e.length)return!1;for(var t=0,n=r.length;t<n;t++)if(r[t]instanceof Array&&e[t]instanceof Array){if(!xe(r[t],e[t]))return!1}else if(r[t]!=e[t])return!1;return!0}function le(r,e){return(r%e+e)%e}function Go(r){for(var e={},t=1,n=0,a=r.length;n<a;++n){if(Object.prototype.hasOwnProperty.call(e,r[n])){t=0;break}e[r[n]]=1}return t}function Ro(r){var e=[];return Nr(r,function(t){t.geometry.type==="Polygon"&&vr(To(t),function(n){e.push(D(n.geometry.coordinates,t.properties))})}),N(e)}var cn=Math.PI/180,dn=180/Math.PI,Ae=function(r,e){this.lon=r,this.lat=e,this.x=cn*r,this.y=cn*e};Ae.prototype.view=function(){return String(this.lon).slice(0,4)+","+String(this.lat).slice(0,4)};Ae.prototype.antipode=function(){var r=-1*this.lat,e=this.lon<0?180+this.lon:(180-this.lon)*-1;return new Ae(e,r)};var Ma=function(){this.coords=[],this.length=0};Ma.prototype.move_to=function(r){this.length++,this.coords.push(r)};var Bt=function(r){this.properties=r||{},this.geometries=[]};Bt.prototype.json=function(){if(this.geometries.length<=0)return{geometry:{type:"LineString",coordinates:null},type:"Feature",properties:this.properties};if(this.geometries.length===1)return{geometry:{type:"LineString",coordinates:this.geometries[0].coords},type:"Feature",properties:this.properties};for(var r=[],e=0;e<this.geometries.length;e++)r.push(this.geometries[e].coords);return{geometry:{type:"MultiLineString",coordinates:r},type:"Feature",properties:this.properties}};Bt.prototype.wkt=function(){for(var r="",e="LINESTRING(",t=function(i){e+=i[0]+" "+i[1]+","},n=0;n<this.geometries.length;n++){if(this.geometries[n].coords.length===0)return"LINESTRING(empty)";var a=this.geometries[n].coords;a.forEach(t),r+=e.substring(0,e.length-1)+")"}return r};var kt=function(r,e,t){if(!r||r.x===void 0||r.y===void 0)throw new Error("GreatCircle constructor expects two args: start and end objects with x and y properties");if(!e||e.x===void 0||e.y===void 0)throw new Error("GreatCircle constructor expects two args: start and end objects with x and y properties");this.start=new Ae(r.x,r.y),this.end=new Ae(e.x,e.y),this.properties=t||{};var n=this.start.x-this.end.x,a=this.start.y-this.end.y,i=Math.pow(Math.sin(a/2),2)+Math.cos(this.start.y)*Math.cos(this.end.y)*Math.pow(Math.sin(n/2),2);if(this.g=2*Math.asin(Math.sqrt(i)),this.g===Math.PI)throw new Error("it appears "+r.view()+" and "+e.view()+" are 'antipodal', e.g diametrically opposite, thus there is no single route but rather infinite");if(isNaN(this.g))throw new Error("could not calculate great circle between "+r+" and "+e)};kt.prototype.interpolate=function(r){var e=Math.sin((1-r)*this.g)/Math.sin(this.g),t=Math.sin(r*this.g)/Math.sin(this.g),n=e*Math.cos(this.start.y)*Math.cos(this.start.x)+t*Math.cos(this.end.y)*Math.cos(this.end.x),a=e*Math.cos(this.start.y)*Math.sin(this.start.x)+t*Math.cos(this.end.y)*Math.sin(this.end.x),i=e*Math.sin(this.start.y)+t*Math.sin(this.end.y),o=dn*Math.atan2(i,Math.sqrt(Math.pow(n,2)+Math.pow(a,2))),f=dn*Math.atan2(a,n);return[f,o]};kt.prototype.Arc=function(r,e){var t=[];if(!r||r<=2)t.push([this.start.lon,this.start.lat]),t.push([this.end.lon,this.end.lat]);else for(var n=1/(r-1),a=0;a<r;++a){var i=n*a,o=this.interpolate(i);t.push(o)}for(var f=!1,s=0,u=e&&e.offset?e.offset:10,h=180-u,v=-180+u,c=360-u,d=1;d<t.length;++d){var E=t[d-1][0],g=t[d][0],P=Math.abs(g-E);P>c&&(g>h&&E<v||E>h&&g<v)?f=!0:P>s&&(s=P)}var m=[];if(f&&s<u){var l=[];m.push(l);for(var w=0;w<t.length;++w){var L=parseFloat(t[w][0]);if(w>0&&Math.abs(L-t[w-1][0])>c){var M=parseFloat(t[w-1][0]),O=parseFloat(t[w-1][1]),x=parseFloat(t[w][0]),C=parseFloat(t[w][1]);if(M>-180&&M<v&&x===180&&w+1<t.length&&t[w-1][0]>-180&&t[w-1][0]<v){l.push([-180,t[w][1]]),w++,l.push([t[w][0],t[w][1]]);continue}else if(M>h&&M<180&&x===-180&&w+1<t.length&&t[w-1][0]>h&&t[w-1][0]<180){l.push([180,t[w][1]]),w++,l.push([t[w][0],t[w][1]]);continue}if(M<v&&x>h){var y=M;M=x,x=y;var Br=O;O=C,C=Br}if(M>h&&x<v&&(x+=360),M<=180&&x>=180&&M<x){var Er=(180-M)/(x-M),kr=Er*C+(1-Er)*O;l.push([t[w-1][0]>h?180:-180,kr]),l=[],l.push([t[w-1][0]>h?-180:180,kr]),m.push(l)}else l=[],m.push(l);l.push([L,t[w][1]])}else l.push([t[w][0],t[w][1]])}}else{var Rr=[];m.push(Rr);for(var $r=0;$r<t.length;++$r)Rr.push([t[$r][0],t[$r][1]])}for(var Ir=new Bt(this.properties),hr=0;hr<m.length;++hr){var Wr=new Ma;Ir.geometries.push(Wr);for(var Ar=m[hr],gr=0;gr<Ar.length;++gr)Wr.move_to(Ar[gr])}return Ir};function $o(r,e,t){if(t=t||{},typeof t!="object")throw new Error("options is invalid");var n=t.properties,a=t.npoints,i=t.offset;r=yr(r),e=yr(e),n=n||{},a=a||100,i=i||10;var o=new kt({x:r[0],y:r[1]},{x:e[0],y:e[1]},n),f=o.Arc(a,{offset:i});return f.json()}function Wo(r,e){if(!r)throw new Error("line is required");if(!e)throw new Error("splitter is required");var t=Jr(r),n=Jr(e);if(t!=="LineString")throw new Error("line must be LineString");if(n==="FeatureCollection")throw new Error("splitter cannot be a FeatureCollection");if(n==="GeometryCollection")throw new Error("splitter cannot be a GeometryCollection");var a=Ea(e,{precision:7});switch(n){case"Point":return vt(r,a);case"MultiPoint":return pn(r,a);case"LineString":case"MultiLineString":case"Polygon":case"MultiPolygon":return pn(r,ae(r,a))}}function pn(r,e){var t=[],n=Xe();return Nr(e,function(a){if(t.forEach(function(f,s){f.id=s}),!t.length)t=vt(r,a).features,t.forEach(function(f){f.bbox||(f.bbox=ca(Pr(f)))}),n.load(N(t));else{var i=n.search(a);if(i.features.length){var o=Pa(a,i);t=t.filter(function(f){return f.id!==o.id}),n.remove(o),vr(vt(o,a),function(f){t.push(f),n.insert(f)})}}}),N(t)}function vt(r,e){var t=[],n=z(r)[0],a=z(r)[r.geometry.coordinates.length-1];if(nt(n,yr(e))||nt(a,yr(e)))return N([r]);var i=Xe(),o=de(r);i.load(o);var f=i.search(e);if(!f.features.length)return N([r]);var s=Pa(e,f),u=[n],h=Et(o,function(v,c,d){var E=z(c)[1],g=yr(e);return d===s.id?(v.push(g),t.push(cr(v)),nt(g,E)?[g]:[g,E]):(v.push(E),v)},u);return h.length>1&&t.push(cr(h)),N(t)}function Pa(r,e){if(!e.features.length)throw new Error("lines must contain features");if(e.features.length===1)return e.features[0];var t,n=1/0;return vr(e,function(a){var i=re(a,r),o=i.properties.dist;o<n&&(t=a,n=o)}),t}function nt(r,e){return r[0]===e[0]&&r[1]===e[1]}function La(r,e,t,n,a){a===void 0&&(a={});var i=a.steps||64,o=ln(t),f=ln(n),s=!Array.isArray(r)&&r.type==="Feature"?r.properties:{};if(o===f)return cr(St(r,e,a).geometry.coordinates[0],s);for(var u=o,h=o<f?f:f+360,v=u,c=[],d=0;v<h;)c.push(jr(r,e,v,a).geometry.coordinates),d++,v=u+d*360/i;return v>h&&c.push(jr(r,e,h,a).geometry.coordinates),cr(c,s)}function ln(r){var e=r%360;return e<0&&(e+=360),e}function Oe(r,e){e===void 0&&(e={});var t=mr(r);switch(!e.properties&&r.type==="Feature"&&(e.properties=r.properties),t.type){case"Polygon":return xa(t,e);case"MultiPolygon":return Jo(t,e);default:throw new Error("invalid poly")}}function xa(r,e){e===void 0&&(e={});var t=mr(r),n=t.coordinates,a=e.properties?e.properties:r.type==="Feature"?r.properties:{};return Ca(n,a)}function Jo(r,e){e===void 0&&(e={});var t=mr(r),n=t.coordinates,a=e.properties?e.properties:r.type==="Feature"?r.properties:{},i=[];return n.forEach(function(o){i.push(Ca(o,a))}),N(i)}function Ca(r,e){return r.length>1?ue(r,e):cr(r[0],e)}function yn(r,e){e===void 0&&(e={});var t,n,a,i=e.properties,o=(t=e.autoComplete)!==null&&t!==void 0?t:!0,f=(n=e.orderCoords)!==null&&n!==void 0?n:!0,s=(a=e.mutate)!==null&&a!==void 0?a:!1;switch(s||(r=Tr(r)),r.type){case"FeatureCollection":var u=[];return r.features.forEach(function(h){u.push(z(gn(h,{},o,f)))}),Xr(u,i);default:return gn(r,i,o,f)}}function gn(r,e,t,n){e=e||(r.type==="Feature"?r.properties:{});var a=mr(r),i=a.coordinates,o=a.type;if(!i.length)throw new Error("line must contain coordinates");switch(o){case"LineString":return t&&(i=wn(i)),D([i],e);case"MultiLineString":var f=[],s=0;return i.forEach(function(u){if(t&&(u=wn(u)),n){var h=Ho(Pr(cr(u)));h>s?(f.unshift(u),s=h):f.push(u)}else f.push(u)}),D(f,e);default:throw new Error("geometry type "+o+" is not supported")}}function wn(r){var e=r[0],t=e[0],n=e[1],a=r[r.length-1],i=a[0],o=a[1];return(t!==i||n!==o)&&r.push(e),r}function Ho(r){var e=r[0],t=r[1],n=r[2],a=r[3];return Math.abs(e-n)*Math.abs(t-a)}function Xo(r,e,t){var n=r.length,a=ye(r[0],e),i=[],o,f,s,u,h;for(t||(t=[]),o=1;o<n;o++){for(u=r[o-1],h=r[o],f=s=ye(h,e);;)if(a|f){if(a&f)break;a?(u=ct(u,h,a,e),a=ye(u,e)):(h=ct(u,h,f,e),f=ye(h,e))}else{i.push(u),f!==s?(i.push(h),o<n-1&&(t.push(i),i=[])):o===n-1&&i.push(h);break}a=s}return i.length&&t.push(i),t}function Ko(r,e){var t,n,a,i,o,f,s;for(n=1;n<=8;n*=2){for(t=[],a=r[r.length-1],i=!(ye(a,e)&n),o=0;o<r.length;o++)f=r[o],s=!(ye(f,e)&n),s!==i&&t.push(ct(a,f,n,e)),s&&t.push(f),a=f,i=s;if(r=t,!r.length)break}return t}function ct(r,e,t,n){return t&8?[r[0]+(e[0]-r[0])*(n[3]-r[1])/(e[1]-r[1]),n[3]]:t&4?[r[0]+(e[0]-r[0])*(n[1]-r[1])/(e[1]-r[1]),n[1]]:t&2?[n[2],r[1]+(e[1]-r[1])*(n[2]-r[0])/(e[0]-r[0])]:t&1?[n[0],r[1]+(e[1]-r[1])*(n[0]-r[0])/(e[0]-r[0])]:null}function ye(r,e){var t=0;return r[0]<e[0]?t|=1:r[0]>e[2]&&(t|=2),r[1]<e[1]?t|=4:r[1]>e[3]&&(t|=8),t}function Zo(r,e){var t=mr(r),n=t.type,a=r.type==="Feature"?r.properties:{},i=t.coordinates;switch(n){case"LineString":case"MultiLineString":{var o=[];return n==="LineString"&&(i=[i]),i.forEach(function(f){Xo(f,e,o)}),o.length===1?cr(o[0],a):ue(o,a)}case"Polygon":return D(mn(i,e),a);case"MultiPolygon":return Xr(i.map(function(f){return mn(f,e)}),a);default:throw new Error("geometry "+n+" not supported")}}function mn(r,e){for(var t=[],n=0,a=r;n<a.length;n++){var i=a[n],o=Ko(i,e);o.length>0&&((o[0][0]!==o[o.length-1][0]||o[0][1]!==o[o.length-1][1])&&o.push(o[0]),o.length>=4&&t.push(o))}return t}function Aa(r,e,t){if(t===void 0&&(t={}),t=t||{},!pr(t))throw new Error("options is invalid");var n=t.tolerance||0,a=[],i=Xe(),o=de(r);i.load(o);var f;return Vr(e,function(s){var u=!1;s&&(vr(i.search(s),function(h){if(u===!1){var v=z(s).sort(),c=z(h).sort();Pe(v,c)||(n===0?Hr(v[0],h)&&Hr(v[1],h):re(h,v[0]).properties.dist<=n&&re(h,v[1]).properties.dist<=n)?(u=!0,f?f=at(f,s):f=s):(n===0?Hr(c[0],s)&&Hr(c[1],s):re(s,c[0]).properties.dist<=n&&re(s,c[1]).properties.dist<=n)&&(f?f=at(f,h):f=h)}}),u===!1&&f&&(a.push(f),f=void 0))}),f&&a.push(f),N(a)}function at(r,e){var t=z(e),n=z(r),a=n[0],i=n[n.length-1],o=r.geometry.coordinates;return Pe(t[0],a)?o.unshift(t[1]):Pe(t[0],i)?o.push(t[1]):Pe(t[1],a)?o.unshift(t[0]):Pe(t[1],i)&&o.push(t[0]),r}function Uo(r,e,t,n,a){if(a=a||{},!pr(a))throw new Error("options is invalid");var i=a.properties;if(!r)throw new Error("center is required");if(t==null)throw new Error("bearing1 is required");if(n==null)throw new Error("bearing2 is required");if(!e)throw new Error("radius is required");if(typeof a!="object")throw new Error("options must be an object");if(En(t)===En(n))return St(r,e,a);var o=z(r),f=La(r,e,t,n,a),s=[[o]];return Mr(f,function(u){s[0].push(u)}),s[0].push(o),D(s,i)}function En(r){var e=r%360;return e<0&&(e+=360),e}function pe(r,e,t){t===void 0&&(t={});var n;t.final?n=Mn(yr(e),yr(r)):n=Mn(yr(r),yr(e));var a=n>180?-(360-n):n;return a}function Mn(r,e){var t=Sr(r[1]),n=Sr(e[1]),a=Sr(e[0]-r[0]);a>Math.PI&&(a-=2*Math.PI),a<-Math.PI&&(a+=2*Math.PI);var i=Math.log(Math.tan(n/2+Math.PI/4)/Math.tan(t/2+Math.PI/4)),o=Math.atan2(a,i);return(ie(o)+360)%360}function me(r,e,t,n){n===void 0&&(n={});var a=e<0,i=ve(Math.abs(e),n.units,"meters");a&&(i=-Math.abs(i));var o=yr(r),f=Qo(o,i,t);return f[0]+=f[0]-o[0]>180?-360:o[0]-f[0]>180?360:0,T(f,n.properties)}function Qo(r,e,t,n){n=n===void 0?Or:Number(n);var a=e/n,i=r[0]*Math.PI/180,o=Sr(r[1]),f=Sr(t),s=a*Math.cos(f),u=o+s;Math.abs(u)>Math.PI/2&&(u=u>0?Math.PI-u:-Math.PI-u);var h=Math.log(Math.tan(u/2+Math.PI/4)/Math.tan(o/2+Math.PI/4)),v=Math.abs(h)>1e-11?s/h:Math.cos(o),c=a*Math.sin(f)/v,d=i+c;return[(d*180/Math.PI+540)%360-180,u*180/Math.PI]}function Yo(r,e){var t=z(r),n=z(e),a,i,o,f,s=Pr(e),u=0,h=null;t[0]>s[0]&&t[0]<s[2]&&t[1]>s[1]&&t[1]<s[3]&&(h=We(r,Ue(e)),u=h.properties.featureIndex);var v=Jr(e);switch(v){case"Polygon":a=n[0][u],i=n[0][0],h!==null&&h.geometry.coordinates[1]<t[1]&&(i=n[0][u]),f=Se(n[0][0],n[0][n[0].length-1],t);var c=Pn(n[0],t,f,o,a,i);a=c[0],i=c[1];break;case"MultiPolygon":for(var d=0,E=0,g=0,P=0;P<n[0].length;P++){d=P;for(var m=!1,l=0;l<n[0][P].length;l++){if(E=l,g===u){m=!0;break}g++}if(m)break}a=n[0][d][E],i=n[0][d][E],f=Se(n[0][0][0],n[0][0][n[0][0].length-1],t),n.forEach(function(w){var L=Pn(w[0],t,f,o,a,i);a=L[0],i=L[1]});break}return N([T(a),T(i)])}function Pn(r,e,t,n,a,i){for(var o=0;o<r.length;o++){var f=r[o],s=r[o+1];o===r.length-1&&(s=r[0]),n=Se(f,s,e),t<=0&&n>0?bo(e,f,a)||(a=f):t>0&&n<=0&&(_o(e,f,i)||(i=f)),t=n}return[a,i]}function _o(r,e,t){return Se(r,e,t)>0}function bo(r,e,t){return Se(r,e,t)<0}function Se(r,e,t){return(e[0]-r[0])*(t[1]-r[1])-(t[0]-r[0])*(e[1]-r[1])}function Je(r){for(var e=z(r),t=0,n=1,a,i;n<e.length;)a=i||e[0],i=e[n],t+=(i[0]-a[0])*(i[1]+a[1]),n++;return t>0}function jo(r,e){if(e=e||{},!pr(e))throw new Error("options is invalid");var t=e.reverse||!1,n=e.mutate||!1;if(!r)throw new Error("<geojson> is required");if(typeof t!="boolean")throw new Error("<reverse> must be a boolean");if(typeof n!="boolean")throw new Error("<mutate> must be a boolean");n===!1&&(r=Tr(r));var a=[];switch(r.type){case"GeometryCollection":return Kr(r,function(i){De(i,t)}),r;case"FeatureCollection":return vr(r,function(i){vr(De(i,t),function(o){a.push(o)})}),N(a)}return De(r,t)}function De(r,e){var t=r.type==="Feature"?r.geometry.type:r.type;switch(t){case"GeometryCollection":return Kr(r,function(n){De(n,e)}),r;case"LineString":return Ln(z(r),e),r;case"Polygon":return xn(z(r),e),r;case"MultiLineString":return z(r).forEach(function(n){Ln(n,e)}),r;case"MultiPolygon":return z(r).forEach(function(n){xn(n,e)}),r;case"Point":case"MultiPoint":return r}}function Ln(r,e){Je(r)===e&&r.reverse()}function xn(r,e){Je(r[0])!==e&&r[0].reverse();for(var t=1;t<r.length;t++)Je(r[t])===e&&r[t].reverse()}function Vo(r,e){if(e=e||{},!pr(e))throw new Error("options is invalid");var t=e.zProperty||"elevation",n=e.flip,a=e.flags;ne(r,"Point","input must contain Points");for(var i=ru(r,n),o=[],f=0;f<i.length;f++){for(var s=i[f],u=[],h=0;h<s.length;h++){var v=s[h];v.properties[t]?u.push(v.properties[t]):u.push(0),a===!0&&(v.properties.matrixPosition=[f,h])}o.push(u)}return o}function ru(r,e){var t={};vr(r,function(i){var o=z(i)[1];t[o]||(t[o]=[]),t[o].push(i)});var n=Object.keys(t).map(function(i){var o=t[i],f=o.sort(function(s,u){return z(s)[0]-z(u)[0]});return f}),a=n.sort(function(i,o){return e?z(i[0])[1]-z(o[0])[1]:z(o[0])[1]-z(i[0])[1]});return a}/*!
 * @license GNU Affero General Public License.
 * Copyright (c) 2015, 2015 Ronny Lorenz <ronny@tbi.univie.ac.at>
 * v. 1.2.0
 * https://github.com/RaumZeit/MarchingSquares.js
 *
 * MarchingSquaresJS is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Affero General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * MarchingSquaresJS is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU Affero General Public License for more details.
 *
 * As additional permission under GNU Affero General Public License version 3
 * section 7, third-party projects (personal or commercial) may distribute,
 * include, or link against UNMODIFIED VERSIONS of MarchingSquaresJS without the
 * requirement that said third-party project for that reason alone becomes
 * subject to any requirement of the GNU Affero General Public License version 3.
 * Any modifications to MarchingSquaresJS, however, must be shared with the public
 * and made available.
 *
 * In summary this:
 * - allows you to use MarchingSquaresJS at no cost
 * - allows you to use MarchingSquaresJS for both personal and commercial purposes
 * - allows you to distribute UNMODIFIED VERSIONS of MarchingSquaresJS under any
 *   license as long as this license notice is included
 * - enables you to keep the source code of your program that uses MarchingSquaresJS
 *   undisclosed
 * - forces you to share any modifications you have made to MarchingSquaresJS,
 *   e.g. bug-fixes
 *
 * You should have received a copy of the GNU Affero General Public License
 * along with MarchingSquaresJS.  If not, see <http://www.gnu.org/licenses/>.
 */var Cn={successCallback:null,verbose:!1,polygons:!1},se={};function eu(r,e,t,n){n=n||{};for(var a=Object.keys(Cn),i=0;i<a.length;i++){var o=a[i],f=n[o];f=typeof f<"u"&&f!==null?f:Cn[o],se[o]=f}se.verbose;var s=Iu(r,e,t),u;return se.polygons?(se.verbose,u=$u(s)):(se.verbose,u=zu(s)),typeof se.successCallback=="function"&&se.successCallback(u),u}var Gr=64,Zr=16,Fr=4,zr=1,G=[],R=[],$=[],W=[],J=[],H=[],X=[],K=[],Z=[],U=[],Q=[],Y=[],_=[],b=[],j=[],V=[],rr=[],er=[],tr=[],nr=[],ar=[],ir=[],or=[],ur=[];X[85]=U[85]=-1;K[85]=Q[85]=0;Z[85]=Y[85]=1;tr[85]=ir[85]=1;nr[85]=or[85]=0;ar[85]=ur[85]=1;G[85]=W[85]=0;R[85]=J[85]=-1;$[85]=j[85]=0;V[85]=_[85]=0;rr[85]=b[85]=1;H[85]=er[85]=1;ir[1]=ir[169]=0;or[1]=or[169]=-1;ur[1]=ur[169]=0;_[1]=_[169]=-1;b[1]=b[169]=0;j[1]=j[169]=0;U[4]=U[166]=0;Q[4]=Q[166]=-1;Y[4]=Y[166]=1;V[4]=V[166]=1;rr[4]=rr[166]=0;er[4]=er[166]=0;X[16]=X[154]=0;K[16]=K[154]=1;Z[16]=Z[154]=1;W[16]=W[154]=1;J[16]=J[154]=0;H[16]=H[154]=1;tr[64]=tr[106]=0;nr[64]=nr[106]=1;ar[64]=ar[106]=0;G[64]=G[106]=-1;R[64]=R[106]=0;$[64]=$[106]=1;tr[2]=tr[168]=0;nr[2]=nr[168]=-1;ar[2]=ar[168]=1;ir[2]=ir[168]=0;or[2]=or[168]=-1;ur[2]=ur[168]=0;_[2]=_[168]=-1;b[2]=b[168]=0;j[2]=j[168]=0;V[2]=V[168]=-1;rr[2]=rr[168]=0;er[2]=er[168]=1;X[8]=X[162]=0;K[8]=K[162]=-1;Z[8]=Z[162]=0;U[8]=U[162]=0;Q[8]=Q[162]=-1;Y[8]=Y[162]=1;_[8]=_[162]=1;b[8]=b[162]=0;j[8]=j[162]=1;V[8]=V[162]=1;rr[8]=rr[162]=0;er[8]=er[162]=0;X[32]=X[138]=0;K[32]=K[138]=1;Z[32]=Z[138]=1;U[32]=U[138]=0;Q[32]=Q[138]=1;Y[32]=Y[138]=0;G[32]=G[138]=1;R[32]=R[138]=0;$[32]=$[138]=0;W[32]=W[138]=1;J[32]=J[138]=0;H[32]=H[138]=1;ir[128]=ir[42]=0;or[128]=or[42]=1;ur[128]=ur[42]=1;tr[128]=tr[42]=0;nr[128]=nr[42]=1;ar[128]=ar[42]=0;G[128]=G[42]=-1;R[128]=R[42]=0;$[128]=$[42]=1;W[128]=W[42]=-1;J[128]=J[42]=0;H[128]=H[42]=0;U[5]=U[165]=-1;Q[5]=Q[165]=0;Y[5]=Y[165]=0;ir[5]=ir[165]=1;or[5]=or[165]=0;ur[5]=ur[165]=0;V[20]=V[150]=0;rr[20]=rr[150]=1;er[20]=er[150]=1;W[20]=W[150]=0;J[20]=J[150]=-1;H[20]=H[150]=1;X[80]=X[90]=-1;K[80]=K[90]=0;Z[80]=Z[90]=1;tr[80]=tr[90]=1;nr[80]=nr[90]=0;ar[80]=ar[90]=1;_[65]=_[105]=0;b[65]=b[105]=1;j[65]=j[105]=0;G[65]=G[105]=0;R[65]=R[105]=-1;$[65]=$[105]=0;X[160]=X[10]=-1;K[160]=K[10]=0;Z[160]=Z[10]=1;U[160]=U[10]=-1;Q[160]=Q[10]=0;Y[160]=Y[10]=0;ir[160]=ir[10]=1;or[160]=or[10]=0;ur[160]=ur[10]=0;tr[160]=tr[10]=1;nr[160]=nr[10]=0;ar[160]=ar[10]=1;V[130]=V[40]=0;rr[130]=rr[40]=1;er[130]=er[40]=1;_[130]=_[40]=0;b[130]=b[40]=1;j[130]=j[40]=0;G[130]=G[40]=0;R[130]=R[40]=-1;$[130]=$[40]=0;W[130]=W[40]=0;J[130]=J[40]=-1;H[130]=H[40]=1;U[37]=U[133]=0;Q[37]=Q[133]=1;Y[37]=Y[133]=1;ir[37]=ir[133]=0;or[37]=or[133]=1;ur[37]=ur[133]=0;G[37]=G[133]=-1;R[37]=R[133]=0;$[37]=$[133]=0;W[37]=W[133]=1;J[37]=J[133]=0;H[37]=H[133]=0;V[148]=V[22]=-1;rr[148]=rr[22]=0;er[148]=er[22]=0;ir[148]=ir[22]=0;or[148]=or[22]=-1;ur[148]=ur[22]=1;tr[148]=tr[22]=0;nr[148]=nr[22]=1;ar[148]=ar[22]=1;W[148]=W[22]=-1;J[148]=J[22]=0;H[148]=H[22]=1;X[82]=X[88]=0;K[82]=K[88]=-1;Z[82]=Z[88]=1;V[82]=V[88]=1;rr[82]=rr[88]=0;er[82]=er[88]=1;_[82]=_[88]=-1;b[82]=b[88]=0;j[82]=j[88]=1;tr[82]=tr[88]=0;nr[82]=nr[88]=-1;ar[82]=ar[88]=0;X[73]=X[97]=0;K[73]=K[97]=1;Z[73]=Z[97]=0;U[73]=U[97]=0;Q[73]=Q[97]=-1;Y[73]=Y[97]=0;_[73]=_[97]=1;b[73]=b[97]=0;j[73]=j[97]=0;G[73]=G[97]=1;R[73]=R[97]=0;$[73]=$[97]=1;X[145]=X[25]=0;K[145]=K[25]=-1;Z[145]=Z[25]=0;_[145]=_[25]=1;b[145]=b[25]=0;j[145]=j[25]=1;ir[145]=ir[25]=0;or[145]=or[25]=1;ur[145]=ur[25]=1;W[145]=W[25]=-1;J[145]=J[25]=0;H[145]=H[25]=0;U[70]=U[100]=0;Q[70]=Q[100]=1;Y[70]=Y[100]=0;V[70]=V[100]=-1;rr[70]=rr[100]=0;er[70]=er[100]=1;tr[70]=tr[100]=0;nr[70]=nr[100]=-1;ar[70]=ar[100]=1;G[70]=G[100]=1;R[70]=R[100]=0;$[70]=$[100]=0;U[101]=U[69]=0;Q[101]=Q[69]=1;Y[101]=Y[69]=0;G[101]=G[69]=1;R[101]=R[69]=0;$[101]=$[69]=0;ir[149]=ir[21]=0;or[149]=or[21]=1;ur[149]=ur[21]=1;W[149]=W[21]=-1;J[149]=J[21]=0;H[149]=H[21]=0;V[86]=V[84]=-1;rr[86]=rr[84]=0;er[86]=er[84]=1;tr[86]=tr[84]=0;nr[86]=nr[84]=-1;ar[86]=ar[84]=1;X[89]=X[81]=0;K[89]=K[81]=-1;Z[89]=Z[81]=0;_[89]=_[81]=1;b[89]=b[81]=0;j[89]=j[81]=1;X[96]=X[74]=0;K[96]=K[74]=1;Z[96]=Z[74]=0;U[96]=U[74]=-1;Q[96]=Q[74]=0;Y[96]=Y[74]=1;tr[96]=tr[74]=1;nr[96]=nr[74]=0;ar[96]=ar[74]=0;G[96]=G[74]=1;R[96]=R[74]=0;$[96]=$[74]=1;X[24]=X[146]=0;K[24]=K[146]=-1;Z[24]=Z[146]=1;V[24]=V[146]=1;rr[24]=rr[146]=0;er[24]=er[146]=1;_[24]=_[146]=0;b[24]=b[146]=1;j[24]=j[146]=1;W[24]=W[146]=0;J[24]=J[146]=-1;H[24]=H[146]=0;U[6]=U[164]=-1;Q[6]=Q[164]=0;Y[6]=Y[164]=1;V[6]=V[164]=-1;rr[6]=rr[164]=0;er[6]=er[164]=0;ir[6]=ir[164]=0;or[6]=or[164]=-1;ur[6]=ur[164]=1;tr[6]=tr[164]=1;nr[6]=nr[164]=0;ar[6]=ar[164]=0;_[129]=_[41]=0;b[129]=b[41]=1;j[129]=j[41]=1;ir[129]=ir[41]=0;or[129]=or[41]=1;ur[129]=ur[41]=0;G[129]=G[41]=-1;R[129]=R[41]=0;$[129]=$[41]=0;W[129]=W[41]=0;J[129]=J[41]=-1;H[129]=H[41]=0;V[66]=V[104]=0;rr[66]=rr[104]=1;er[66]=er[104]=0;_[66]=_[104]=-1;b[66]=b[104]=0;j[66]=j[104]=1;tr[66]=tr[104]=0;nr[66]=nr[104]=-1;ar[66]=ar[104]=0;G[66]=G[104]=0;R[66]=R[104]=-1;$[66]=$[104]=1;X[144]=X[26]=-1;K[144]=K[26]=0;Z[144]=Z[26]=0;ir[144]=ir[26]=1;or[144]=or[26]=0;ur[144]=ur[26]=1;tr[144]=tr[26]=0;nr[144]=nr[26]=1;ar[144]=ar[26]=1;W[144]=W[26]=-1;J[144]=J[26]=0;H[144]=H[26]=1;U[36]=U[134]=0;Q[36]=Q[134]=1;Y[36]=Y[134]=1;V[36]=V[134]=0;rr[36]=rr[134]=1;er[36]=er[134]=0;G[36]=G[134]=0;R[36]=R[134]=-1;$[36]=$[134]=1;W[36]=W[134]=1;J[36]=J[134]=0;H[36]=H[134]=0;X[9]=X[161]=-1;K[9]=K[161]=0;Z[9]=Z[161]=0;U[9]=U[161]=0;Q[9]=Q[161]=-1;Y[9]=Y[161]=0;_[9]=_[161]=1;b[9]=b[161]=0;j[9]=j[161]=0;ir[9]=ir[161]=1;or[9]=or[161]=0;ur[9]=ur[161]=1;X[136]=0;K[136]=1;Z[136]=1;U[136]=0;Q[136]=1;Y[136]=0;V[136]=-1;rr[136]=0;er[136]=1;_[136]=-1;b[136]=0;j[136]=0;ir[136]=0;or[136]=-1;ur[136]=0;tr[136]=0;nr[136]=-1;ar[136]=1;G[136]=1;R[136]=0;$[136]=0;W[136]=1;J[136]=0;H[136]=1;X[34]=0;K[34]=-1;Z[34]=0;U[34]=0;Q[34]=-1;Y[34]=1;V[34]=1;rr[34]=0;er[34]=0;_[34]=1;b[34]=0;j[34]=1;ir[34]=0;or[34]=1;ur[34]=1;tr[34]=0;nr[34]=1;ar[34]=0;G[34]=-1;R[34]=0;$[34]=1;W[34]=-1;J[34]=0;H[34]=0;X[35]=0;K[35]=1;Z[35]=1;U[35]=0;Q[35]=-1;Y[35]=1;V[35]=1;rr[35]=0;er[35]=0;_[35]=-1;b[35]=0;j[35]=0;ir[35]=0;or[35]=-1;ur[35]=0;tr[35]=0;nr[35]=1;ar[35]=0;G[35]=-1;R[35]=0;$[35]=1;W[35]=1;J[35]=0;H[35]=1;X[153]=0;K[153]=1;Z[153]=1;_[153]=-1;b[153]=0;j[153]=0;ir[153]=0;or[153]=-1;ur[153]=0;W[153]=1;J[153]=0;H[153]=1;U[102]=0;Q[102]=-1;Y[102]=1;V[102]=1;rr[102]=0;er[102]=0;tr[102]=0;nr[102]=1;ar[102]=0;G[102]=-1;R[102]=0;$[102]=1;X[155]=0;K[155]=-1;Z[155]=0;_[155]=1;b[155]=0;j[155]=1;ir[155]=0;or[155]=1;ur[155]=1;W[155]=-1;J[155]=0;H[155]=0;U[103]=0;Q[103]=1;Y[103]=0;V[103]=-1;rr[103]=0;er[103]=1;tr[103]=0;nr[103]=-1;ar[103]=1;G[103]=1;R[103]=0;$[103]=0;X[152]=0;K[152]=1;Z[152]=1;V[152]=-1;rr[152]=0;er[152]=1;_[152]=-1;b[152]=0;j[152]=0;ir[152]=0;or[152]=-1;ur[152]=0;tr[152]=0;nr[152]=-1;ar[152]=1;W[152]=1;J[152]=0;H[152]=1;X[156]=0;K[156]=-1;Z[156]=1;V[156]=1;rr[156]=0;er[156]=1;_[156]=-1;b[156]=0;j[156]=0;ir[156]=0;or[156]=-1;ur[156]=0;tr[156]=0;nr[156]=1;ar[156]=1;W[156]=-1;J[156]=0;H[156]=1;X[137]=0;K[137]=1;Z[137]=1;U[137]=0;Q[137]=1;Y[137]=0;_[137]=-1;b[137]=0;j[137]=0;ir[137]=0;or[137]=-1;ur[137]=0;G[137]=1;R[137]=0;$[137]=0;W[137]=1;J[137]=0;H[137]=1;X[139]=0;K[139]=1;Z[139]=1;U[139]=0;Q[139]=-1;Y[139]=0;_[139]=1;b[139]=0;j[139]=0;ir[139]=0;or[139]=1;ur[139]=0;G[139]=-1;R[139]=0;$[139]=0;W[139]=1;J[139]=0;H[139]=1;X[98]=0;K[98]=-1;Z[98]=0;U[98]=0;Q[98]=-1;Y[98]=1;V[98]=1;rr[98]=0;er[98]=0;_[98]=1;b[98]=0;j[98]=1;tr[98]=0;nr[98]=1;ar[98]=0;G[98]=-1;R[98]=0;$[98]=1;X[99]=0;K[99]=1;Z[99]=0;U[99]=0;Q[99]=-1;Y[99]=1;V[99]=1;rr[99]=0;er[99]=0;_[99]=-1;b[99]=0;j[99]=1;tr[99]=0;nr[99]=-1;ar[99]=0;G[99]=1;R[99]=0;$[99]=1;U[38]=0;Q[38]=-1;Y[38]=1;V[38]=1;rr[38]=0;er[38]=0;ir[38]=0;or[38]=1;ur[38]=1;tr[38]=0;nr[38]=1;ar[38]=0;G[38]=-1;R[38]=0;$[38]=1;W[38]=-1;J[38]=0;H[38]=0;U[39]=0;Q[39]=1;Y[39]=1;V[39]=-1;rr[39]=0;er[39]=0;ir[39]=0;or[39]=-1;ur[39]=1;tr[39]=0;nr[39]=1;ar[39]=0;G[39]=-1;R[39]=0;$[39]=1;W[39]=1;J[39]=0;H[39]=0;var Ft=function(r){return[[r.bottomleft,0],[0,0],[0,r.leftbottom]]},Nt=function(r){return[[1,r.rightbottom],[1,0],[r.bottomright,0]]},It=function(r){return[[r.topright,1],[1,1],[1,r.righttop]]},zt=function(r){return[[0,r.lefttop],[0,1],[r.topleft,1]]},Tt=function(r){return[[r.bottomright,0],[r.bottomleft,0],[0,r.leftbottom],[0,r.lefttop]]},Dt=function(r){return[[r.bottomright,0],[r.bottomleft,0],[1,r.righttop],[1,r.rightbottom]]},Gt=function(r){return[[1,r.righttop],[1,r.rightbottom],[r.topleft,1],[r.topright,1]]},Rt=function(r){return[[0,r.leftbottom],[0,r.lefttop],[r.topleft,1],[r.topright,1]]},tu=function(r){return[[0,0],[0,r.leftbottom],[1,r.rightbottom],[1,0]]},nu=function(r){return[[1,0],[r.bottomright,0],[r.topright,1],[1,1]]},au=function(r){return[[1,1],[1,r.righttop],[0,r.lefttop],[0,1]]},iu=function(r){return[[r.bottomleft,0],[0,0],[0,1],[r.topleft,1]]},ou=function(r){return[[1,r.righttop],[1,r.rightbottom],[0,r.leftbottom],[0,r.lefttop]]},uu=function(r){return[[r.topleft,1],[r.topright,1],[r.bottomright,0],[r.bottomleft,0]]},su=function(){return[[0,0],[0,1],[1,1],[1,0]]},fu=function(r){return[[1,r.rightbottom],[1,0],[0,0],[0,1],[r.topleft,1]]},hu=function(r){return[[r.topright,1],[1,1],[1,0],[0,0],[0,r.leftbottom]]},vu=function(r){return[[1,0],[r.bottomright,0],[0,r.lefttop],[0,1],[1,1]]},cu=function(r){return[[1,1],[1,r.righttop],[r.bottomleft,0],[0,0],[0,1]]},du=function(r){return[[1,r.righttop],[1,r.rightbottom],[0,r.lefttop],[0,1],[r.topleft,1]]},pu=function(r){return[[1,1],[1,r.righttop],[r.bottomright,0],[r.bottomleft,0],[r.topright,1]]},lu=function(r){return[[1,r.rightbottom],[1,0],[r.bottomright,0],[0,r.leftbottom],[0,r.lefttop]]},yu=function(r){return[[r.topright,1],[r.bottomleft,0],[0,0],[0,r.leftbottom],[r.topleft,1]]},gu=function(r){return[[r.bottomright,0],[r.bottomleft,0],[0,r.lefttop],[0,1],[r.topleft,1]]},wu=function(r){return[[1,1],[1,r.righttop],[0,r.leftbottom],[0,r.lefttop],[r.topright,1]]},mu=function(r){return[[1,r.rightbottom],[1,0],[r.bottomright,0],[r.topleft,1],[r.topright,1]]},Eu=function(r){return[[1,r.righttop],[1,r.rightbottom],[r.bottomleft,0],[0,0],[0,r.leftbottom]]},Mu=function(r){return[[1,r.rightbottom],[1,0],[0,0],[0,r.leftbottom],[r.topleft,1],[r.topright,1]]},Pu=function(r){return[[1,1],[1,0],[r.bottomright,0],[0,r.leftbottom],[0,r.lefttop],[r.topright,1]]},Lu=function(r){return[[1,1],[1,r.righttop],[r.bottomright,0],[r.bottomleft,0],[0,r.lefttop],[0,1]]},xu=function(r){return[[1,r.righttop],[1,r.rightbottom],[r.bottomleft,0],[0,0],[0,1],[r.topleft,1]]},Cu=function(r){return[[1,1],[1,r.righttop],[r.bottomleft,0],[0,0],[0,r.leftbottom],[r.topright,1]]},Au=function(r){return[[1,r.rightbottom],[1,0],[r.bottomright,0],[0,r.lefttop],[0,1],[r.topleft,1]]},Ou=function(r){return[[1,r.righttop],[1,r.rightbottom],[r.bottomright,0],[r.bottomleft,0],[0,r.leftbottom],[0,r.lefttop],[r.topleft,1],[r.topright,1]]},Su=function(r){return[[1,1],[1,r.righttop],[r.bottomleft,0],[0,0],[0,r.leftbottom],[r.topright,1]]},qu=function(r){return[[1,r.rightbottom],[1,0],[r.bottomright,0],[0,r.lefttop],[0,1],[r.topleft,1]]},Bu=function(r){return[[1,1],[1,r.righttop],[r.bottomright,0],[r.bottomleft,0],[0,r.leftbottom],[0,r.lefttop],[r.topright,1]]},ku=function(r){return[[1,r.righttop],[1,r.rightbottom],[r.bottomleft,0],[0,0],[0,r.leftbottom],[r.topleft,1],[r.topright,1]]},Fu=function(r){return[[1,r.righttop],[1,r.rightbottom],[r.bottomright,0],[r.bottomleft,0],[0,r.lefttop],[0,1],[r.topleft,1]]},Nu=function(r){return[[1,r.rightbottom],[1,0],[r.bottomright,0],[0,r.leftbottom],[0,r.lefttop],[r.topleft,1],[r.topright,1]]},q=[],S=[],k=[],B=[],I=[],F=[],sr=[],fr=[];B[1]=I[1]=18;B[169]=I[169]=18;k[4]=S[4]=12;k[166]=S[166]=12;q[16]=fr[16]=4;q[154]=fr[154]=4;F[64]=sr[64]=22;F[106]=sr[106]=22;k[2]=F[2]=17;B[2]=I[2]=18;k[168]=F[168]=17;B[168]=I[168]=18;q[8]=B[8]=9;S[8]=k[8]=12;q[162]=B[162]=9;S[162]=k[162]=12;q[32]=fr[32]=4;S[32]=sr[32]=1;q[138]=fr[138]=4;S[138]=sr[138]=1;I[128]=fr[128]=21;F[128]=sr[128]=22;I[42]=fr[42]=21;F[42]=sr[42]=22;S[5]=I[5]=14;S[165]=I[165]=14;k[20]=fr[20]=6;k[150]=fr[150]=6;q[80]=F[80]=11;q[90]=F[90]=11;B[65]=sr[65]=3;B[105]=sr[105]=3;q[160]=F[160]=11;S[160]=I[160]=14;q[10]=F[10]=11;S[10]=I[10]=14;k[130]=fr[130]=6;B[130]=sr[130]=3;k[40]=fr[40]=6;B[40]=sr[40]=3;S[101]=sr[101]=1;S[69]=sr[69]=1;I[149]=fr[149]=21;I[21]=fr[21]=21;k[86]=F[86]=17;k[84]=F[84]=17;q[89]=B[89]=9;q[81]=B[81]=9;q[96]=sr[96]=0;S[96]=F[96]=15;q[74]=sr[74]=0;S[74]=F[74]=15;q[24]=k[24]=8;B[24]=fr[24]=7;q[146]=k[146]=8;B[146]=fr[146]=7;S[6]=F[6]=15;k[6]=I[6]=16;S[164]=F[164]=15;k[164]=I[164]=16;B[129]=fr[129]=7;I[129]=sr[129]=20;B[41]=fr[41]=7;I[41]=sr[41]=20;k[66]=sr[66]=2;B[66]=F[66]=19;k[104]=sr[104]=2;B[104]=F[104]=19;q[144]=I[144]=10;F[144]=fr[144]=23;q[26]=I[26]=10;F[26]=fr[26]=23;S[36]=fr[36]=5;k[36]=sr[36]=2;S[134]=fr[134]=5;k[134]=sr[134]=2;q[9]=I[9]=10;S[9]=B[9]=13;q[161]=I[161]=10;S[161]=B[161]=13;S[37]=fr[37]=5;I[37]=sr[37]=20;S[133]=fr[133]=5;I[133]=sr[133]=20;k[148]=I[148]=16;F[148]=fr[148]=23;k[22]=I[22]=16;F[22]=fr[22]=23;q[82]=k[82]=8;B[82]=F[82]=19;q[88]=k[88]=8;B[88]=F[88]=19;q[73]=sr[73]=0;S[73]=B[73]=13;q[97]=sr[97]=0;S[97]=B[97]=13;q[145]=B[145]=9;I[145]=fr[145]=21;q[25]=B[25]=9;I[25]=fr[25]=21;S[70]=sr[70]=1;k[70]=F[70]=17;S[100]=sr[100]=1;k[100]=F[100]=17;q[34]=B[34]=9;S[34]=k[34]=12;I[34]=fr[34]=21;F[34]=sr[34]=22;q[136]=fr[136]=4;S[136]=sr[136]=1;k[136]=F[136]=17;B[136]=I[136]=18;q[35]=fr[35]=4;S[35]=k[35]=12;B[35]=I[35]=18;F[35]=sr[35]=22;q[153]=fr[153]=4;B[153]=I[153]=18;S[102]=k[102]=12;F[102]=sr[102]=22;q[155]=B[155]=9;I[155]=fr[155]=23;S[103]=sr[103]=1;k[103]=F[103]=17;q[152]=fr[152]=4;k[152]=F[152]=17;B[152]=I[152]=18;q[156]=k[156]=8;B[156]=I[156]=18;F[156]=fr[156]=23;q[137]=fr[137]=4;S[137]=sr[137]=1;B[137]=I[137]=18;q[139]=fr[139]=4;S[139]=B[139]=13;I[139]=sr[139]=20;q[98]=B[98]=9;S[98]=k[98]=12;F[98]=sr[98]=22;q[99]=sr[99]=0;S[99]=k[99]=12;B[99]=F[99]=19;S[38]=k[38]=12;I[38]=fr[38]=21;F[38]=sr[38]=22;S[39]=fr[39]=5;k[39]=I[39]=16;F[39]=sr[39]=22;var A=[];A[1]=A[169]=Ft;A[4]=A[166]=Nt;A[16]=A[154]=It;A[64]=A[106]=zt;A[168]=A[2]=Tt;A[162]=A[8]=Dt;A[138]=A[32]=Gt;A[42]=A[128]=Rt;A[5]=A[165]=tu;A[20]=A[150]=nu;A[80]=A[90]=au;A[65]=A[105]=iu;A[160]=A[10]=ou;A[130]=A[40]=uu;A[85]=su;A[101]=A[69]=fu;A[149]=A[21]=hu;A[86]=A[84]=vu;A[89]=A[81]=cu;A[96]=A[74]=du;A[24]=A[146]=pu;A[6]=A[164]=lu;A[129]=A[41]=yu;A[66]=A[104]=gu;A[144]=A[26]=wu;A[36]=A[134]=mu;A[9]=A[161]=Eu;A[37]=A[133]=Mu;A[148]=A[22]=Pu;A[82]=A[88]=Lu;A[73]=A[97]=xu;A[145]=A[25]=Cu;A[70]=A[100]=Au;A[34]=function(r){return[Rt(r),Dt(r)]};A[35]=Ou;A[136]=function(r){return[Gt(r),Tt(r)]};A[153]=function(r){return[It(r),Ft(r)]};A[102]=function(r){return[Nt(r),zt(r)]};A[155]=Su;A[103]=qu;A[152]=function(r){return[It(r),Tt(r)]};A[156]=Bu;A[137]=function(r){return[Gt(r),Ft(r)]};A[139]=ku;A[98]=function(r){return[Dt(r),zt(r)]};A[99]=Fu;A[38]=function(r){return[Nt(r),Rt(r)]};A[39]=Nu;function p(r,e,t){return(r-e)/(t-e)}function it(r){return r.constructor.toString().indexOf("Array")>-1}function Iu(r,e,t){for(var n=r.length-1,a=r[0].length-1,i={rows:n,cols:a,cells:[]},o=e+Math.abs(t),f=0;f<n;++f){i.cells[f]=[];for(var s=0;s<a;++s){var u=0,h=r[f+1][s],v=r[f+1][s+1],c=r[f][s+1],d=r[f][s];if(!(isNaN(h)||isNaN(v)||isNaN(c)||isNaN(d))){u|=h<e?0:h>o?128:64,u|=v<e?0:v>o?32:16,u|=c<e?0:c>o?8:4,u|=d<e?0:d>o?2:1;var E=+u,g=0;if(u===17||u===18||u===33||u===34||u===38||u===68||u===72||u===98||u===102||u===132||u===136||u===137||u===152||u===153){var P=(h+v+c+d)/4;g=P>o?2:P<e?0:1,u===34?g===1?u=35:g===0&&(u=136):u===136?g===1?(u=35,g=4):g===0&&(u=34):u===17?g===1?(u=155,g=4):g===0&&(u=153):u===68?g===1?(u=103,g=4):g===0&&(u=102):u===153?g===1&&(u=155):u===102?g===1&&(u=103):u===152?g<2&&(u=156,g=1):u===137?g<2&&(u=139,g=1):u===98?g<2&&(u=99,g=1):u===38?g<2&&(u=39,g=1):u===18?g>0?(u=156,g=4):u=152:u===33?g>0?(u=139,g=4):u=137:u===72?g>0?(u=99,g=4):u=98:u===132&&(g>0?(u=39,g=4):u=38)}if(u!=0&&u!=170){var m,l,w,L,M,O,x,C;m=l=w=L=M=O=x=C=.5;var y=[];u===1?(w=1-p(e,c,d),C=1-p(e,h,d),y.push(B[u])):u===169?(w=p(o,d,c),C=p(o,d,h),y.push(B[u])):u===4?(O=1-p(e,v,c),L=p(e,d,c),y.push(S[u])):u===166?(O=p(o,c,v),L=1-p(o,c,d),y.push(S[u])):u===16?(M=p(e,c,v),l=p(e,h,v),y.push(q[u])):u===154?(M=1-p(o,v,c),l=1-p(o,v,h),y.push(q[u])):u===64?(x=p(e,d,h),m=1-p(e,v,h),y.push(F[u])):u===106?(x=1-p(o,h,d),m=p(o,h,v),y.push(F[u])):u===168?(L=p(o,d,c),w=p(e,d,c),C=p(e,d,h),x=p(o,d,h),y.push(k[u]),y.push(B[u])):u===2?(L=1-p(e,c,d),w=1-p(o,c,d),C=1-p(o,h,d),x=1-p(e,h,d),y.push(k[u]),y.push(B[u])):u===162?(M=p(o,c,v),O=p(e,c,v),L=1-p(e,c,d),w=1-p(o,c,d),y.push(k[u]),y.push(B[u])):u===8?(M=1-p(e,v,c),O=1-p(o,v,c),L=p(o,d,c),w=p(e,d,c),y.push(q[u]),y.push(S[u])):u===138?(M=1-p(e,v,c),O=1-p(o,v,c),m=1-p(o,v,h),l=1-p(e,v,h),y.push(q[u]),y.push(S[u])):u===32?(M=p(o,c,v),O=p(e,c,v),m=p(e,h,v),l=p(o,h,v),y.push(q[u]),y.push(S[u])):u===42?(C=1-p(o,h,d),x=1-p(e,h,d),m=p(e,h,v),l=p(o,h,v),y.push(I[u]),y.push(F[u])):u===128&&(C=p(e,d,h),x=p(o,d,h),m=1-p(o,v,h),l=1-p(e,v,h),y.push(I[u]),y.push(F[u])),u===5?(O=1-p(e,v,c),C=1-p(e,h,d),y.push(S[u])):u===165?(O=p(o,c,v),C=p(o,d,h),y.push(S[u])):u===20?(L=p(e,d,c),l=p(e,h,v),y.push(k[u])):u===150?(L=1-p(o,c,d),l=1-p(o,v,h),y.push(k[u])):u===80?(M=p(e,c,v),x=p(e,d,h),y.push(q[u])):u===90?(M=1-p(o,v,c),x=1-p(o,h,d),y.push(q[u])):u===65?(w=1-p(e,c,d),m=1-p(e,v,h),y.push(B[u])):u===105?(w=p(o,d,c),m=p(o,h,v),y.push(B[u])):u===160?(M=p(o,c,v),O=p(e,c,v),C=p(e,d,h),x=p(o,d,h),y.push(q[u]),y.push(S[u])):u===10?(M=1-p(e,v,c),O=1-p(o,v,c),C=1-p(o,h,d),x=1-p(e,h,d),y.push(q[u]),y.push(S[u])):u===130?(L=1-p(e,c,d),w=1-p(o,c,d),m=1-p(o,v,h),l=1-p(e,v,h),y.push(k[u]),y.push(B[u])):u===40?(L=p(o,d,c),w=p(e,d,c),m=p(e,h,v),l=p(o,h,v),y.push(k[u]),y.push(B[u])):u===101?(O=p(o,c,v),m=p(o,h,v),y.push(S[u])):u===69?(O=1-p(e,v,c),m=1-p(e,v,h),y.push(S[u])):u===149?(C=p(o,d,h),l=1-p(o,v,h),y.push(I[u])):u===21?(C=1-p(e,h,d),l=p(e,h,v),y.push(I[u])):u===86?(L=1-p(o,c,d),x=1-p(o,h,d),y.push(k[u])):u===84?(L=p(e,d,c),x=p(e,d,h),y.push(k[u])):u===89?(M=1-p(o,v,c),w=p(o,d,c),y.push(B[u])):u===81?(M=p(e,c,v),w=1-p(e,c,d),y.push(B[u])):u===96?(M=p(o,c,v),O=p(e,c,v),x=p(e,d,h),m=p(o,h,v),y.push(q[u]),y.push(S[u])):u===74?(M=1-p(e,v,c),O=1-p(o,v,c),x=1-p(o,h,d),m=1-p(e,v,h),y.push(q[u]),y.push(S[u])):u===24?(M=1-p(o,v,c),L=p(o,d,c),w=p(e,d,c),l=p(e,h,v),y.push(q[u]),y.push(B[u])):u===146?(M=p(e,c,v),L=1-p(e,c,d),w=1-p(o,c,d),l=1-p(o,v,h),y.push(q[u]),y.push(B[u])):u===6?(O=1-p(e,v,c),L=1-p(o,c,d),C=1-p(o,h,d),x=1-p(e,h,d),y.push(S[u]),y.push(k[u])):u===164?(O=p(o,c,v),L=p(e,d,c),C=p(e,d,h),x=p(o,d,h),y.push(S[u]),y.push(k[u])):u===129?(w=1-p(e,c,d),C=p(o,d,h),m=1-p(o,v,h),l=1-p(e,v,h),y.push(B[u]),y.push(I[u])):u===41?(w=p(o,d,c),C=1-p(e,h,d),m=p(e,h,v),l=p(o,h,v),y.push(B[u]),y.push(I[u])):u===66?(L=1-p(e,c,d),w=1-p(o,c,d),x=1-p(o,h,d),m=1-p(e,v,h),y.push(k[u]),y.push(B[u])):u===104?(L=p(o,d,c),w=p(e,d,c),x=p(e,d,h),m=p(o,h,v),y.push(B[u]),y.push(sr[u])):u===144?(M=p(e,c,v),C=p(e,d,h),x=p(o,d,h),l=1-p(o,v,h),y.push(q[u]),y.push(F[u])):u===26?(M=1-p(o,v,c),C=1-p(o,h,d),x=1-p(e,h,d),l=p(e,h,v),y.push(q[u]),y.push(F[u])):u===36?(O=p(o,c,v),L=p(e,d,c),m=p(e,h,v),l=p(o,h,v),y.push(S[u]),y.push(k[u])):u===134?(O=1-p(e,v,c),L=1-p(o,c,d),m=1-p(o,v,h),l=1-p(e,v,h),y.push(S[u]),y.push(k[u])):u===9?(M=1-p(e,v,c),O=1-p(o,v,c),w=p(o,d,c),C=1-p(e,h,d),y.push(q[u]),y.push(S[u])):u===161?(M=p(o,c,v),O=p(e,c,v),w=1-p(e,c,d),C=p(o,d,h),y.push(q[u]),y.push(S[u])):u===37?(O=p(o,c,v),C=1-p(e,h,d),m=p(e,h,v),l=p(o,h,v),y.push(S[u]),y.push(I[u])):u===133?(O=1-p(e,v,c),C=p(o,d,h),m=1-p(o,v,h),l=1-p(e,v,h),y.push(S[u]),y.push(I[u])):u===148?(L=p(e,d,c),C=p(e,d,h),x=p(o,d,h),l=1-p(o,v,h),y.push(k[u]),y.push(F[u])):u===22?(L=1-p(o,c,d),C=1-p(o,h,d),x=1-p(e,h,d),l=p(e,h,v),y.push(k[u]),y.push(F[u])):u===82?(M=p(e,c,v),L=1-p(e,c,d),w=1-p(o,c,d),x=1-p(o,h,d),y.push(q[u]),y.push(B[u])):u===88?(M=1-p(o,v,c),L=p(o,d,c),w=p(e,d,c),x=p(e,d,h),y.push(q[u]),y.push(B[u])):u===73?(M=1-p(e,v,c),O=1-p(o,v,c),w=p(o,d,c),m=1-p(e,v,h),y.push(q[u]),y.push(S[u])):u===97?(M=p(o,c,v),O=p(e,c,v),w=1-p(e,c,d),m=p(o,h,v),y.push(q[u]),y.push(S[u])):u===145?(M=p(e,c,v),w=1-p(e,c,d),C=p(o,d,h),l=1-p(o,v,h),y.push(q[u]),y.push(I[u])):u===25?(M=1-p(o,v,c),w=p(o,d,c),C=1-p(e,h,d),l=p(e,h,v),y.push(q[u]),y.push(I[u])):u===70?(O=1-p(e,v,c),L=1-p(o,c,d),x=1-p(o,h,d),m=1-p(e,v,h),y.push(S[u]),y.push(k[u])):u===100?(O=p(o,c,v),L=p(e,d,c),x=p(e,d,h),m=p(o,h,v),y.push(S[u]),y.push(k[u])):u===34?(g===0?(M=1-p(e,v,c),O=1-p(o,v,c),L=p(o,d,c),w=p(e,d,c),C=p(e,d,h),x=p(o,d,h),m=1-p(o,v,h),l=1-p(e,v,h)):(M=p(o,c,v),O=p(e,c,v),L=1-p(e,c,d),w=1-p(o,c,d),C=1-p(o,h,d),x=1-p(e,h,d),m=p(e,h,v),l=p(o,h,v)),y.push(q[u]),y.push(S[u]),y.push(I[u]),y.push(F[u])):u===35?(g===4?(M=1-p(e,v,c),O=1-p(o,v,c),L=p(o,d,c),w=p(e,d,c),C=p(e,d,h),x=p(o,d,h),m=1-p(o,v,h),l=1-p(e,v,h)):(M=p(o,c,v),O=p(e,c,v),L=1-p(e,c,d),w=1-p(o,c,d),C=1-p(o,h,d),x=1-p(e,h,d),m=p(e,h,v),l=p(o,h,v)),y.push(q[u]),y.push(S[u]),y.push(B[u]),y.push(F[u])):u===136?(g===0?(M=p(o,c,v),O=p(e,c,v),L=1-p(e,c,d),w=1-p(o,c,d),C=1-p(o,h,d),x=1-p(e,h,d),m=p(e,h,v),l=p(o,h,v)):(M=1-p(e,v,c),O=1-p(o,v,c),L=p(o,d,c),w=p(e,d,c),C=p(e,d,h),x=p(o,d,h),m=1-p(o,v,h),l=1-p(e,v,h)),y.push(q[u]),y.push(S[u]),y.push(I[u]),y.push(F[u])):u===153?(g===0?(M=p(e,c,v),w=1-p(e,c,d),C=1-p(e,h,d),l=p(e,h,v)):(M=1-p(o,v,c),w=p(o,d,c),C=p(o,d,h),l=1-p(o,v,h)),y.push(q[u]),y.push(B[u])):u===102?(g===0?(O=1-p(e,v,c),L=p(e,d,c),x=p(e,d,h),m=1-p(e,v,h)):(O=p(o,c,v),L=1-p(o,c,d),x=1-p(o,h,d),m=p(o,h,v)),y.push(S[u]),y.push(F[u])):u===155?(g===4?(M=p(e,c,v),w=1-p(e,c,d),C=1-p(e,h,d),l=p(e,h,v)):(M=1-p(o,v,c),w=p(o,d,c),C=p(o,d,h),l=1-p(o,v,h)),y.push(q[u]),y.push(I[u])):u===103?(g===4?(O=1-p(e,v,c),L=p(e,d,c),x=p(e,d,h),m=1-p(e,v,h)):(O=p(o,c,v),L=1-p(o,c,d),x=1-p(o,h,d),m=p(o,h,v)),y.push(S[u]),y.push(k[u])):u===152?(g===0?(M=p(e,c,v),L=1-p(e,c,d),w=1-p(o,c,d),C=1-p(o,h,d),x=1-p(e,h,d),l=p(e,h,v)):(M=1-p(o,v,c),L=p(o,d,c),w=p(e,d,c),C=p(e,d,h),x=p(o,d,h),l=1-p(o,v,h)),y.push(q[u]),y.push(k[u]),y.push(B[u])):u===156?(g===4?(M=p(e,c,v),L=1-p(e,c,d),w=1-p(o,c,d),C=1-p(o,h,d),x=1-p(e,h,d),l=p(e,h,v)):(M=1-p(o,v,c),L=p(o,d,c),w=p(e,d,c),C=p(e,d,h),x=p(o,d,h),l=1-p(o,v,h)),y.push(q[u]),y.push(B[u]),y.push(F[u])):u===137?(g===0?(M=p(o,c,v),O=p(e,c,v),w=1-p(e,c,d),C=1-p(e,h,d),m=p(e,h,v),l=p(o,h,v)):(M=1-p(e,v,c),O=1-p(o,v,c),w=p(o,d,c),C=p(o,d,h),m=1-p(o,v,h),l=1-p(e,v,h)),y.push(q[u]),y.push(S[u]),y.push(B[u])):u===139?(g===4?(M=p(o,c,v),O=p(e,c,v),w=1-p(e,c,d),C=1-p(e,h,d),m=p(e,h,v),l=p(o,h,v)):(M=1-p(e,v,c),O=1-p(o,v,c),w=p(o,d,c),C=p(o,d,h),m=1-p(o,v,h),l=1-p(e,v,h)),y.push(q[u]),y.push(S[u]),y.push(I[u])):u===98?(g===0?(M=1-p(e,v,c),O=1-p(o,v,c),L=p(o,d,c),w=p(e,d,c),x=p(e,d,h),m=1-p(e,v,h)):(M=p(o,c,v),O=p(e,c,v),L=1-p(e,c,d),w=1-p(o,c,d),x=1-p(o,h,d),m=p(o,h,v)),y.push(q[u]),y.push(S[u]),y.push(F[u])):u===99?(g===4?(M=1-p(e,v,c),O=1-p(o,v,c),L=p(o,d,c),w=p(e,d,c),x=p(e,d,h),m=1-p(e,v,h)):(M=p(o,c,v),O=p(e,c,v),L=1-p(e,c,d),w=1-p(o,c,d),x=1-p(o,h,d),m=p(o,h,v)),y.push(q[u]),y.push(S[u]),y.push(B[u])):u===38?(g===0?(O=1-p(e,v,c),L=p(e,d,c),C=p(e,d,h),x=p(o,d,h),m=1-p(o,v,h),l=1-p(e,v,h)):(O=p(o,c,v),L=1-p(o,c,d),C=1-p(o,h,d),x=1-p(e,h,d),m=p(e,h,v),l=p(o,h,v)),y.push(S[u]),y.push(I[u]),y.push(F[u])):u===39?(g===4?(O=1-p(e,v,c),L=p(e,d,c),C=p(e,d,h),x=p(o,d,h),m=1-p(o,v,h),l=1-p(e,v,h)):(O=p(o,c,v),L=1-p(o,c,d),C=1-p(o,h,d),x=1-p(e,h,d),m=p(e,h,v),l=p(o,h,v)),y.push(S[u]),y.push(k[u]),y.push(F[u])):u===85&&(M=1,O=0,L=1,w=0,C=0,x=1,m=0,l=1),m<0||m>1||l<0||l>1||M<0||M>1||L<0||L>1||C<0||C>1||x<0||x>1,i.cells[f][s]={cval:u,cval_real:E,flipped:g,topleft:m,topright:l,righttop:M,rightbottom:O,bottomright:L,bottomleft:w,leftbottom:C,lefttop:x,edges:y}}}}}return i}function zu(r){for(var e=[],t=r.rows,n=r.cols,a=[],i=0;i<t;i++)for(var o=0;o<n;o++)if(typeof r.cells[i][o]<"u"&&r.cells[i][o].edges.length>0){var f=r.cells[i][o],s=Gu(f),u=null,h=o,v=i;s!==null&&a.push([s.p[0]+h,s.p[1]+v]);do{if(u=Ru(r.cells[v][h],s.x,s.y,s.o),u!==null)a.push([u.p[0]+h,u.p[1]+v]),h+=u.x,v+=u.y,s=u;else break;if(v<0||v>=t||h<0||h>=n||typeof r.cells[v][h]>"u"){h-=u.x,v-=u.y;var c=Tu(r,h,v,u.x,u.y,u.o);if(c!==null)c.path.forEach(function(d){a.push(d)}),h=c.i,v=c.j,s=c;else break}}while(typeof r.cells[v][h]<"u"&&r.cells[v][h].edges.length>0);e.push(a),a=[],r.cells[i][o].edges.length>0&&o--}return e}function Tu(r,e,t,n,a,i){for(var o=r.cells[t][e],f=o.cval_real,s=e+n,u=t+a,h=[],v=!1;!v;){if(typeof r.cells[u]>"u"||typeof r.cells[u][s]>"u")if(u-=a,s-=n,o=r.cells[u][s],f=o.cval_real,a===-1)if(i===0)if(f&zr)h.push([s,u]),n=-1,a=0,i=0;else if(f&Fr)h.push([s+1,u]),n=1,a=0,i=0;else{h.push([s+o.bottomright,u]),n=0,a=1,i=1,v=!0;break}else if(f&zr)h.push([s,u]),n=-1,a=0,i=0;else if(f&Fr){h.push([s+o.bottomright,u]),n=0,a=1,i=1,v=!0;break}else{h.push([s+o.bottomleft,u]),n=0,a=1,i=0,v=!0;break}else if(a===1)if(i===0)if(f&Zr)h.push([s+1,u+1]),n=1,a=0,i=1;else if(f&Gr){h.push([s+o.topleft,u+1]),n=0,a=-1,i=0,v=!0;break}else{h.push([s+o.topright,u+1]),n=0,a=-1,i=1,v=!0;break}else f&Zr?(h.push([s+1,u+1]),n=1,a=0,i=1):(h.push([s+1,u+1]),n=1,a=0,i=1);else if(n===-1)if(i===0)if(f&Gr)h.push([s,u+1]),n=0,a=1,i=0;else if(f&zr){h.push([s,u+o.leftbottom]),n=1,a=0,i=0,v=!0;break}else{h.push([s,u+o.lefttop]),n=1,a=0,i=1,v=!0;break}else if(f&Gr)h.push([s,u+1]),n=0,a=1,i=0;else break;else if(n===1)if(i===0)if(f&Fr)h.push([s+1,u]),n=0,a=-1,i=1;else{h.push([s+1,u+o.rightbottom]),n=-1,a=0,i=0,v=!0;break}else if(f&Fr)h.push([s+1,u]),n=0,a=-1,i=1;else if(f&Zr){h.push([s+1,u+o.righttop]),n=-1,a=0,i=1;break}else{h.push([s+1,u+o.rightbottom]),n=-1,a=0,i=0,v=!0;break}else break;else if(o=r.cells[u][s],f=o.cval_real,n===-1){if(i===0)if(typeof r.cells[u-1]<"u"&&typeof r.cells[u-1][s]<"u")n=0,a=-1,i=1;else if(f&zr)h.push([s,u]);else{h.push([s+o.bottomright,u]),n=0,a=1,i=1,v=!0;break}else if(!(f&Gr))break}else if(n===1){if(i===0)break;if(typeof r.cells[u+1]<"u"&&typeof r.cells[u+1][s]<"u")n=0,a=1,i=0;else if(f&Zr)h.push([s+1,u+1]),n=1,a=0,i=1;else{h.push([s+o.topleft,u+1]),n=0,a=-1,i=0,v=!0;break}}else if(a===-1)if(i===1)if(typeof r.cells[u][s+1]<"u")n=1,a=0,i=1;else if(f&Fr)h.push([s+1,u]),n=0,a=-1,i=1;else{h.push([s+1,u+o.righttop]),n=-1,a=0,i=1,v=!0;break}else break;else if(a===1)if(i===0)if(typeof r.cells[u][s-1]<"u")n=-1,a=0,i=0;else if(f&Gr)h.push([s,u+1]),n=0,a=1,i=0;else{h.push([s,u+o.leftbottom]),n=1,a=0,i=0,v=!0;break}else break;else break;if(s+=n,u+=a,s===e&&u===t)break}return{path:h,i:s,j:u,x:n,y:a,o:i}}function Du(r,e){delete r.edges[e];for(var t=e+1;t<r.edges.length;t++)r.edges[t-1]=r.edges[t];r.edges.pop()}function Gu(r){if(r.edges.length>0){var e=r.edges[r.edges.length-1],t=r.cval_real;switch(e){case 0:return t&Zr?{p:[1,r.righttop],x:-1,y:0,o:1}:{p:[r.topleft,1],x:0,y:-1,o:0};case 1:return t&Fr?{p:[r.topleft,1],x:0,y:-1,o:0}:{p:[1,r.rightbottom],x:-1,y:0,o:0};case 2:return t&Fr?{p:[r.bottomright,0],x:0,y:1,o:1}:{p:[r.topleft,1],x:0,y:-1,o:0};case 3:return t&zr?{p:[r.topleft,1],x:0,y:-1,o:0}:{p:[r.bottomleft,0],x:0,y:1,o:0};case 4:return t&Zr?{p:[1,r.righttop],x:-1,y:0,o:1}:{p:[r.topright,1],x:0,y:-1,o:1};case 5:return t&Fr?{p:[r.topright,1],x:0,y:-1,o:1}:{p:[1,r.rightbottom],x:-1,y:0,o:0};case 6:return t&Fr?{p:[r.bottomright,0],x:0,y:1,o:1}:{p:[r.topright,1],x:0,y:-1,o:1};case 7:return t&zr?{p:[r.topright,1],x:0,y:-1,o:1}:{p:[r.bottomleft,0],x:0,y:1,o:0};case 8:return t&Fr?{p:[r.bottomright,0],x:0,y:1,o:1}:{p:[1,r.righttop],x:-1,y:0,o:1};case 9:return t&zr?{p:[1,r.righttop],x:-1,y:0,o:1}:{p:[r.bottomleft,0],x:0,y:1,o:0};case 10:return t&zr?{p:[0,r.leftbottom],x:1,y:0,o:0}:{p:[1,r.righttop],x:-1,y:0,o:1};case 11:return t&Gr?{p:[1,r.righttop],x:-1,y:0,o:1}:{p:[0,r.lefttop],x:1,y:0,o:1};case 12:return t&Fr?{p:[r.bottomright,0],x:0,y:1,o:1}:{p:[1,r.rightbottom],x:-1,y:0,o:0};case 13:return t&zr?{p:[1,r.rightbottom],x:-1,y:0,o:0}:{p:[r.bottomleft,0],x:0,y:1,o:0};case 14:return t&zr?{p:[0,r.leftbottom],x:1,y:0,o:0}:{p:[1,r.rightbottom],x:-1,y:0,o:0};case 15:return t&Gr?{p:[1,r.rightbottom],x:-1,y:0,o:0}:{p:[0,r.lefttop],x:1,y:0,o:1};case 16:return t&Fr?{p:[r.bottomright,0],x:0,y:1,o:1}:{p:[0,r.leftbottom],x:1,y:0,o:0};case 17:return t&Gr?{p:[r.bottomright,0],x:0,y:1,o:1}:{p:[0,r.lefttop],x:1,y:0,o:1};case 18:return t&zr?{p:[0,r.leftbottom],x:1,y:0,o:0}:{p:[r.bottomleft,0],x:0,y:1,o:0};case 19:return t&Gr?{p:[r.bottomleft,0],x:0,y:1,o:0}:{p:[0,r.lefttop],x:1,y:0,o:1};case 20:return t&Gr?{p:[r.topleft,1],x:0,y:-1,o:0}:{p:[0,r.leftbottom],x:1,y:0,o:0};case 21:return t&Zr?{p:[0,r.leftbottom],x:1,y:0,o:0}:{p:[r.topright,1],x:0,y:-1,o:1};case 22:return t&Gr?{p:[r.topleft,1],x:0,y:-1,o:0}:{p:[0,r.lefttop],x:1,y:0,o:1};case 23:return t&Zr?{p:[0,r.lefttop],x:1,y:0,o:1}:{p:[r.topright,1],x:0,y:-1,o:1};default:break}}return null}function Ru(r,e,t,n){var a,i,o,f,s=r.cval,u;switch(e){case-1:switch(n){case 0:a=S[s],o=U[s],f=Q[s],u=Y[s];break;default:a=q[s],o=X[s],f=K[s],u=Z[s];break}break;case 1:switch(n){case 0:a=I[s],o=ir[s],f=or[s],u=ur[s];break;default:a=F[s],o=tr[s],f=nr[s],u=ar[s];break}break;default:switch(t){case-1:switch(n){case 0:a=sr[s],o=G[s],f=R[s],u=$[s];break;default:a=fr[s],o=W[s],f=J[s],u=H[s];break}break;case 1:switch(n){case 0:a=B[s],o=_[s],f=b[s],u=j[s];break;default:a=k[s],o=V[s],f=rr[s],u=er[s];break}break}break}if(i=r.edges.indexOf(a),typeof r.edges[i]<"u")Du(r,i);else return null;switch(s=r.cval_real,a){case 0:s&Zr?(e=r.topleft,t=1):(e=1,t=r.righttop);break;case 1:s&Fr?(e=1,t=r.rightbottom):(e=r.topleft,t=1);break;case 2:s&Fr?(e=r.topleft,t=1):(e=r.bottomright,t=0);break;case 3:s&zr?(e=r.bottomleft,t=0):(e=r.topleft,t=1);break;case 4:s&Zr?(e=r.topright,t=1):(e=1,t=r.righttop);break;case 5:s&Fr?(e=1,t=r.rightbottom):(e=r.topright,t=1);break;case 6:s&Fr?(e=r.topright,t=1):(e=r.bottomright,t=0);break;case 7:s&zr?(e=r.bottomleft,t=0):(e=r.topright,t=1);break;case 8:s&Fr?(e=1,t=r.righttop):(e=r.bottomright,t=0);break;case 9:s&zr?(e=r.bottomleft,t=0):(e=1,t=r.righttop);break;case 10:s&zr?(e=1,t=r.righttop):(e=0,t=r.leftbottom);break;case 11:s&Gr?(e=0,t=r.lefttop):(e=1,t=r.righttop);break;case 12:s&Fr?(e=1,t=r.rightbottom):(e=r.bottomright,t=0);break;case 13:s&zr?(e=r.bottomleft,t=0):(e=1,t=r.rightbottom);break;case 14:s&zr?(e=1,t=r.rightbottom):(e=0,t=r.leftbottom);break;case 15:s&Gr?(e=0,t=r.lefttop):(e=1,t=r.rightbottom);break;case 16:s&Fr?(e=0,t=r.leftbottom):(e=r.bottomright,t=0);break;case 17:s&Gr?(e=0,t=r.lefttop):(e=r.bottomright,t=0);break;case 18:s&zr?(e=r.bottomleft,t=0):(e=0,t=r.leftbottom);break;case 19:s&Gr?(e=0,t=r.lefttop):(e=r.bottomleft,t=0);break;case 20:s&Gr?(e=0,t=r.leftbottom):(e=r.topleft,t=1);break;case 21:s&Zr?(e=r.topright,t=1):(e=0,t=r.leftbottom);break;case 22:s&Gr?(e=0,t=r.lefttop):(e=r.topleft,t=1);break;case 23:s&Zr?(e=r.topright,t=1):(e=0,t=r.lefttop);break;default:return null}return{p:[e,t],x:o,y:f,o:u}}function $u(r){var e=[],t=0;return r.cells.forEach(function(n,a){n.forEach(function(i,o){if(typeof i<"u"){var f=A[i.cval](i);typeof f=="object"&&it(f)&&typeof f[0]=="object"&&it(f[0])&&(typeof f[0][0]=="object"&&it(f[0][0])?f.forEach(function(s){s.forEach(function(u){u[0]+=o,u[1]+=a}),e[t++]=s}):(f.forEach(function(s){s[0]+=o,s[1]+=a}),e[t++]=f))}})}),e}function Wu(r,e,t){if(t=t||{},!pr(t))throw new Error("options is invalid");var n=t.zProperty||"elevation",a=t.commonProperties||{},i=t.breaksProperties||[];if(ne(r,"Point","Input must contain Points"),!e)throw new Error("breaks is required");if(!Array.isArray(e))throw new Error("breaks is not an Array");if(!pr(a))throw new Error("commonProperties is not an Object");if(!Array.isArray(i))throw new Error("breaksProperties is not an Array");var o=Vo(r,{zProperty:n,flip:!0}),f=Ju(o,e,n);f=Hu(f,o,r);var s=f.map(function(u,h){if(i[h]&&!pr(i[h]))throw new Error("Each mappedProperty is required to be an Object");var v=pt({},a,i[h]);v[n]=u[n];var c=Xr(u.groupedRings,v);return c});return N(s)}function Ju(r,e,t){for(var n=[],a=1;a<e.length;a++){var i=+e[a-1],o=+e[a],f=eu(r,i,o-i),s=Xu(f),u=Ku(s),h={};h.groupedRings=u,h[t]=i+"-"+o,n.push(h)}return n}function Hu(r,e,t){var n=Pr(t),a=n[2]-n[0],i=n[3]-n[1],o=n[0],f=n[1],s=e[0].length-1,u=e.length-1,h=a/s,v=i/u,c=function(d){d[0]=d[0]*h+o,d[1]=d[1]*v+f};return r.forEach(function(d){d.groupedRings.forEach(function(E){E.forEach(function(g){g.forEach(c)})})}),r}function Xu(r){var e=[],t=[];r.forEach(function(a){var i=qt(D([a]));t.push(i),e.push({ring:a,area:i})}),t.sort(function(a,i){return i-a});var n=[];return t.forEach(function(a){for(var i=0;i<e.length;i++)if(e[i].area===a){n.push(e[i].ring),e.splice(i,1);break}}),n}function Ku(r){for(var e=r.map(function(s){return{lrCoordinates:s,grouped:!1}}),t=[];!Uu(e);)for(var n=0;n<e.length;n++)if(!e[n].grouped){var a=[];a.push(e[n].lrCoordinates),e[n].grouped=!0;for(var i=D([e[n].lrCoordinates]),o=n+1;o<e.length;o++)if(!e[o].grouped){var f=D([e[o].lrCoordinates]);Zu(f,i)&&(a.push(e[o].lrCoordinates),e[o].grouped=!0)}t.push(a)}return t}function Zu(r,e){for(var t=Ue(r),n=0;n<t.features.length;n++)if(!wr(t.features[n],e))return!1;return!0}function Uu(r){for(var e=0;e<r.length;e++)if(r[e].grouped===!1)return!1;return!0}function Oa(r,e,t){if(t=t||{},!pr(t))throw new Error("options is invalid");var n=t.pivot,a=t.mutate;if(!r)throw new Error("geojson is required");if(e==null||isNaN(e))throw new Error("angle is required");return e===0||(n||(n=oe(r)),(a===!1||a===void 0)&&(r=Tr(r)),Mr(r,function(i){var o=pe(n,i),f=o+e,s=Qe(n,i),u=z(me(n,s,f));i[0]=u[0],i[1]=u[1]})),r}function Sa(r,e,t){if(t=t||{},!pr(t))throw new Error("options is invalid");var n=t.origin,a=t.mutate;if(!r)throw new Error("geojson required");if(typeof e!="number"||e===0)throw new Error("invalid factor");var i=Array.isArray(n)||typeof n=="object";return a!==!0&&(r=Tr(r)),r.type==="FeatureCollection"&&!i?(vr(r,function(o,f){r.features[f]=An(o,e,n)}),r):An(r,e,n)}function An(r,e,t){var n=Jr(r)==="Point";return t=Qu(r,t),e===1||n||Mr(r,function(a){var i=Qe(t,a),o=pe(t,a),f=i*e,s=z(me(t,f,o));a[0]=s[0],a[1]=s[1],a.length===3&&(a[2]*=e)}),r}function Qu(r,e){if(e==null&&(e="centroid"),Array.isArray(e)||typeof e=="object")return yr(e);var t=r.bbox?r.bbox:Pr(r),n=t[0],a=t[1],i=t[2],o=t[3];switch(e){case"sw":case"southwest":case"westsouth":case"bottomleft":return T([n,a]);case"se":case"southeast":case"eastsouth":case"bottomright":return T([i,a]);case"nw":case"northwest":case"westnorth":case"topleft":return T([n,o]);case"ne":case"northeast":case"eastnorth":case"topright":return T([i,o]);case"center":return Ze(r);case void 0:case null:case"centroid":return oe(r);default:throw new Error("invalid origin")}}function Yu(r,e,t,n){if(n=n||{},!pr(n))throw new Error("options is invalid");var a=n.units,i=n.zTranslation,o=n.mutate;if(!r)throw new Error("geojson is required");if(e==null||isNaN(e))throw new Error("distance is required");if(i&&typeof i!="number"&&isNaN(i))throw new Error("zTranslation is not a number");if(i=i!==void 0?i:0,e===0&&i===0)return r;if(t==null||isNaN(t))throw new Error("direction is required");return e<0&&(e=-e,t=t+180),(o===!1||o===void 0)&&(r=Tr(r)),Mr(r,function(f){var s=z(me(f,e,t,{units:a}));f[0]=s[0],f[1]=s[1],i&&f.length===3&&(f[2]+=i)}),r}function He(r){var e=r[0],t=r[1];return[t[0]-e[0],t[1]-e[1]]}function dt(r,e){return r[0]*e[1]-e[0]*r[1]}function _u(r,e){return[r[0]+e[0],r[1]+e[1]]}function bu(r,e){return[r[0]-e[0],r[1]-e[1]]}function ju(r,e){return[r*e[0],r*e[1]]}function Vu(r,e){var t=r[0],n=He(r),a=e[0],i=He(e),o=dt(n,i),f=bu(a,t),s=dt(f,i),u=s/o,h=_u(t,ju(u,n));return h}function rs(r,e){var t=He(r),n=He(e);return dt(t,n)===0}function es(r,e){return rs(r,e)?!1:Vu(r,e)}function ts(r,e,t){if(t=t||{},!pr(t))throw new Error("options is invalid");var n=t.units;if(!r)throw new Error("geojson is required");if(e==null||isNaN(e))throw new Error("distance is required");var a=Jr(r),i=r.properties;switch(a){case"LineString":return On(r,e,n);case"MultiLineString":var o=[];return Nr(r,function(f){o.push(On(f,e,n).geometry.coordinates)}),ue(o,i);default:throw new Error("geometry "+a+" is not supported")}}function On(r,e,t){var n=[],a=$e(e,t),i=z(r),o=[];return i.forEach(function(f,s){if(s!==i.length-1){var u=ns(f,i[s+1],a);if(n.push(u),s>0){var h=n[s-1],v=es(u,h);v!==!1&&(h[1]=v,u[0]=v),o.push(h[0]),s===i.length-2&&(o.push(u[0]),o.push(u[1]))}i.length===2&&(o.push(u[0]),o.push(u[1]))}}),cr(o,r.properties)}function ns(r,e,t){var n=Math.sqrt((r[0]-e[0])*(r[0]-e[0])+(r[1]-e[1])*(r[1]-e[1])),a=r[0]+t*(e[1]-r[1])/n,i=e[0]+t*(e[1]-r[1])/n,o=r[1]+t*(r[0]-e[0])/n,f=e[1]+t*(r[0]-e[0])/n;return[[a,o],[i,f]]}function as(r){return(r>0)-(r<0)||+r}function $t(r,e,t){var n=e[0]-r[0],a=e[1]-r[1],i=t[0]-e[0],o=t[1]-e[1];return as(n*o-i*a)}function is(r,e){var t=r.geometry.coordinates[0].map(function(o){return o[0]}),n=r.geometry.coordinates[0].map(function(o){return o[1]}),a=e.geometry.coordinates[0].map(function(o){return o[0]}),i=e.geometry.coordinates[0].map(function(o){return o[1]});return Math.max.apply(null,t)===Math.max.apply(null,a)&&Math.max.apply(null,n)===Math.max.apply(null,i)&&Math.min.apply(null,t)===Math.min.apply(null,a)&&Math.min.apply(null,n)===Math.min.apply(null,i)}function Sn(r,e){return e.geometry.coordinates[0].every(function(t){return wr(T(t),r)})}function os(r,e){return r[0]===e[0]&&r[1]===e[1]}var qn=function(){function r(e){this.id=r.buildId(e),this.coordinates=e,this.innerEdges=[],this.outerEdges=[],this.outerEdgesSorted=!1}return r.buildId=function(e){return e.join(",")},r.prototype.removeInnerEdge=function(e){this.innerEdges=this.innerEdges.filter(function(t){return t.from.id!==e.from.id})},r.prototype.removeOuterEdge=function(e){this.outerEdges=this.outerEdges.filter(function(t){return t.to.id!==e.to.id})},r.prototype.addOuterEdge=function(e){this.outerEdges.push(e),this.outerEdgesSorted=!1},r.prototype.sortOuterEdges=function(){var e=this;this.outerEdgesSorted||(this.outerEdges.sort(function(t,n){var a=t.to,i=n.to;if(a.coordinates[0]-e.coordinates[0]>=0&&i.coordinates[0]-e.coordinates[0]<0)return 1;if(a.coordinates[0]-e.coordinates[0]<0&&i.coordinates[0]-e.coordinates[0]>=0)return-1;if(a.coordinates[0]-e.coordinates[0]===0&&i.coordinates[0]-e.coordinates[0]===0)return a.coordinates[1]-e.coordinates[1]>=0||i.coordinates[1]-e.coordinates[1]>=0?a.coordinates[1]-i.coordinates[1]:i.coordinates[1]-a.coordinates[1];var o=$t(e.coordinates,a.coordinates,i.coordinates);if(o<0)return 1;if(o>0)return-1;var f=Math.pow(a.coordinates[0]-e.coordinates[0],2)+Math.pow(a.coordinates[1]-e.coordinates[1],2),s=Math.pow(i.coordinates[0]-e.coordinates[0],2)+Math.pow(i.coordinates[1]-e.coordinates[1],2);return f-s}),this.outerEdgesSorted=!0)},r.prototype.getOuterEdges=function(){return this.sortOuterEdges(),this.outerEdges},r.prototype.getOuterEdge=function(e){return this.sortOuterEdges(),this.outerEdges[e]},r.prototype.addInnerEdge=function(e){this.innerEdges.push(e)},r}(),us=function(){function r(e,t){this.from=e,this.to=t,this.next=void 0,this.label=void 0,this.symetric=void 0,this.ring=void 0,this.from.addOuterEdge(this),this.to.addInnerEdge(this)}return r.prototype.getSymetric=function(){return this.symetric||(this.symetric=new r(this.to,this.from),this.symetric.symetric=this),this.symetric},r.prototype.deleteEdge=function(){this.from.removeOuterEdge(this),this.to.removeInnerEdge(this)},r.prototype.isEqual=function(e){return this.from.id===e.from.id&&this.to.id===e.to.id},r.prototype.toString=function(){return"Edge { "+this.from.id+" -> "+this.to.id+" }"},r.prototype.toLineString=function(){return cr([this.from.coordinates,this.to.coordinates])},r.prototype.compareTo=function(e){return $t(e.from.coordinates,e.to.coordinates,this.to.coordinates)},r}(),ss=function(){function r(){this.edges=[],this.polygon=void 0,this.envelope=void 0}return r.prototype.push=function(e){this.edges.push(e),this.polygon=this.envelope=void 0},r.prototype.get=function(e){return this.edges[e]},Object.defineProperty(r.prototype,"length",{get:function(){return this.edges.length},enumerable:!0,configurable:!0}),r.prototype.forEach=function(e){this.edges.forEach(e)},r.prototype.map=function(e){return this.edges.map(e)},r.prototype.some=function(e){return this.edges.some(e)},r.prototype.isValid=function(){return!0},r.prototype.isHole=function(){var e=this,t=this.edges.reduce(function(o,f,s){return f.from.coordinates[1]>e.edges[o].from.coordinates[1]&&(o=s),o},0),n=(t===0?this.length:t)-1,a=(t+1)%this.length,i=$t(this.edges[n].from.coordinates,this.edges[t].from.coordinates,this.edges[a].from.coordinates);return i===0?this.edges[n].from.coordinates[0]>this.edges[a].from.coordinates[0]:i>0},r.prototype.toMultiPoint=function(){return Be(this.edges.map(function(e){return e.from.coordinates}))},r.prototype.toPolygon=function(){if(this.polygon)return this.polygon;var e=this.edges.map(function(t){return t.from.coordinates});return e.push(this.edges[0].from.coordinates),this.polygon=D([e])},r.prototype.getEnvelope=function(){return this.envelope?this.envelope:this.envelope=va(this.toPolygon())},r.findEdgeRingContaining=function(e,t){var n=e.getEnvelope(),a,i;return t.forEach(function(o){var f=o.getEnvelope();if(i&&(a=i.getEnvelope()),!is(f,n)&&Sn(f,n)){for(var s=e.map(function(E){return E.from.coordinates}),u=void 0,h=function(E){o.some(function(g){return os(E,g.from.coordinates)})||(u=E)},v=0,c=s;v<c.length;v++){var d=c[v];h(d)}u&&o.inside(T(u))&&(!i||Sn(a,f))&&(i=o)}}),i},r.prototype.inside=function(e){return wr(e,this.toPolygon())},r}();const qa=ss;function fs(r){if(!r)throw new Error("No geojson passed");if(r.type!=="FeatureCollection"&&r.type!=="GeometryCollection"&&r.type!=="MultiLineString"&&r.type!=="LineString"&&r.type!=="Feature")throw new Error("Invalid input type '"+r.type+"'. Geojson must be FeatureCollection, GeometryCollection, LineString, MultiLineString or Feature")}var hs=function(){function r(){this.edges=[],this.nodes={}}return r.fromGeoJson=function(e){fs(e);var t=new r;return Nr(e,function(n){Ce(n,"LineString","Graph::fromGeoJson"),wt(n,function(a,i){if(a){var o=t.getNode(a),f=t.getNode(i);t.addEdge(o,f)}return i})}),t},r.prototype.getNode=function(e){var t=qn.buildId(e),n=this.nodes[t];return n||(n=this.nodes[t]=new qn(e)),n},r.prototype.addEdge=function(e,t){var n=new us(e,t),a=n.getSymetric();this.edges.push(n),this.edges.push(a)},r.prototype.deleteDangles=function(){var e=this;Object.keys(this.nodes).map(function(t){return e.nodes[t]}).forEach(function(t){return e._removeIfDangle(t)})},r.prototype._removeIfDangle=function(e){var t=this;if(e.innerEdges.length<=1){var n=e.getOuterEdges().map(function(a){return a.to});this.removeNode(e),n.forEach(function(a){return t._removeIfDangle(a)})}},r.prototype.deleteCutEdges=function(){var e=this;this._computeNextCWEdges(),this._findLabeledEdgeRings(),this.edges.forEach(function(t){t.label===t.symetric.label&&(e.removeEdge(t.symetric),e.removeEdge(t))})},r.prototype._computeNextCWEdges=function(e){var t=this;typeof e>"u"?Object.keys(this.nodes).forEach(function(n){return t._computeNextCWEdges(t.nodes[n])}):e.getOuterEdges().forEach(function(n,a){e.getOuterEdge((a===0?e.getOuterEdges().length:a)-1).symetric.next=n})},r.prototype._computeNextCCWEdges=function(e,t){for(var n=e.getOuterEdges(),a,i,o=n.length-1;o>=0;--o){var f=n[o],s=f.symetric,u=void 0,h=void 0;f.label===t&&(u=f),s.label===t&&(h=s),!(!u||!h)&&(h&&(i=h),u&&(i&&(i.next=u,i=void 0),a||(a=u)))}i&&(i.next=a)},r.prototype._findLabeledEdgeRings=function(){var e=[],t=0;return this.edges.forEach(function(n){if(!(n.label>=0)){e.push(n);var a=n;do a.label=t,a=a.next;while(!n.isEqual(a));t++}}),e},r.prototype.getEdgeRings=function(){var e=this;this._computeNextCWEdges(),this.edges.forEach(function(n){n.label=void 0}),this._findLabeledEdgeRings().forEach(function(n){e._findIntersectionNodes(n).forEach(function(a){e._computeNextCCWEdges(a,n.label)})});var t=[];return this.edges.forEach(function(n){n.ring||t.push(e._findEdgeRing(n))}),t},r.prototype._findIntersectionNodes=function(e){var t=[],n=e,a=function(){var i=0;n.from.getOuterEdges().forEach(function(o){o.label===e.label&&++i}),i>1&&t.push(n.from),n=n.next};do a();while(!e.isEqual(n));return t},r.prototype._findEdgeRing=function(e){var t=e,n=new qa;do n.push(t),t.ring=n,t=t.next;while(!e.isEqual(t));return n},r.prototype.removeNode=function(e){var t=this;e.getOuterEdges().forEach(function(n){return t.removeEdge(n)}),e.innerEdges.forEach(function(n){return t.removeEdge(n)}),delete this.nodes[e.id]},r.prototype.removeEdge=function(e){this.edges=this.edges.filter(function(t){return!t.isEqual(e)}),e.deleteEdge()},r}();const vs=hs;function cs(r){var e=vs.fromGeoJson(r);e.deleteDangles(),e.deleteCutEdges();var t=[],n=[];return e.getEdgeRings().filter(function(a){return a.isValid()}).forEach(function(a){a.isHole()?t.push(a):n.push(a)}),t.forEach(function(a){qa.findEdgeRingContaining(a,n)&&n.push(a)}),N(n.map(function(a){return a.toPolygon()}))}function Ba(r,e){var t=!0;return Nr(r,function(n){Nr(e,function(a){if(t===!1)return!1;t=ds(n.geometry,a.geometry)})}),t}function ds(r,e){switch(r.type){case"Point":switch(e.type){case"Point":return!gs(r.coordinates,e.coordinates);case"LineString":return!Bn(e,r);case"Polygon":return!wr(r,e)}break;case"LineString":switch(e.type){case"Point":return!Bn(r,e);case"LineString":return!ps(r,e);case"Polygon":return!kn(e,r)}break;case"Polygon":switch(e.type){case"Point":return!wr(e,r);case"LineString":return!kn(r,e);case"Polygon":return!ls(e,r)}}return!1}function Bn(r,e){for(var t=0;t<r.coordinates.length-1;t++)if(ys(r.coordinates[t],r.coordinates[t+1],e.coordinates))return!0;return!1}function ps(r,e){var t=ae(r,e);return t.features.length>0}function kn(r,e){for(var t=0,n=e.coordinates;t<n.length;t++){var a=n[t];if(wr(a,r))return!0}var i=ae(e,Oe(r));return i.features.length>0}function ls(r,e){for(var t=0,n=r.coordinates[0];t<n.length;t++){var a=n[t];if(wr(a,e))return!0}for(var i=0,o=e.coordinates[0];i<o.length;i++){var f=o[i];if(wr(f,r))return!0}var s=ae(Oe(r),Oe(e));return s.features.length>0}function ys(r,e,t){var n=t[0]-r[0],a=t[1]-r[1],i=e[0]-r[0],o=e[1]-r[1],f=n*o-a*i;return f!==0?!1:Math.abs(i)>=Math.abs(o)?i>0?r[0]<=t[0]&&t[0]<=e[0]:e[0]<=t[0]&&t[0]<=r[0]:o>0?r[1]<=t[1]&&t[1]<=e[1]:e[1]<=t[1]&&t[1]<=r[1]}function gs(r,e){return r[0]===e[0]&&r[1]===e[1]}function ws(r,e){var t=mr(r),n=mr(e),a=t.type,i=n.type,o=t.coordinates,f=n.coordinates;switch(a){case"Point":switch(i){case"Point":return Wt(o,f);default:throw new Error("feature2 "+i+" geometry not supported")}case"MultiPoint":switch(i){case"Point":return ms(t,n);case"MultiPoint":return Es(t,n);default:throw new Error("feature2 "+i+" geometry not supported")}case"LineString":switch(i){case"Point":return Hr(n,t,{ignoreEndVertices:!0});case"LineString":return Ls(t,n);case"MultiPoint":return Ms(t,n);default:throw new Error("feature2 "+i+" geometry not supported")}case"Polygon":switch(i){case"Point":return wr(n,t,{ignoreBoundary:!0});case"LineString":return xs(t,n);case"Polygon":return Cs(t,n);case"MultiPoint":return Ps(t,n);default:throw new Error("feature2 "+i+" geometry not supported")}default:throw new Error("feature1 "+a+" geometry not supported")}}function ms(r,e){var t,n=!1;for(t=0;t<r.coordinates.length;t++)if(Wt(r.coordinates[t],e.coordinates)){n=!0;break}return n}function Es(r,e){for(var t=0,n=e.coordinates;t<n.length;t++){for(var a=n[t],i=!1,o=0,f=r.coordinates;o<f.length;o++){var s=f[o];if(Wt(a,s)){i=!0;break}}if(!i)return!1}return!0}function Ms(r,e){for(var t=!1,n=0,a=e.coordinates;n<a.length;n++){var i=a[n];if(Hr(i,r,{ignoreEndVertices:!0})&&(t=!0),!Hr(i,r))return!1}return!!t}function Ps(r,e){for(var t=0,n=e.coordinates;t<n.length;t++){var a=n[t];if(!wr(a,r,{ignoreBoundary:!0}))return!1}return!0}function Ls(r,e){for(var t=!1,n=0,a=e.coordinates;n<a.length;n++){var i=a[n];if(Hr({type:"Point",coordinates:i},r,{ignoreEndVertices:!0})&&(t=!0),!Hr({type:"Point",coordinates:i},r,{ignoreEndVertices:!1}))return!1}return t}function xs(r,e){var t=!1,n=0,a=Pr(r),i=Pr(e);if(!ka(a,i))return!1;for(n;n<e.coordinates.length-1;n++){var o=As(e.coordinates[n],e.coordinates[n+1]);if(wr({type:"Point",coordinates:o},r,{ignoreBoundary:!0})){t=!0;break}}return t}function Cs(r,e){if(r.type==="Feature"&&r.geometry===null||e.type==="Feature"&&e.geometry===null)return!1;var t=Pr(r),n=Pr(e);if(!ka(t,n))return!1;for(var a=mr(e).coordinates,i=0,o=a;i<o.length;i++)for(var f=o[i],s=0,u=f;s<u.length;s++){var h=u[s];if(!wr(h,r))return!1}return!0}function ka(r,e){return!(r[0]>e[0]||r[2]<e[2]||r[1]>e[1]||r[3]<e[3])}function Wt(r,e){return r[0]===e[0]&&r[1]===e[1]}function As(r,e){return[(r[0]+e[0])/2,(r[1]+e[1])/2]}function Os(r,e){var t=mr(r),n=mr(e),a=t.type,i=n.type;switch(a){case"MultiPoint":switch(i){case"LineString":return Fn(t,n);case"Polygon":return In(t,n);default:throw new Error("feature2 "+i+" geometry not supported")}case"LineString":switch(i){case"MultiPoint":return Fn(n,t);case"LineString":return Ss(t,n);case"Polygon":return Nn(t,n);default:throw new Error("feature2 "+i+" geometry not supported")}case"Polygon":switch(i){case"MultiPoint":return In(n,t);case"LineString":return Nn(n,t);default:throw new Error("feature2 "+i+" geometry not supported")}default:throw new Error("feature1 "+a+" geometry not supported")}}function Fn(r,e){for(var t=!1,n=!1,a=r.coordinates.length,i=0;i<a&&!t&&!n;){for(var o=0;o<e.coordinates.length-1;o++){var f=!0;(o===0||o===e.coordinates.length-2)&&(f=!1),Fa(e.coordinates[o],e.coordinates[o+1],r.coordinates[i],f)?t=!0:n=!0}i++}return t&&n}function Ss(r,e){var t=ae(r,e);if(t.features.length>0)for(var n=0;n<r.coordinates.length-1;n++)for(var a=0;a<e.coordinates.length-1;a++){var i=!0;if((a===0||a===e.coordinates.length-2)&&(i=!1),Fa(r.coordinates[n],r.coordinates[n+1],e.coordinates[a],i))return!0}return!1}function Nn(r,e){var t=xa(e),n=ae(r,t);return n.features.length>0}function In(r,e){for(var t=!1,n=!1,a=r.coordinates.length,i=0;i<a&&(!t||!n);i++)wr(T(r.coordinates[i]),e)?t=!0:n=!0;return n&&t}function Fa(r,e,t,n){var a=t[0]-r[0],i=t[1]-r[1],o=e[0]-r[0],f=e[1]-r[1],s=a*f-i*o;return s!==0?!1:n?Math.abs(o)>=Math.abs(f)?o>0?r[0]<=t[0]&&t[0]<=e[0]:e[0]<=t[0]&&t[0]<=r[0]:f>0?r[1]<=t[1]&&t[1]<=e[1]:e[1]<=t[1]&&t[1]<=r[1]:Math.abs(o)>=Math.abs(f)?o>0?r[0]<t[0]&&t[0]<e[0]:e[0]<t[0]&&t[0]<r[0]:f>0?r[1]<t[1]&&t[1]<e[1]:e[1]<t[1]&&t[1]<r[1]}function qs(r,e){var t=mr(r),n=mr(e),a=t.type,i=n.type;if(a==="MultiPoint"&&i!=="MultiPoint"||(a==="LineString"||a==="MultiLineString")&&i!=="LineString"&&i!=="MultiLineString"||(a==="Polygon"||a==="MultiPolygon")&&i!=="Polygon"&&i!=="MultiPolygon")throw new Error("features must be of the same type");if(a==="Point")throw new Error("Point geometry not supported");var o=new Jn({precision:6});if(o.compare(r,e))return!1;var f=0;switch(a){case"MultiPoint":for(var s=0;s<t.coordinates.length;s++)for(var u=0;u<n.coordinates.length;u++){var h=t.coordinates[s],v=n.coordinates[u];if(h[0]===v[0]&&h[1]===v[1])return!0}return!1;case"LineString":case"MultiLineString":Vr(r,function(c){Vr(e,function(d){Aa(c,d).features.length&&f++})});break;case"Polygon":case"MultiPolygon":Vr(r,function(c){Vr(e,function(d){ae(c,d).features.length&&f++})});break}return f>0}function Bs(r,e){var t=mr(r).type,n=mr(e).type;if(t!==n)return!1;var a=new Jn({precision:6});return a.compare(ce(r),ce(e))}function Na(r,e){var t=!1;return Nr(r,function(n){Nr(e,function(a){if(t===!0)return!0;t=!Ba(n.geometry,a.geometry)})}),t}function ks(r,e,t){t===void 0&&(t={}),t.mutate!==!0&&(r=Tr(r)),t.minPoints=t.minPoints||3;var n=new hi.DBSCAN,a=n.run(we(r),ve(e,t.units),t.minPoints,dr),i=-1;return a.forEach(function(o){i++,o.forEach(function(f){var s=r.features[f];s.properties||(s.properties={}),s.properties.cluster=i,s.properties.dbscan="core"})}),n.noise.forEach(function(o){var f=r.features[o];f.properties||(f.properties={}),f.properties.cluster?f.properties.dbscan="edge":f.properties.dbscan="noise"}),r}function Fs(r,e){e===void 0&&(e={});var t=r.features.length;e.numberOfClusters=e.numberOfClusters||Math.round(Math.sqrt(t/2)),e.numberOfClusters>t&&(e.numberOfClusters=t),e.mutate!==!0&&(r=Tr(r));var n=we(r),a=n.slice(0,e.numberOfClusters),i=vi(n,e.numberOfClusters,a),o={};return i.centroids.forEach(function(f,s){o[s]=f}),vr(r,function(f,s){var u=i.idxs[s];f.properties.cluster=u,f.properties.centroid=o[u]}),r}function Ns(r,e){if(!r)throw new Error("line1 is required");if(!e)throw new Error("line2 is required");var t=zn(r,"line1");if(t!=="LineString")throw new Error("line1 must be a LineString");var n=zn(e,"line2");if(n!=="LineString")throw new Error("line2 must be a LineString");for(var a=de(ce(r)).features,i=de(ce(e)).features,o=0;o<a.length;o++){var f=a[o].geometry.coordinates;if(!i[o])break;var s=i[o].geometry.coordinates;if(!Is(f,s))return!1}return!0}function Is(r,e){var t=he(pe(r[0],r[1])),n=he(pe(e[0],e[1]));return t===n}function zn(r,e){if(r.geometry&&r.geometry.type)return r.geometry.type;if(r.type)return r.type;throw new Error("Invalid GeoJSON object for "+e)}function Tn(r){for(var e=r,t=[];e.parent;)t.unshift(e),e=e.parent;return t}function zs(){return new Ia(function(r){return r.f})}var Ye={search:function(r,e,t,n){r.cleanDirty(),n=n||{};var a=n.heuristic||Ye.heuristics.manhattan,i=n.closest||!1,o=zs(),f=e;for(e.h=a(e,t),o.push(e);o.size()>0;){var s=o.pop();if(s===t)return Tn(s);s.closed=!0;for(var u=r.neighbors(s),h=0,v=u.length;h<v;++h){var c=u[h];if(!(c.closed||c.isWall())){var d=s.g+c.getCost(s),E=c.visited;(!E||d<c.g)&&(c.visited=!0,c.parent=s,c.h=c.h||a(c,t),c.g=d,c.f=c.g+c.h,r.markDirty(c),i&&(c.h<f.h||c.h===f.h&&c.g<f.g)&&(f=c),E?o.rescoreElement(c):o.push(c))}}}return i?Tn(f):[]},heuristics:{manhattan:function(r,e){var t=Math.abs(e.x-r.x),n=Math.abs(e.y-r.y);return t+n},diagonal:function(r,e){var t=1,n=Math.sqrt(2),a=Math.abs(e.x-r.x),i=Math.abs(e.y-r.y);return t*(a+i)+(n-2*t)*Math.min(a,i)}},cleanNode:function(r){r.f=0,r.g=0,r.h=0,r.visited=!1,r.closed=!1,r.parent=null}};function Ee(r,e){e=e||{},this.nodes=[],this.diagonal=!!e.diagonal,this.grid=[];for(var t=0;t<r.length;t++){this.grid[t]=[];for(var n=0,a=r[t];n<a.length;n++){var i=new _e(t,n,a[n]);this.grid[t][n]=i,this.nodes.push(i)}}this.init()}Ee.prototype.init=function(){this.dirtyNodes=[];for(var r=0;r<this.nodes.length;r++)Ye.cleanNode(this.nodes[r])};Ee.prototype.cleanDirty=function(){for(var r=0;r<this.dirtyNodes.length;r++)Ye.cleanNode(this.dirtyNodes[r]);this.dirtyNodes=[]};Ee.prototype.markDirty=function(r){this.dirtyNodes.push(r)};Ee.prototype.neighbors=function(r){var e=[],t=r.x,n=r.y,a=this.grid;return a[t-1]&&a[t-1][n]&&e.push(a[t-1][n]),a[t+1]&&a[t+1][n]&&e.push(a[t+1][n]),a[t]&&a[t][n-1]&&e.push(a[t][n-1]),a[t]&&a[t][n+1]&&e.push(a[t][n+1]),this.diagonal&&(a[t-1]&&a[t-1][n-1]&&e.push(a[t-1][n-1]),a[t+1]&&a[t+1][n-1]&&e.push(a[t+1][n-1]),a[t-1]&&a[t-1][n+1]&&e.push(a[t-1][n+1]),a[t+1]&&a[t+1][n+1]&&e.push(a[t+1][n+1])),e};Ee.prototype.toString=function(){for(var r=[],e=this.grid,t,n,a,i,o=0,f=e.length;o<f;o++){for(t=[],n=e[o],a=0,i=n.length;a<i;a++)t.push(n[a].weight);r.push(t.join(" "))}return r.join(`
`)};function _e(r,e,t){this.x=r,this.y=e,this.weight=t}_e.prototype.toString=function(){return"["+this.x+" "+this.y+"]"};_e.prototype.getCost=function(r){return r&&r.x!==this.x&&r.y!==this.y?this.weight*1.41421:this.weight};_e.prototype.isWall=function(){return this.weight===0};function Ia(r){this.content=[],this.scoreFunction=r}Ia.prototype={push:function(r){this.content.push(r),this.sinkDown(this.content.length-1)},pop:function(){var r=this.content[0],e=this.content.pop();return this.content.length>0&&(this.content[0]=e,this.bubbleUp(0)),r},remove:function(r){var e=this.content.indexOf(r),t=this.content.pop();e!==this.content.length-1&&(this.content[e]=t,this.scoreFunction(t)<this.scoreFunction(r)?this.sinkDown(e):this.bubbleUp(e))},size:function(){return this.content.length},rescoreElement:function(r){this.sinkDown(this.content.indexOf(r))},sinkDown:function(r){for(var e=this.content[r];r>0;){var t=(r+1>>1)-1,n=this.content[t];if(this.scoreFunction(e)<this.scoreFunction(n))this.content[t]=e,this.content[r]=n,r=t;else break}},bubbleUp:function(r){for(var e=this.content.length,t=this.content[r],n=this.scoreFunction(t);;){var a=r+1<<1,i=a-1,o=null,f;if(i<e){var s=this.content[i];f=this.scoreFunction(s),f<n&&(o=i)}if(a<e){var u=this.content[a],h=this.scoreFunction(u);h<(o===null?n:f)&&(o=a)}if(o!==null)this.content[r]=this.content[o],this.content[o]=t,r=o;else break}}};function Ts(r,e,t){if(t=t||{},!pr(t))throw new Error("options is invalid");var n=t.resolution,a=t.minDistance,i=t.obstacles||N([]);if(!r)throw new Error("start is required");if(!e)throw new Error("end is required");if(n&&!qr(n)||n<=0)throw new Error("options.resolution must be a number, greater than 0");if(a)throw new Error("options.minDistance is not yet implemented");var o=yr(r),f=yr(e);switch(r=T(o),e=T(f),Jr(i)){case"FeatureCollection":if(i.features.length===0)return cr([o,f]);break;case"Polygon":i=N([Cr(mr(i))]);break;default:throw new Error("invalid obstacles")}var s=i;s.features.push(r),s.features.push(e);var u=Pr(Sa(Ot(Pr(s)),1.15));if(!n){var h=dr([u[0],u[1]],[u[2],u[1]],t);n=h/100}s.features.pop(),s.features.pop();for(var v=u[0],c=u[1],d=u[2],E=u[3],g=n/dr([v,c],[d,c],t),P=g*(d-v),m=n/dr([v,c],[v,E],t),l=m*(E-c),w=d-v,L=E-c,M=Math.floor(w/P),O=Math.floor(L/l),x=(w-M*P)/2,C=(L-O*l)/2,y=[],Br=[],Er=[],kr=[],Rr=1/0,$r=1/0,Ir=E-C,hr=0;Ir>=c;){for(var Wr=[],Ar=[],gr=v+x,Ur=0;gr<=d;){var Qr=T([gr,Ir]),Yr=Ds(Qr,i);Wr.push(Yr?0:1),Ar.push(gr+"|"+Ir);var xr=dr(Qr,r);!Yr&&xr<Rr&&(Rr=xr,Er={x:Ur,y:hr});var Lr=dr(Qr,e);!Yr&&Lr<$r&&($r=Lr,kr={x:Ur,y:hr}),gr+=P,Ur++}Br.push(Wr),y.push(Ar),Ir-=l,hr++}var Dr=new Ee(Br,{diagonal:!0}),_r=Dr.grid[Er.y][Er.x],br=Dr.grid[kr.y][kr.x],je=Ye.search(Dr,_r,br),Me=[o];return je.forEach(function(Fe){var Ne=y[Fe.x][Fe.y].split("|");Me.push([+Ne[0],+Ne[1]])}),Me.push(f),ce(cr(Me))}function Ds(r,e){for(var t=0;t<e.features.length;t++)if(wr(r,e.features[t]))return!0;return!1}function Gs(r){return r=r.slice(),r.push(r[0]),D([r])}function Rs(r,e){if(e=e||{},!pr(e))throw new Error("options is invalid");var t=e.bbox||[-180,-85,180,85];if(!r)throw new Error("points is required");if(!Array.isArray(t))throw new Error("bbox is invalid");return ne(r,"Point","points"),N(ci().x(function(n){return n.geometry.coordinates[0]}).y(function(n){return n.geometry.coordinates[1]}).extent([[t[0],t[1]],[t[2],t[3]]]).polygons(r.features).map(Gs))}function za(r,e,t,n){n=n||{};var a=n.steps||64,i=n.units||"kilometers",o=n.angle||0,f=n.pivot||r,s=n.properties||r.properties||{};if(!r)throw new Error("center is required");if(!e)throw new Error("xSemiAxis is required");if(!t)throw new Error("ySemiAxis is required");if(!pr(n))throw new Error("options must be an object");if(!qr(a))throw new Error("steps must be a number");if(!qr(o))throw new Error("angle must be a number");var u=yr(r);if(i==="degrees")var h=Sr(o);else e=me(r,e,90,{units:i}),t=me(r,t,0,{units:i}),e=yr(e)[0]-u[0],t=yr(t)[1]-u[1];for(var v=[],c=0;c<a;c+=1){var d=c*-360/a,E=e*t/Math.sqrt(Math.pow(t,2)+Math.pow(e,2)*Math.pow(Dn(d),2)),g=e*t/Math.sqrt(Math.pow(e,2)+Math.pow(t,2)/Math.pow(Dn(d),2));if(d<-90&&d>=-270&&(E=-E),d<-180&&d>=-360&&(g=-g),i==="degrees"){var P=E*Math.cos(h)+g*Math.sin(h),m=g*Math.cos(h)-E*Math.sin(h);E=P,g=m}v.push([E+u[0],g+u[1]])}return v.push(v[0]),i==="degrees"?D([v],s):Oa(D([v],s),o,{pivot:f})}function Dn(r){var e=r*Math.PI/180;return Math.tan(e)}function Jt(r,e){e===void 0&&(e={});var t=0,n=0,a=0;return Kr(r,function(i,o,f){var s=e.weight?f==null?void 0:f[e.weight]:void 0;if(s=s??1,!qr(s))throw new Error("weight value must be a number for feature index "+o);s=Number(s),s>0&&Mr(i,function(u){t+=u[0]*s,n+=u[1]*s,a+=s})}),T([t/a,n/a],e.properties,e)}function $s(r,e){if(e===void 0&&(e={}),e=e||{},!pr(e))throw new Error("options is invalid");var t=e.counter||10;if(!qr(t))throw new Error("counter must be a number");var n=e.weight,a=Jt(r,{weight:e.weight}),i=N([]);vr(r,function(f){var s;i.features.push(oe(f,{properties:{weight:(s=f.properties)===null||s===void 0?void 0:s[n]}}))});var o={tolerance:e.tolerance,medianCandidates:[]};return Ta(a.geometry.coordinates,[0,0],i,o,t)}function Ta(r,e,t,n,a){var i=n.tolerance||.001,o=0,f=0,s=0,u=0;if(vr(t,function(c){var d,E=(d=c.properties)===null||d===void 0?void 0:d.weight,g=E??1;if(g=Number(g),!qr(g))throw new Error("weight value must be a number");if(g>0){u+=1;var P=g*dr(c,r);P===0&&(P=1);var m=g/P;o+=c.geometry.coordinates[0]*m,f+=c.geometry.coordinates[1]*m,s+=m}}),u<1)throw new Error("no features to measure");var h=o/s,v=f/s;return u===1||a===0||Math.abs(h-e[0])<i&&Math.abs(v-e[1])<i?T([h,v],{medianCandidates:n.medianCandidates}):(n.medianCandidates.push([h,v]),Ta([h,v],r,t,n,a-1))}function Ws(r,e){if(e=e||{},!pr(e))throw new Error("options is invalid");var t=e.steps||64,n=e.weight,a=e.properties||{};if(!qr(t))throw new Error("steps must be a number");if(!pr(a))throw new Error("properties must be a number");var i=we(r).length,o=Jt(r,{weight:n}),f=0,s=0,u=0;vr(r,function(x){var C=x.properties[n]||1,y=Gn(z(x),z(o));f+=Math.pow(y.x,2)*C,s+=Math.pow(y.y,2)*C,u+=y.x*y.y*C});var h=f-s,v=Math.sqrt(Math.pow(h,2)+4*Math.pow(u,2)),c=2*u,d=Math.atan((h+v)/c),E=d*180/Math.PI,g=0,P=0,m=0;vr(r,function(x){var C=x.properties[n]||1,y=Gn(z(x),z(o));g+=Math.pow(y.x*Math.cos(d)-y.y*Math.sin(d),2)*C,P+=Math.pow(y.x*Math.sin(d)+y.y*Math.cos(d),2)*C,m+=C});var l=Math.sqrt(2*g/m),w=Math.sqrt(2*P/m),L=za(o,l,w,{units:"degrees",angle:E,steps:t,properties:a}),M=ot(r,N([L])),O={meanCenterCoordinates:z(o),semiMajorAxis:l,semiMinorAxis:w,numberOfFeatures:i,angle:E,percentageWithinEllipse:100*we(M).length/i};return L.properties.standardDeviationalEllipse=O,L}function Gn(r,e){return{x:r[0]-e[0],y:r[1]-e[1]}}function Js(r,e,t,n){if(n===void 0&&(n={}),!pr(n))throw new Error("options is invalid");if(!r)throw new Error("startPoint is required");if(!e)throw new Error("midPoint is required");if(!t)throw new Error("endPoint is required");var a=r,i=e,o=t,f=he(n.mercator!==!0?te(a,i):pe(a,i)),s=he(n.mercator!==!0?te(o,i):pe(o,i)),u=Math.abs(f-s);return n.explementary===!0?360-u:u}function Hs(r,e){var t=[],n=e.iterations||1;if(!r)throw new Error("inputPolys is required");return Kr(r,function(a,i,o){var f,s,u;switch(a.type){case"Polygon":f=[[]];for(var h=0;h<n;h++)u=[[]],s=a,h>0&&(s=D(f).geometry),Xs(s,u),f=u.slice(0);t.push(D(f,o));break;case"MultiPolygon":f=[[[]]];for(var v=0;v<n;v++)u=[[[]]],s=a,v>0&&(s=Xr(f).geometry),Ks(s,u),f=u.slice(0);t.push(Xr(f,o));break;default:throw new Error("geometry is invalid, must be Polygon or MultiPolygon")}}),N(t)}function Xs(r,e){var t=0,n=0;Mr(r,function(a,i,o,f,s){s>t&&(t=s,n=i,e.push([]));var u=i-n,h=r.coordinates[s][u+1],v=a[0],c=a[1],d=h[0],E=h[1];e[s].push([.75*v+.25*d,.75*c+.25*E]),e[s].push([.25*v+.75*d,.25*c+.75*E])},!0),e.forEach(function(a){a.push(a[0])})}function Ks(r,e){var t=0,n=0,a=0;Mr(r,function(i,o,f,s,u){s>a&&(a=s,n=o,e.push([[]])),u>t&&(t=u,n=o,e[s].push([]));var h=o-n,v=r.coordinates[s][u][h+1],c=i[0],d=i[1],E=v[0],g=v[1];e[s][u].push([.75*c+.25*E,.75*d+.25*g]),e[s][u].push([.25*c+.75*E,.25*d+.75*g])},!0),e.forEach(function(i){i.forEach(function(o){o.push(o[0])})})}function Zs(r,e,t){t===void 0&&(t=2);var n=yr(r),a=yr(e),i=n[0]-a[0],o=n[1]-a[1];return t===1?Math.abs(i)+Math.abs(o):Math.pow(Math.pow(i,t)+Math.pow(o,t),1/t)}function Da(r,e){e=e||{};var t=e.threshold||1e4,n=e.p||2,a=e.binary||!1,i=e.alpha||-1,o=e.standardization||!1,f=[];vr(r,function(d){f.push(oe(d))});for(var s=[],u=0;u<f.length;u++)s[u]=[];for(var u=0;u<f.length;u++)for(var h=u;h<f.length;h++){u===h&&(s[u][h]=0);var v=Zs(f[u],f[h],n);s[u][h]=v,s[h][u]=v}for(var u=0;u<f.length;u++)for(var h=0;h<f.length;h++){var v=s[u][h];v!==0&&(a?v<=t?s[u][h]=1:s[u][h]=0:v<=t?s[u][h]=Math.pow(v,i):s[u][h]=0)}if(o)for(var u=0;u<f.length;u++)for(var c=s[u].reduce(function(E,g){return E+g},0),h=0;h<f.length;h++)s[u][h]=s[u][h]/c;return s}function Us(r,e){var t=e.inputField,n=e.threshold||1e5,a=e.p||2,i=e.binary||!1,o=e.alpha||-1,f=e.standardization||!0,s=Da(r,{alpha:o,binary:i,p:a,standardization:f,threshold:n}),u=[];vr(r,function(Er){var kr=Er.properties||{};u.push(kr[t])});for(var h=Ga(u),v=Qs(u),c=0,d=0,E=0,g=0,P=s.length,m=0;m<P;m++){for(var l=0,w=0;w<P;w++)c+=s[m][w]*(u[m]-h)*(u[w]-h),d+=s[m][w],E+=Math.pow(s[m][w]+s[w][m],2),l+=s[m][w]+s[w][m];g+=Math.pow(l,2)}E=.5*E;var L=c/d/v,M=-1/(P-1),O=P*P*E-P*g+3*(d*d),x=(P-1)*(P+1)*(d*d),C=O/x-M*M,y=Math.sqrt(C),Br=(L-M)/y;return{expectedMoranIndex:M,moranIndex:L,stdNorm:y,zNorm:Br}}function Ga(r){for(var e=0,t=0,n=r;t<n.length;t++){var a=n[t];e+=a}return e/r.length}function Qs(r){for(var e=Ga(r),t=0,n=0,a=r;n<a.length;n++){var i=a[n];t+=Math.pow(i-e,2)}return t/r.length}function Ra(r,e){return e===void 0&&(e={}),Wa(r,"mercator",e)}function $a(r,e){return e===void 0&&(e={}),Wa(r,"wgs84",e)}function Wa(r,e,t){t===void 0&&(t={}),t=t||{};var n=t.mutate;if(!r)throw new Error("geojson is required");return Array.isArray(r)&&qr(r[0])?r=e==="mercator"?Rn(r):$n(r):(n!==!0&&(r=Tr(r)),Mr(r,function(a){var i=e==="mercator"?Rn(a):$n(a);a[0]=i[0],a[1]=i[1]})),r}function Rn(r){var e=Math.PI/180,t=6378137,n=20037508342789244e-9,a=Math.abs(r[0])<=180?r[0]:r[0]-Ys(r[0])*360,i=[t*a*e,t*Math.log(Math.tan(Math.PI*.25+.5*r[1]*e))];return i[0]>n&&(i[0]=n),i[0]<-n&&(i[0]=-n),i[1]>n&&(i[1]=n),i[1]<-n&&(i[1]=-n),i}function $n(r){var e=180/Math.PI,t=6378137;return[r[0]*e/t,(Math.PI*.5-2*Math.atan(Math.exp(-r[1]/t)))*e]}function Ys(r){return r<0?-1:r>0?1:0}const _s=Object.freeze(Object.defineProperty({__proto__:null,toMercator:Ra,toWgs84:$a},Symbol.toStringTag,{value:"Module"}));var bs=globalThis&&globalThis.__spreadArrays||function(){for(var r=0,e=0,t=arguments.length;e<t;e++)r+=arguments[e].length;for(var n=Array(r),a=0,e=0;e<t;e++)for(var i=arguments[e],o=0,f=i.length;o<f;o++,a++)n[a]=i[o];return n};function ke(r){return Array.isArray(r)?Wn(r):r&&r.bbox?Wn(r.bbox):[Vs(),rf()]}function Ja(r,e){e===void 0&&(e={}),r==null&&(r=1);for(var t=[],n=0;n<r;n++)t.push(T(ke(e.bbox)));return N(t)}function Ha(r,e){e===void 0&&(e={}),r==null&&(r=1),(!qr(e.num_vertices)||e.num_vertices===void 0)&&(e.num_vertices=10),(!qr(e.max_radial_length)||e.max_radial_length===void 0)&&(e.max_radial_length=10);for(var t=[],n=function(i){var o=[],f=bs(Array(e.num_vertices+1)).map(Math.random);f.forEach(function(s,u,h){h[u]=u>0?s+h[u-1]:s}),f.forEach(function(s){s=s*2*Math.PI/f[f.length-1];var u=Math.random();o.push([u*(e.max_radial_length||10)*Math.sin(s),u*(e.max_radial_length||10)*Math.cos(s)])}),o[o.length-1]=o[0],o=o.map(js(ke(e.bbox))),t.push(D([o]))},a=0;a<r;a++)n();return N(t)}function Xa(r,e){if(e===void 0&&(e={}),e=e||{},!pr(e))throw new Error("options is invalid");var t=e.bbox,n=e.num_vertices,a=e.max_length,i=e.max_rotation;r==null&&(r=1),(!qr(n)||n===void 0||n<2)&&(n=10),(!qr(a)||a===void 0)&&(a=1e-4),(!qr(i)||i===void 0)&&(i=Math.PI/8);for(var o=[],f=0;f<r;f++){for(var s=ke(t),u=[s],h=0;h<n-1;h++){var v=h===0?Math.random()*2*Math.PI:Math.tan((u[h][1]-u[h-1][1])/(u[h][0]-u[h-1][0])),c=v+(Math.random()-.5)*i*2,d=Math.random()*a;u.push([u[h][0]+d*Math.cos(c),u[h][1]+d*Math.sin(c)])}o.push(cr(u))}return N(o)}function js(r){return function(e){return[e[0]+r[0],e[1]+r[1]]}}function Ka(){return Math.random()-.5}function Vs(){return Ka()*360}function rf(){return Ka()*180}function Wn(r){return[Math.random()*(r[2]-r[0])+r[0],Math.random()*(r[3]-r[1])+r[1]]}const ef=Object.freeze(Object.defineProperty({__proto__:null,randomLineString:Xa,randomPoint:Ja,randomPolygon:Ha,randomPosition:ke},Symbol.toStringTag,{value:"Module"}));function Za(r,e){if(!r)throw new Error("geojson is required");if(r.type!=="FeatureCollection")throw new Error("geojson must be a FeatureCollection");if(e==null)throw new Error("filter is required");var t=[];return vr(r,function(n){be(n.properties,e)&&t.push(n)}),N(t)}function Ht(r,e,t){if(!r)throw new Error("geojson is required");if(r.type!=="FeatureCollection")throw new Error("geojson must be a FeatureCollection");if(e==null)throw new Error("property is required");for(var n=Xt(r,e),a=Object.keys(n),i=0;i<a.length;i++){for(var o=a[i],f=n[o],s=[],u=0;u<f.length;u++)s.push(r.features[f[u]]);t(N(s),o,i)}}function Ua(r,e,t,n){var a=n;return Ht(r,e,function(i,o,f){f===0&&n===void 0?a=i:a=t(a,i,o,f)}),a}function Xt(r,e){var t={};return vr(r,function(n,a){var i=n.properties||{};if(Object.prototype.hasOwnProperty.call(i,String(e))){var o=i[e];Object.prototype.hasOwnProperty.call(t,o)?t[o].push(a):t[o]=[a]}}),t}function be(r,e){if(r===void 0)return!1;var t=typeof e;if(t==="number"||t==="string")return Object.prototype.hasOwnProperty.call(r,e);if(Array.isArray(e)){for(var n=0;n<e.length;n++)if(!be(r,e[n]))return!1;return!0}else return Kt(r,e)}function Kt(r,e){for(var t=Object.keys(e),n=0;n<t.length;n++){var a=t[n];if(r[a]!==e[a])return!1}return!0}function Qa(r,e){if(!e)return{};if(!e.length)return{};for(var t={},n=0;n<e.length;n++){var a=e[n];Object.prototype.hasOwnProperty.call(r,a)&&(t[a]=r[a])}return t}const tf=Object.freeze(Object.defineProperty({__proto__:null,applyFilter:be,clusterEach:Ht,clusterReduce:Ua,createBins:Xt,filterProperties:Qa,getCluster:Za,propertiesContainsFilter:Kt},Symbol.toStringTag,{value:"Module"}));function nf(r,e){var t=mr(r),n=mr(e),a=r.properties||{},i=ee.difference(t.coordinates,n.coordinates);return i.length===0?null:i.length===1?D(i[0],a):Xr(i,a)}function af(r,e,t){t=t||{};var n=t.units||"kilometers",a=t.steps||8;if(!r)throw new Error("geojson is required");if(typeof t!="object")throw new Error("options must be an object");if(typeof a!="number")throw new Error("steps must be an number");if(e===void 0)throw new Error("radius is required");if(a<=0)throw new Error("steps must be greater than 0");var i=[];switch(r.type){case"GeometryCollection":return Kr(r,function(o){var f=Ge(o,e,n,a);f&&i.push(f)}),N(i);case"FeatureCollection":return vr(r,function(o){var f=Ge(o,e,n,a);f&&vr(f,function(s){s&&i.push(s)})}),N(i)}return Ge(r,e,n,a)}function Ge(r,e,t,n){var a=r.properties||{},i=r.type==="Feature"?r.geometry:r;if(i.type==="GeometryCollection"){var o=[];return Kr(r,function(g){var P=Ge(g,e,t,n);P&&o.push(P)}),N(o)}var f=of(i),s={type:i.type,coordinates:_a(i.coordinates,f)},u=new di,h=u.read(s),v=ge(fe(e,t),"meters"),c=pi.bufferOp(h,v,n),d=new li;if(c=d.write(c),!Ya(c.coordinates)){var E={type:c.type,coordinates:ba(c.coordinates,f)};return Cr(E,a)}}function Ya(r){return Array.isArray(r[0])?Ya(r[0]):isNaN(r[0])}function _a(r,e){return typeof r[0]!="object"?e(r):r.map(function(t){return _a(t,e)})}function ba(r,e){return typeof r[0]!="object"?e.invert(r):r.map(function(t){return ba(t,e)})}function of(r){var e=Ze(r).geometry.coordinates,t=[-e[0],-e[1]];return yi().rotate(t).scale(Or)}function uf(r,e,t){t===void 0&&(t={});var n=mr(r),a=mr(e),i=ee.union(n.coordinates,a.coordinates);return i.length===0?null:i.length===1?D(i[0],t.properties):Xr(i,t.properties)}function qe(r,e,t){t===void 0&&(t={});var n=mr(r),a=mr(e),i=ee.intersection(n.coordinates,a.coordinates);return i.length===0?null:i.length===1?D(i[0],t.properties):Xr(i,t.properties)}function sf(r,e){if(e=e||{},!pr(e))throw new Error("options is invalid");var t=e.propertyName;ne(r,"Polygon","dissolve");var n=[];if(e.propertyName){var a={};vr(r,function(s){Object.prototype.hasOwnProperty.call(a,s.properties[t])||(a[s.properties[t]]=[]),a[s.properties[t]].push(s)});for(var i=Object.keys(a),o=0;o<i.length;o++){var f=Xr(ee.union.apply(null,a[i[o]].map(function(s){return s.geometry.coordinates})));f.properties[t]=i[o],n.push(f)}}else return ht(Xr(ee.union.apply(null,r.features.map(function(s){return s.geometry.coordinates}))));return ht(N(n))}function ja(r,e,t){t===void 0&&(t={});var n=JSON.stringify(t.properties||{}),a=r[0],i=r[1],o=r[2],f=r[3],s=(i+f)/2,u=(a+o)/2,h=e*2/dr([a,s],[o,s],t),v=h*(o-a),c=e*2/dr([u,i],[u,f],t),d=c*(f-i),E=v/2,g=E*2,P=Math.sqrt(3)/2*d,m=o-a,l=f-i,w=3/4*g,L=P,M=(m-g)/(g-E/2),O=Math.floor(M),x=(O*w-E/2-m)/2-E/2+w/2,C=Math.floor((l-P)/P),y=(l-C*P)/2,Br=C*P-l>P/2;Br&&(y-=P/4);for(var Er=[],kr=[],Rr=0;Rr<6;Rr++){var $r=2*Math.PI/6*Rr;Er.push(Math.cos($r)),kr.push(Math.sin($r))}for(var Ir=[],hr=0;hr<=O;hr++)for(var Wr=0;Wr<=C;Wr++){var Ar=hr%2===1;if(!(Wr===0&&Ar)&&!(Wr===0&&Br)){var gr=hr*w+a-x,Ur=Wr*L+i+y;if(Ar&&(Ur-=P/2),t.triangles===!0)hf([gr,Ur],v/2,d/2,JSON.parse(n),Er,kr).forEach(function(Yr){t.mask?qe(t.mask,Yr)&&Ir.push(Yr):Ir.push(Yr)});else{var Qr=ff([gr,Ur],v/2,d/2,JSON.parse(n),Er,kr);t.mask?qe(t.mask,Qr)&&Ir.push(Qr):Ir.push(Qr)}}}return N(Ir)}function ff(r,e,t,n,a,i){for(var o=[],f=0;f<6;f++){var s=r[0]+e*a[f],u=r[1]+t*i[f];o.push([s,u])}return o.push(o[0].slice()),D([o],n)}function hf(r,e,t,n,a,i){for(var o=[],f=0;f<6;f++){var s=[];s.push(r),s.push([r[0]+e*a[f],r[1]+t*i[f]]),s.push([r[0]+e*a[(f+1)%6],r[1]+t*i[(f+1)%6]]),s.push(r),o.push(D([s],n))}return o}function vf(r,e){var t=df(e),n=null;return r.type==="FeatureCollection"?n=cf(r):n=Va(ee.union(r.geometry.coordinates)),n.geometry.coordinates.forEach(function(a){t.geometry.coordinates.push(a[0])}),t}function cf(r){var e=r.features.length===2?ee.union(r.features[0].geometry.coordinates,r.features[1].geometry.coordinates):ee.union.apply(ee,r.features.map(function(t){return t.geometry.coordinates}));return Va(e)}function Va(r){return Xr(r)}function df(r){var e=[[[180,90],[-180,90],[-180,-90],[180,-90],[180,90]]],t=r&&r.geometry.coordinates||e;return D(t)}function pf(r,e,t,n){n===void 0&&(n={});for(var a=[],i=r[0],o=r[1],f=r[2],s=r[3],u=e/dr([i,o],[f,o],n),h=u*(f-i),v=t/dr([i,o],[i,s],n),c=v*(s-o),d=f-i,E=s-o,g=Math.floor(d/h),P=Math.floor(E/c),m=(d-g*h)/2,l=(E-P*c)/2,w=i+m,L=0;L<g;L++){for(var M=o+l,O=0;O<P;O++){var x=D([[[w,M],[w,M+c],[w+h,M+c],[w+h,M],[w,M]]],n.properties);n.mask?Na(n.mask,x)&&a.push(x):a.push(x),M+=c}w+=h}return N(a)}function ri(r,e,t){return t===void 0&&(t={}),pf(r,e,e,t)}function ei(r,e,t){t===void 0&&(t={});for(var n=[],a=e/dr([r[0],r[1]],[r[2],r[1]],t),i=a*(r[2]-r[0]),o=e/dr([r[0],r[1]],[r[0],r[3]],t),f=o*(r[3]-r[1]),s=0,u=r[0];u<=r[2];){for(var h=0,v=r[1];v<=r[3];){var c=null,d=null;s%2===0&&h%2===0?(c=D([[[u,v],[u,v+f],[u+i,v],[u,v]]],t.properties),d=D([[[u,v+f],[u+i,v+f],[u+i,v],[u,v+f]]],t.properties)):s%2===0&&h%2===1?(c=D([[[u,v],[u+i,v+f],[u+i,v],[u,v]]],t.properties),d=D([[[u,v],[u,v+f],[u+i,v+f],[u,v]]],t.properties)):h%2===0&&s%2===1?(c=D([[[u,v],[u,v+f],[u+i,v+f],[u,v]]],t.properties),d=D([[[u,v],[u+i,v+f],[u+i,v],[u,v]]],t.properties)):h%2===1&&s%2===1&&(c=D([[[u,v],[u,v+f],[u+i,v],[u,v]]],t.properties),d=D([[[u,v+f],[u+i,v+f],[u+i,v],[u,v+f]]],t.properties)),t.mask?(qe(t.mask,c)&&n.push(c),qe(t.mask,d)&&n.push(d)):(n.push(c),n.push(d)),v+=f,h++}s++,u+=i}return N(n)}function lf(r,e,t){if(t=t||{},typeof t!="object")throw new Error("options is invalid");var n=t.gridType,a=t.property,i=t.weight;if(!r)throw new Error("points is required");if(ne(r,"Point","input must contain Points"),!e)throw new Error("cellSize is required");if(i!==void 0&&typeof i!="number")throw new Error("weight must be a number");a=a||"elevation",n=n||"square",i=i||1;var o=Pr(r),f;switch(n){case"point":case"points":f=ma(o,e,t);break;case"square":case"squares":f=ri(o,e,t);break;case"hex":case"hexes":f=ja(o,e,t);break;case"triangle":case"triangles":f=ei(o,e,t);break;default:throw new Error("invalid gridType")}var s=[];return vr(f,function(u){var h=0,v=0;vr(r,function(d){var E=n==="point"?u:oe(u),g=dr(E,d,t),P;if(a!==void 0&&(P=d.properties[a]),P===void 0&&(P=d.geometry.coordinates[2]),P===void 0)throw new Error("zValue is missing");g===0&&(h=P);var m=1/Math.pow(g,i);v+=m,h+=m*P});var c=Tr(u);c.properties[a]=h/v,s.push(c)}),N(s)}const Df=Object.freeze(Object.defineProperty({__proto__:null,along:Eo,angle:Js,applyFilter:be,area:qt,areaFactors:Re,bbox:Pr,bboxClip:Zo,bboxPolygon:Ot,bearing:te,bearingToAngle:he,bearingToAzimuth:he,bezier:rn,bezierSpline:rn,booleanClockwise:Je,booleanContains:ws,booleanCrosses:Os,booleanDisjoint:Ba,booleanEqual:Bs,booleanIntersects:Na,booleanOverlap:qs,booleanParallel:Ns,booleanPointInPolygon:wr,booleanPointOnLine:Hr,booleanWithin:ya,buffer:af,center:Ze,centerMean:Jt,centerMedian:$s,centerOfMass:da,centroid:oe,circle:St,cleanCoords:ce,clone:Tr,clusterEach:Ht,clusterReduce:Ua,clusters:tf,clustersDbscan:ks,clustersKmeans:Fs,collect:Wi,collectionOf:ne,combine:ao,concave:Ri,containsNumber:Ct,convertArea:Yn,convertDistance:ve,convertLength:ve,convex:oa,coordAll:we,coordEach:Mr,coordReduce:wt,createBins:Xt,degrees2radians:Sr,degreesToRadians:Sr,destination:jr,difference:nf,dissolve:sf,distance:dr,distanceToDegrees:$e,distanceToRadians:fe,distanceWeight:Da,earthRadius:Or,ellipse:za,envelope:va,explode:Ue,factors:Ke,feature:Cr,featureCollection:N,featureEach:vr,featureOf:Ce,featureReduce:Et,filterProperties:Qa,findPoint:ta,findSegment:ea,flatten:ht,flattenEach:Nr,flattenReduce:ra,flip:Ji,geojsonType:aa,geomEach:Kr,geomReduce:Mt,geometry:Xn,geometryCollection:gt,getCluster:Za,getCoord:yr,getCoords:z,getGeom:mr,getType:Jr,greatCircle:$o,helpers:jn,hexGrid:ja,inside:wr,interpolate:lf,intersect:qe,invariant:wi,isNumber:qr,isObject:pr,isobands:Wu,isolines:Ai,kinks:yo,length:ft,lengthToDegrees:$e,lengthToRadians:fe,lineArc:La,lineChunk:Fo,lineDistance:ft,lineEach:Lt,lineIntersect:ae,lineOffset:ts,lineOverlap:Aa,lineReduce:xt,lineSegment:de,lineSlice:Mo,lineSliceAlong:la,lineSplit:Wo,lineString:cr,lineStringToPolygon:yn,lineStrings:Un,lineToPolygon:yn,mask:vf,meta:na,midpoint:no,moranIndex:Us,multiLineString:ue,multiPoint:Be,multiPolygon:Xr,nearest:We,nearestPoint:We,nearestPointOnLine:re,nearestPointToLine:co,planepoint:lo,point:T,pointGrid:ma,pointOnFeature:an,pointOnLine:re,pointOnSurface:an,pointToLineDistance:pa,points:Kn,pointsWithinPolygon:ot,polygon:D,polygonSmooth:Hs,polygonTangents:Yo,polygonToLine:Oe,polygonToLineString:Oe,polygonize:cs,polygons:Zn,projection:_s,propEach:mt,propReduce:Vn,propertiesContainsFilter:Kt,radians2degrees:ie,radiansToDegrees:ie,radiansToDistance:ge,radiansToLength:ge,random:ef,randomLineString:Xa,randomPoint:Ja,randomPolygon:Ha,randomPosition:ke,rewind:jo,rhumbBearing:pe,rhumbDestination:me,rhumbDistance:Qe,round:Qn,sample:ro,sector:Uo,segmentEach:Vr,segmentReduce:Pt,shortestPath:Ts,simplify:Ui,square:ca,squareGrid:ri,standardDeviationalEllipse:Ws,tag:Vi,tesselate:io,tin:ua,toMercator:Ra,toWgs84:$a,transformRotate:Oa,transformScale:Sa,transformTranslate:Yu,triangleGrid:ei,truncate:Ea,union:uf,unitsFactors:Hn,unkinkPolygon:Ro,validateBBox:_n,validateId:bn,voronoi:Rs,within:ot},Symbol.toStringTag,{value:"Module"}));export{Df as _,If as a,zf as b,Ff as c,yt as d,Pr as e,Nf as g,T as p,Tf as r};
